import{_ as e,r as p,o,a as c,b as n,d as l,F as i,c as s,e as a}from"./app.412b4c4c.js";const u={},r=s(`<blockquote><p>\u53C2\u8003\u7F51\u5740\uFF1Ahttps://www.cnblogs.com/java-chen-hao/category/1480619.html</p></blockquote><h2 id="\u6574\u4F53\u67B6\u6784\u548C\u73AF\u5883\u642D\u5EFA"><a class="header-anchor" href="#\u6574\u4F53\u67B6\u6784\u548C\u73AF\u5883\u642D\u5EFA" aria-hidden="true">#</a> \u6574\u4F53\u67B6\u6784\u548C\u73AF\u5883\u642D\u5EFA</h2><h3 id="\u6982\u8FF0"><a class="header-anchor" href="#\u6982\u8FF0" aria-hidden="true">#</a> \u6982\u8FF0</h3><p>Spring\u662F\u4E00\u4E2A\u5F00\u653E\u6E90\u4EE3\u7801\u7684\u8BBE\u8BA1\u5C42\u9762\u6846\u67B6\uFF0C\u4ED6\u89E3\u51B3\u7684\u662F\u4E1A\u52A1\u903B\u8F91\u5C42\u548C\u5176\u4ED6\u5404\u5C42\u7684\u677E\u8026\u5408\u95EE\u9898\uFF0C\u56E0\u6B64\u5B83\u5C06\u9762\u5411\u63A5\u53E3\u7684\u7F16\u7A0B\u601D\u60F3\u8D2F\u7A7F\u6574\u4E2A\u7CFB\u7EDF\u5E94\u7528\u3002Spring\u662F\u4E8E2003 \u5E74\u5174\u8D77\u7684\u4E00\u4E2A\u8F7B\u91CF\u7EA7\u7684Java \u5F00\u53D1\u6846\u67B6\uFF0C\u7531Rod Johnson\u521B\u5EFA\u3002\u7B80\u5355\u6765\u8BF4\uFF0CSpring\u662F\u4E00\u4E2A\u5206\u5C42\u7684JavaSE/EE full-stack(\u4E00\u7AD9\u5F0F) \u8F7B\u91CF\u7EA7\u5F00\u6E90\u6846\u67B6\u3002</p><h3 id="\u6574\u4F53\u67B6\u6784"><a class="header-anchor" href="#\u6574\u4F53\u67B6\u6784" aria-hidden="true">#</a> \u6574\u4F53\u67B6\u6784</h3><p>Spring\u6846\u67B6\u662F\u4E00\u4E2A\u5206\u5C42\u67B6\u6784\uFF0C\u5B83\u5305\u542B\u4E00\u7CFB\u5217\u7684\u529F\u80FD\u8981\u7D20\uFF0C\u5E76\u88AB\u5206\u4E3A\u5927\u7EA620\u4E2A\u6A21\u5757\uFF0C\u5982\u4E0B\u56FE\u6240\u793A\uFF1A</p><p>![img](./spring5 \u6E90\u7801\u6DF1\u5EA6\u89E3\u6790/1168971-20190618162520007-1760363322.png)</p><p>\u4ECE\u4E0A\u56FEspring framework\u6574\u4F53\u67B6\u6784\u56FE\u53EF\u4EE5\u770B\u5230\uFF0C\u8FD9\u4E9B\u6A21\u5757\u88AB\u603B\u7ED3\u4E3A\u4EE5\u4E0B\u51E0\u4E2A\u90E8\u5206\uFF1A</p><h4 id="core-container"><a class="header-anchor" href="#core-container" aria-hidden="true">#</a> Core COntainer</h4><p>Core Container(\u6838\u5FC3\u5BB9\u5668)\u5305\u542B\u6709Core\u3001Beans\u3001Context\u548CExpression Language\u6A21\u5757</p><p>Core\u548CBeans\u6A21\u5757\u662F\u6846\u67B6\u7684\u57FA\u7840\u90E8\u5206\uFF0C\u63D0\u4F9BIoC(\u8F6C\u63A7\u5236)\u548C\u4F9D\u8D56\u6CE8\u5165\u7279\u6027\u3002\u8FD9\u91CC\u7684\u57FA\u7840\u6982\u5FF5\u662FBeanFactory\uFF0C\u5B83\u63D0\u4F9B\u5BF9Factory\u6A21\u5F0F\u7684\u7ECF\u5178\u5B9E\u73B0\u6765\u6D88\u9664\u5BF9\u7A0B\u5E8F\u6027\u5355\u4F8B\u6A21\u5F0F\u7684\u9700\u8981\uFF0C\u5E76\u771F\u6B63\u5730\u5141\u8BB8\u4F60\u4ECE\u7A0B\u5E8F\u903B\u8F91\u4E2D\u5206\u79BB\u51FA\u4F9D\u8D56\u5173\u7CFB\u548C\u914D\u7F6E\u3002</p><p>Core\u6A21\u5757\u4E3B\u8981\u5305\u542BSpring\u6846\u67B6\u57FA\u672C\u7684\u6838\u5FC3\u5DE5\u5177\u7C7B</p><p>Beans\u6A21\u5757\u662F\u6240\u6709\u5E94\u7528\u90FD\u8981\u7528\u5230\u7684\uFF0C\u5B83\u5305\u542B\u8BBF\u95EE\u914D\u7F6E\u6587\u4EF6\u3001\u521B\u5EFA\u548C\u7BA1\u7406bean\u4EE5\u53CA\u8FDB\u884CInversion of Control/Dependency Injection(Ioc/DI)\u64CD\u4F5C\u76F8\u5173\u7684\u6240\u6709\u7C7B</p><p>Context\u6A21\u5757\u6784\u5EFA\u4E8ECore\u548CBeans\u6A21\u5757\u57FA\u7840\u4E4B\u4E0A\uFF0C\u63D0\u4F9B\u4E86\u4E00\u79CD\u7C7B\u4F3C\u4E8EJNDI\u6CE8\u518C\u5668\u7684\u6846\u67B6\u5F0F\u7684\u5BF9\u8C61\u8BBF\u95EE\u65B9\u6CD5\u3002Context\u6A21\u5757\u7EE7\u627F\u4E86Beans\u7684\u7279\u6027\uFF0C\u4E3ASpring\u6838\u5FC3\u63D0\u4F9B\u4E86\u5927\u91CF\u6269\u5C55\uFF0C\u6DFB\u52A0\u4E86\u5BF9\u56FD\u9645\u5316(\u5982\u8D44\u6E90\u7ED1\u5B9A)\u3001\u4E8B\u4EF6\u4F20\u64AD\u3001\u8D44\u6E90\u52A0\u8F7D\u548C\u5BF9Context\u7684\u900F\u660E\u521B\u5EFA\u7684\u652F\u6301\u3002ApplicationContext\u63A5\u53E3\u662FContext\u6A21\u5757\u7684\u5173\u952E</p><p>Expression Language\u6A21\u5757\u63D0\u4F9B\u4E86\u4E00\u4E2A\u5F3A\u5927\u7684\u8868\u8FBE\u5F0F\u8BED\u8A00\u7528\u4E8E\u5728\u8FD0\u884C\u65F6\u67E5\u8BE2\u548C\u64CD\u7EB5\u5BF9\u8C61\uFF0C\u8BE5\u8BED\u8A00\u652F\u6301\u8BBE\u7F6E/\u83B7\u53D6\u5C5E\u6027\u7684\u503C\uFF0C\u5C5E\u6027\u7684\u5206\u914D\uFF0C\u65B9\u6CD5\u7684\u8C03\u7528\uFF0C\u8BBF\u95EE\u6570\u7EC4\u4E0A\u4E0B\u6587\u3001\u5BB9\u5668\u548C\u7D22\u5F15\u5668\u3001\u903B\u8F91\u548C\u7B97\u672F\u8FD0\u7B97\u7B26\u3001\u547D\u540D\u53D8\u91CF\u4EE5\u53CA\u4ECESpring\u7684IoC\u5BB9\u5668\u4E2D\u6839\u636E\u540D\u79F0\u68C0\u7D22\u5BF9\u8C61</p><h4 id="data-access-integration"><a class="header-anchor" href="#data-access-integration" aria-hidden="true">#</a> Data Access/Integration</h4><p>JDBC\u6A21\u5757\u63D0\u4F9B\u4E86\u4E00\u4E2AJDBC\u62BD\u8C61\u5C42\uFF0C\u5B83\u53EF\u4EE5\u6D88\u9664\u5197\u957F\u7684JDBC\u7F16\u7801\u548C\u89E3\u6790\u6570\u636E\u5E93\u5382\u5546\u7279\u6709\u7684\u9519\u8BEF\u4EE3\u7801\uFF0C\u8FD9\u4E2A\u6A21\u5757\u5305\u542B\u4E86Spring\u5BF9JDBC\u6570\u636E\u8BBF\u95EE\u8FDB\u884C\u5C01\u88C5\u7684\u6240\u6709\u7C7B</p><p>ORM\u6A21\u5757\u4E3A\u6D41\u884C\u7684\u5BF9\u8C61-\u5173\u7CFB\u6620\u5C04API\uFF0C\u5982JPA\u3001JDO\u3001Hibernate\u3001iBatis\u7B49\uFF0C\u63D0\u4F9B\u4E86\u4E00\u4E2A\u4EA4\u4E92\u5C42\uFF0C\u5229\u7528ORM\u5C01\u88C5\u5305\uFF0C\u53EF\u4EE5\u6DF7\u5408\u4F7F\u7528\u6240\u6709Spring\u63D0\u4F9B\u7684\u7279\u6027\u8FDB\u884CO/R\u6620\u5C04\uFF0C\u5982\u524D\u8FB9\u63D0\u5230\u7684\u7B80\u5355\u58F0\u660E\u6027\u4E8B\u52A1\u7BA1\u7406</p><p>OXM\u6A21\u5757\u63D0\u4F9B\u4E86\u4E00\u4E2AObject/XML\u6620\u5C04\u5B9E\u73B0\u7684\u62BD\u8C61\u5C42\uFF0CObject/XML\u6620\u5C04\u5B9E\u73B0\u62BD\u8C61\u5C42\u5305\u62ECJAXB\uFF0CCastor\uFF0CXMLBeans\uFF0CJiBX\u548CXStream JMS\uFF08java Message Service\uFF09\u6A21\u5757\u4E3B\u8981\u5305\u542B\u4E86\u4E00\u4E9B\u5236\u9020\u548C\u6D88\u8D39\u6D88\u606F\u7684\u7279\u6027</p><p>Transaction\u6A21\u5757\u652F\u6301\u7F16\u7A0B\u548C\u58F0\u660E\u5F0F\u4E8B\u7269\u7BA1\u7406\uFF0C\u8FD9\u4E9B\u4E8B\u52A1\u7C7B\u5FC5\u987B\u5B9E\u73B0\u7279\u5B9A\u7684\u63A5\u53E3\uFF0C\u5E76\u4E14\u5BF9\u6240\u6709POJO\u90FD\u9002\u7528</p><h4 id="web"><a class="header-anchor" href="#web" aria-hidden="true">#</a> Web</h4><p>Web\u4E0A\u4E0B\u6587\u6A21\u5757\u5EFA\u7ACB\u5728\u5E94\u7528\u7A0B\u5E8F\u4E0A\u4E0B\u6587\u6A21\u5757\u4E4B\u4E0A\uFF0C\u4E3A\u57FA\u4E8EWeb\u7684\u5E94\u7528\u7A0B\u5E8F\u63D0\u4F9B\u4E86\u4E0A\u4E0B\u6587\uFF0C\u6240\u4EE5Spring\u6846\u67B6\u652F\u6301\u4E0EJakarta Struts\u7684\u96C6\u6210\u3002Web\u6A21\u5757\u8FD8\u7B80\u5316\u4E86\u5904\u7406\u591A\u90E8\u5206\u8BF7\u6C42\u4EE5\u53CA\u5C06\u8BF7\u6C42\u53C2\u6570\u7ED1\u5B9A\u5230\u57DF\u5BF9\u8C61\u7684\u5DE5\u4F5C\u3002Web\u5C42\u5305\u542B\u4E86Web\u3001Web-Servlet\u3001Web-Struts\u548CWeb\u3001Porlet\u6A21\u5757</p><p>Web\u6A21\u5757\uFF1A\u63D0\u4F9B\u4E86\u57FA\u7840\u7684\u9762\u5411Web\u7684\u96C6\u6210\u7279\u6027\uFF0C\u4F8B\u5982\uFF0C\u591A\u6587\u4EF6\u4E0A\u4F20\u3001\u4F7F\u7528Servlet</p><p>listeners\u521D\u59CB\u5316IoC\u5BB9\u5668\u4EE5\u53CA\u4E00\u4E2A\u9762\u5411Web\u7684\u5E94\u7528\u4E0A\u4E0B\u6587\uFF0C\u5B83\u8FD8\u5305\u542B\u4E86Spring\u8FDC\u7A0B\u652F\u6301\u4E2DWeb\u7684\u76F8\u5173\u90E8\u5206</p><p>Web-Servlet\u6A21\u5757web.servlet.jar\uFF1A\u8BE5\u6A21\u5757\u5305\u542BSpring\u7684model-view-controller(MVC)\u5B9E\u73B0\uFF0CSpring\u7684MVC\u6846\u67B6\u4F7F\u5F97\u6A21\u578B\u8303\u56F4\u5185\u7684\u4EE3\u7801\u548Cweb forms\u4E4B\u95F4\u80FD\u591F\u6E05\u695A\u5730\u5206\u79BB\u5F00\u6765\uFF0C\u5E76\u4E0ESpring\u6846\u67B6\u7684\u5176\u4ED6\u7279\u6027\u57FA\u7840\u5728\u4E00\u8D77</p><p>Web-Struts\u6A21\u5757\uFF1A\u8BE5\u6A21\u5757\u63D0\u4F9B\u4E86\u5BF9Struts\u7684\u652F\u6301\uFF0C\u4F7F\u5F97\u7C7B\u5728Spring\u5E94\u7528\u4E2D\u80FD\u591F\u4E0E\u4E00\u4E2A\u5178\u578B\u7684Struts Web\u5C42\u96C6\u6210\u5728\u4E00\u8D77</p><p>Web-Porlet\u6A21\u5757\uFF1A\u63D0\u4F9B\u4E86\u7528\u4E8EPortlet\u73AF\u5883\u548CWeb-Servlet\u6A21\u5757\u7684MVC\u7684\u5B9E\u73B0</p><h4 id="aop"><a class="header-anchor" href="#aop" aria-hidden="true">#</a> AOP</h4><p>AOP\u6A21\u5757\u63D0\u4F9B\u4E86\u4E00\u4E2A\u7B26\u5408AOP\u8054\u76DF\u6807\u51C6\u7684\u9762\u5411\u5207\u9762\u7F16\u7A0B\u7684\u5B9E\u73B0\uFF0C\u5B83\u8BA9\u4F60\u53EF\u4EE5\u5B9A\u4E49\u4F8B\u5982\u65B9\u6CD5\u62E6\u622A\u5668\u548C\u5207\u70B9\uFF0C\u4ECE\u800C\u5C06\u903B\u8F91\u4EE3\u7801\u5206\u5F00\uFF0C\u964D\u4F4E\u5B83\u4EEC\u4E4B\u95F4\u7684\u8026\u5408\u6027\uFF0C\u5229\u7528source-level\u7684\u5143\u6570\u636E\u529F\u80FD\uFF0C\u8FD8\u53EF\u4EE5\u5C06\u5404\u79CD\u884C\u4E3A\u4FE1\u606F\u5408\u5E76\u5230\u4F60\u7684\u4EE3\u7801\u4E2D</p><p>Spring AOP\u6A21\u5757\u4E3A\u57FA\u4E8ESpring\u7684\u5E94\u7528\u7A0B\u5E8F\u4E2D\u7684\u5BF9\u8C61\u63D0\u4F9B\u4E86\u4E8B\u52A1\u7BA1\u7406\u670D\u52A1\uFF0C\u901A\u8FC7\u4F7F\u7528Spring AOP\uFF0C\u4E0D\u7528\u4F9D\u8D56EJB\u7EC4\u4EF6\uFF0C\u5C31\u53EF\u4EE5\u5C06\u58F0\u660E\u6027\u4E8B\u52A1\u7BA1\u7406\u96C6\u6210\u5230\u5E94\u7528\u7A0B\u5E8F\u4E2D</p><h4 id="test"><a class="header-anchor" href="#test" aria-hidden="true">#</a> Test</h4><p>Test\u6A21\u5757\u652F\u6301\u4F7F\u7528Junit\u548CTestNG\u5BF9Spring\u7EC4\u4EF6\u8FDB\u884C\u6D4B\u8BD5</p><h3 id="\u73AF\u5883\u642D\u5EFA"><a class="header-anchor" href="#\u73AF\u5883\u642D\u5EFA" aria-hidden="true">#</a> \u73AF\u5883\u642D\u5EFA</h3><h4 id="gradle\u5B89\u88C5"><a class="header-anchor" href="#gradle\u5B89\u88C5" aria-hidden="true">#</a> gradle\u5B89\u88C5</h4><p>Gradle\u662F\u4E00\u4E2A\u57FA\u4E8EJVM\u7684\u6784\u5EFA\u5DE5\u5177\uFF0C\u662F\u4E00\u6B3E\u901A\u7528\u7075\u6D3B\u7684\u6784\u5EFA\u5DE5\u5177\uFF0C\u652F\u6301maven\uFF0C Ivy\u4ED3\u5E93\uFF0C\u652F\u6301\u4F20\u9012\u6027\u4F9D\u8D56\u7BA1\u7406\uFF0C\u800C\u4E0D\u9700\u8981\u8FDC\u7A0B\u4ED3\u5E93\u6216\u8005\u662Fpom.xml\u548Civy.xml\u914D\u7F6E\u6587\u4EF6\uFF0C\u57FA\u4E8EGroovy\uFF0Cbuild\u811A\u672C\u4F7F\u7528Groovy\u7F16\u5199\uFF0C\u9700\u8981\u5230gradle\u5B98\u7F51\u4E0B\u8F7D\u5BF9\u5E94\u7248\u672C\uFF0C<code>http://services.gradle.org/distributions</code></p><p>windows\u73AF\u5883\u4E0B\u9700\u8981\u4FEE\u6539\u7CFB\u7EDF\u53D8\u91CF\uFF0C\u6DFB\u52A0GRADLE_HOME\u7CFB\u7EDF\u53D8\u91CF\uFF0C\u6307\u5411gradle\u6839\u76EE\u5F55\u3002\u73AF\u5883\u914D\u7F6E\u6210\u529F\u540E\uFF0C\u5728\u547D\u4EE4\u884C\u8F93\u5165\uFF1A<code>gradle -v</code> \u663E\u793A\u5982\u4E0B\u622A\u56FE\uFF1A</p><p>![image-20220213101902139](./spring5 \u6E90\u7801\u6DF1\u5EA6\u89E3\u6790/image-20220213101902139.png)</p><h4 id="\u6E90\u7801\u94FE\u63A5\u83B7\u53D6"><a class="header-anchor" href="#\u6E90\u7801\u94FE\u63A5\u83B7\u53D6" aria-hidden="true">#</a> \u6E90\u7801\u94FE\u63A5\u83B7\u53D6</h4><ol><li>\u8FDB\u5165\u5B98\u7F51<code>https://projects.spring.io/spring-framework/</code>\uFF0C\u70B9\u51FB\u90A3\u4E2A\u5C0F\u732B\u7684\u56FE\u50CF\uFF0C\u8FDB\u5165github\u4E0B\u8F7D\u76F8\u5E94\u7248\u672C\u7684spring\u6E90\u7801\u3002</li></ol><p>![img](./spring5 \u6E90\u7801\u6DF1\u5EA6\u89E3\u6790/1168971-20190618163022143-1581931937.png)</p><ol start="2"><li>\u5207\u6362\u4E3A\u6700\u65B0\u7684 Spring 5.1. x\u7248 \u6E90\u7801 \uFF0C\u83B7\u53D6 Git \u5206\u652F\u94FE\u63A5</li></ol><p>![img](./spring5 \u6E90\u7801\u6DF1\u5EA6\u89E3\u6790/1168971-20190618163256215-1780034071.png)</p><h4 id="\u6E90\u7801\u4E0B\u8F7D\u53CAidea\u5BFC\u5165"><a class="header-anchor" href="#\u6E90\u7801\u4E0B\u8F7D\u53CAidea\u5BFC\u5165" aria-hidden="true">#</a> \u6E90\u7801\u4E0B\u8F7D\u53CAidea\u5BFC\u5165</h4><ol><li>IDEA Spring Git \u62C9\u53D6\u5206\u652F</li></ol><p>![img](./spring5 \u6E90\u7801\u6DF1\u5EA6\u89E3\u6790/1168971-20190618163632736-276196879.png)</p><ol start="2"><li>\u672C\u5730\u5B89\u88C5\u76EE\u5F55\u8BBE\u7F6E</li></ol><p>![img](./spring5 \u6E90\u7801\u6DF1\u5EA6\u89E3\u6790/1168971-20190618163644677-9645493.png)</p><ol start="3"><li>\u62C9\u53D6\u7B49\u5F85</li></ol><p>![img](./spring5 \u6E90\u7801\u6DF1\u5EA6\u89E3\u6790/1168971-20190618163656589-1521835139.png)</p><p>\u4E5F\u53EF\u4EE5\u624B\u52A8\u76F4\u63A5\u4E0B\u8F7D\u6E90\u7801\u5230\u672C\u5730</p><p>\u6839\u636Eimport-into-idea.md\u64CD\u4F5C\uFF0C\u5BFC\u5165\u5230idea\u4E2D</p><blockquote><p>\u6B64\u5904\u7684gradle\u4F7F\u7528\u6211\u4EEC\u4E4B\u524D\u81EA\u5DF1\u5B89\u88C5\u76844.3.1\u7248\u672C\uFF0C\u4E0D\u8981\u7528IDE\u81EA\u5E26\u7684\uFF1B</p><p>\u5C06jdk\u7248\u672C\u5347\u7EA7\u52301.8\uFF0C\u56E0\u4E3A\u5728\u6700\u65B0\u7684Spring\u4E2D\u4F7F\u7528\u5230\u4E86jdk1.8\u7684\u65B0\u7279\u6027\uFF0C\u5982\u679C\u4E0D\u5347\u7EA7\u52301.8\u4F1A\u62A5\u9519</p></blockquote><p>\u6700\u540Eidea\u4F1A\u81EA\u52A8\u7F16\u8BD1spring\u6E90\u7801\uFF0C\u7F16\u8BD1\u6210\u529F\u4EE5\u540E\uFF0C\u6240\u6709\u7684\u6A21\u5757\u90FD\u4F1A\u6709\u4E2A\u5C0F\u5C0F\u7684\u84DD\u8272\u56FE\u6807\uFF0C\u8868\u793A\u7F16\u8BD1\u6210\u529F\uFF0C\u81F3\u6B64spring\u6E90\u7801\u5BFC\u5165\u5B8C\u6210\u3002</p><h4 id="\u5BFC\u5165\u9879\u76EE\u9047\u89C1\u95EE\u9898"><a class="header-anchor" href="#\u5BFC\u5165\u9879\u76EE\u9047\u89C1\u95EE\u9898" aria-hidden="true">#</a> \u5BFC\u5165\u9879\u76EE\u9047\u89C1\u95EE\u9898</h4><ol><li>No such property: immutableValues for class: org.gradle.api.internal.tasks.DefaultTaskDependency</li></ol><p>\u4FEE\u6539\uFF1A<code>spring-beans.gradle</code></p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>\u6CE8\u91CA\u6389\u8FD9\u4E24\u884C\u4EE3\u7801
<span class="token comment">//def deps = compileGroovy.taskDependencies.immutableValues + compileGroovy.taskDependencies.mutableValues</span>
<span class="token comment">//compileGroovy.dependsOn = deps - &#39;compileJava&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>Could not find method useJUnitPlatform()</li></ol><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>\u6CE8\u91CA\uFF1Aspring-test.gradle\u4E2D\u8FD9\u884C\u4EE3\u7801
<span class="token comment">//  useJUnitPlatform {</span>
<span class="token comment">//    includeEngines &#39;junit-jupiter&#39;</span>
<span class="token comment">//    excludeTags &#39;failing-test-case&#39;</span>
<span class="token comment">// }</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u521B\u5EFA\u6D4B\u8BD5\u9879\u76EE"><a class="header-anchor" href="#\u521B\u5EFA\u6D4B\u8BD5\u9879\u76EE" aria-hidden="true">#</a> \u521B\u5EFA\u6D4B\u8BD5\u9879\u76EE</h3><p>\u5BFC\u5165\u6210\u529F\u4E4B\u540E\u53EF\u4EE5\u5728project\u4E0B\u521B\u5EFA\u4E00\u4E2A\u81EA\u5DF1\u7684\u6D4B\u8BD5module</p><ol><li>\u9879\u76EE\u6839\u76EE\u5F55\u53F3\u952E -&gt; new -&gt; module -&gt; gradle</li></ol><p>![img](./spring5 \u6E90\u7801\u6DF1\u5EA6\u89E3\u6790/1168971-20190619105643772-1342809334.png)</p><ol start="2"><li>\u5728\u65B0\u9879\u76EE\u7684build.gradle\u4E0B\u6DFB\u52A0\u5BF9spring\u6A21\u5757\u7684\u4F9D\u8D56\uFF0C\u8FD9\u91CC\u6211\u5148\u6DFB\u52A0\u4E86spring-beans \u548Cspring-core\u7684\u4F9D\u8D56\u3002</li></ol><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>dependencies <span class="token punctuation">{</span>
    compile(project(<span class="token string">&quot;:spring-beans&quot;</span>))
    compile(project(<span class="token string">&quot;:spring-core&quot;</span>))
    testCompile group<span class="token operator">:</span> &#39;junit&#39;<span class="token punctuation">,</span> name<span class="token operator">:</span> &#39;junit&#39;<span class="token punctuation">,</span> version<span class="token operator">:</span> &#39;<span class="token number">4.12</span>&#39;
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>\u5728\u65B0\u9879\u76EE\u7684src/main/resource\u4E0B\u6DFB\u52A0spring-config.xml\u6587\u4EF6</li></ol><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myTestBean<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.chenhao.spring.MyTestBean<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li>\u521B\u5EFA\u6D4B\u8BD5bean\u548C\u542F\u52A8\u7C7B</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyTestBean</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name <span class="token operator">=</span> <span class="token string">&quot;ChenHao&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">MyTestBean</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">MyTestBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;MyTestBean{&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;name=&#39;&quot;</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token char">&#39;\\&#39;&#39;</span> <span class="token operator">+</span>
                <span class="token char">&#39;}&#39;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppTest</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">MyTestBeanTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">BeanFactory</span> bf <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XmlBeanFactory</span><span class="token punctuation">(</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathResource</span><span class="token punctuation">(</span><span class="token string">&quot;spring-config.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">MyTestBean</span> myTestBean <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">MyTestBean</span><span class="token punctuation">)</span> bf<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">&quot;myTestBean&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>myTestBean<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E4B\u540E\u5C31\u53EF\u4EE5\u6109\u5FEB\u7684\u8C03\u8BD5spring\u6E90\u7801\u4E86</p><h3 id="ioc\u4E4B\u5BB9\u5668\u7684\u57FA\u672C\u5B9E\u73B0"><a class="header-anchor" href="#ioc\u4E4B\u5BB9\u5668\u7684\u57FA\u672C\u5B9E\u73B0" aria-hidden="true">#</a> IOC\u4E4B\u5BB9\u5668\u7684\u57FA\u672C\u5B9E\u73B0</h3><h3 id="\u6982\u8FF0-1"><a class="header-anchor" href="#\u6982\u8FF0-1" aria-hidden="true">#</a> \u6982\u8FF0</h3><p>\u5206\u6790spring\u7684\u6E90\u7801\u4E4B\u524D\u6211\u4EEC\u5148\u6765\u7B80\u5355\u56DE\u987E\u4E0Bspring\u6838\u5FC3\u529F\u80FD\u7684\u7B80\u5355\u4F7F\u7528</p><h3 id="\u5BB9\u5668\u7684\u57FA\u672C\u7528\u6CD5"><a class="header-anchor" href="#\u5BB9\u5668\u7684\u57FA\u672C\u7528\u6CD5" aria-hidden="true">#</a> \u5BB9\u5668\u7684\u57FA\u672C\u7528\u6CD5</h3><p>bean\u662Fspring\u6700\u6838\u5FC3\u7684\u4E1C\u897F\uFF0Cspring\u5C31\u50CF\u662F\u4E00\u4E2A\u5927\u6C34\u6876\uFF0C\u800Cbean\u5C31\u662F\u6C34\u6876\u4E2D\u7684\u6C34\uFF0C\u6C34\u6876\u8131\u79BB\u4E86\u6C34\u4E5F\u5C31\u6CA1\u6709\u4EC0\u4E48\u7528\u5904\u4E86\uFF0C\u6211\u4EEC\u7B80\u5355\u770B\u4E0Bbean\u7684\u5B9A\u4E49\uFF0C\u4EE3\u7801\u5982\u4E0B\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyTestBean</span> <span class="token punctuation">{</span>
	<span class="token keyword">private</span> <span class="token class-name">String</span> name <span class="token operator">=</span> <span class="token string">&quot;\u5F20\u4E09&quot;</span><span class="token punctuation">;</span>

	<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> name<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6E90\u7801\u5F88\u7B80\u5355\uFF0Cbean\u6CA1\u6709\u7279\u522B\u4E4B\u5904\uFF0Cspring\u7684\u7684\u76EE\u7684\u5C31\u662F\u8BA9\u6211\u4EEC\u7684bean\u6210\u4E3A\u4E00\u4E2A\u7EAF\u7CB9\u7684\u7684POJO\uFF0C\u8FD9\u5C31\u662Fspring\u8FFD\u6C42\u7684\uFF0C\u63A5\u4E0B\u6765\u5C31\u662F\u5728\u914D\u7F6E\u6587\u4EF6\u4E2D\u5B9A\u4E49\u8FD9\u4E2Abean\uFF0C\u914D\u7F6E\u6587\u4EF6\u5982\u4E0B\uFF1A</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans<span class="token punctuation">&quot;</span></span>
	   <span class="token attr-name"><span class="token namespace">xmlns:</span>context</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/context<span class="token punctuation">&quot;</span></span>
	   <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
	   <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
							http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.ald.spring.bean.MyTestBean<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myTestBean<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728\u4E0A\u9762\u7684\u914D\u7F6E\u4E2D\u6211\u4EEC\u53EF\u4EE5\u770B\u5230bean\u7684\u58F0\u660E\u65B9\u5F0F\uFF0C\u5728spring\u4E2D\u7684bean\u5B9A\u4E49\u6709N\u79CD\u5C5E\u6027\uFF0C\u4F46\u662F\u6211\u4EEC\u53EA\u8981\u50CF\u4E0A\u9762\u8FD9\u6837\u7B80\u5355\u7684\u58F0\u660E\u5C31\u53EF\u4EE5\u4F7F\u7528\u4E86\u3002 \u5177\u4F53\u6D4B\u8BD5\u4EE3\u7801\u5982\u4E0B\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MainTest</span> <span class="token punctuation">{</span>
	<span class="token annotation punctuation">@Test</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">MyTestBeanTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">final</span> <span class="token class-name">XmlBeanFactory</span> factory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XmlBeanFactory</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ClassPathResource</span><span class="token punctuation">(</span><span class="token string">&quot;spring.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">final</span> <span class="token class-name">MyTestBean</span> testBean <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">MyTestBean</span><span class="token punctuation">)</span> factory<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">&quot;myTestBean&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>testBean<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD0\u884C\u4E0A\u8FF0\u6D4B\u8BD5\u4EE3\u7801\u5C31\u53EF\u4EE5\u770B\u5230\u8F93\u51FA\u7ED3\u679C\u5982\u4E0B\u56FE\uFF1A</p><p>![image-20220213141841572](./spring5 \u6E90\u7801\u6DF1\u5EA6\u89E3\u6790/image-20220213141841572.png)</p><p>\u5176\u5B9E\u76F4\u63A5\u4F7F\u7528BeanFactory\u4F5C\u4E3A\u5BB9\u5668\u5BF9\u4E8ESpring\u7684\u4F7F\u7528\u5E76\u4E0D\u591A\u89C1\uFF0C\u56E0\u4E3A\u4F01\u4E1A\u7EA7\u5E94\u7528\u9879\u76EE\u4E2D\u5927\u591A\u4F1A\u4F7F\u7528\u7684\u662FApplicationContext\uFF08\u540E\u9762\u6211\u4EEC\u4F1A\u8BB2\u4E24\u8005\u7684\u533A\u522B\uFF0C\u8FD9\u91CC\u53EA\u662F\u6D4B\u8BD5\uFF09</p><h3 id="\u529F\u80FD\u5206\u6790"><a class="header-anchor" href="#\u529F\u80FD\u5206\u6790" aria-hidden="true">#</a> \u529F\u80FD\u5206\u6790</h3><p>\u63A5\u4E0B\u6765\u6211\u4EEC\u5206\u67902\u4E2D\u4EE3\u7801\u5B8C\u6210\u7684\u529F\u80FD\uFF1A</p><ul><li>\u8BFB\u53D6\u914D\u7F6E\u6587\u4EF6<code>spring-config.xml</code></li><li>\u6839\u636E<code>spring-config.xml</code>\u4E2D\u7684\u914D\u7F6E\u627E\u5230\u5BF9\u5E94\u7684\u7C7B\u7684\u914D\u7F6E\uFF0C\u5E76\u5B9E\u4F8B\u5316</li><li>\u8C03\u7528\u5B9E\u4F8B\u5316\u540E\u7684\u5B9E\u4F8B</li></ul><p>\u4E0B\u56FE\u662F\u4E00\u4E2A\u6700\u7B80\u5355spring\u529F\u80FD\u67B6\u6784\uFF0C\u5982\u679C\u60F3\u5B8C\u6210\u6211\u4EEC\u9884\u60F3\u7684\u529F\u80FD\uFF0C\u81F3\u5C11\u9700\u89813\u4E2A\u7C7B\uFF1A</p><p>![img](./spring5 \u6E90\u7801\u6DF1\u5EA6\u89E3\u6790/1168971-20190701114959270-1671553060.png)</p><p><strong>ConfigReader</strong> \uFF1A\u7528\u4E8E\u8BFB\u53D6\u53CA\u9A8C\u8BC1\u81EA\u5DF1\u503C\u6587\u4EF6 \u6211\u4EEC\u59A5\u7528\u914D\u76F4\u6587\u4EF6\u91CC\u9762\u7684\u4E1C\u897F\uFF0C\u5F53\u7136\u9996\u5148\u8981\u505A\u7684\u5C31\u662F\u8BFB\u53D6\uFF0C\u7136\u540E\u653E\u503C\u5728\u5185\u5B58\u4E2D</p><p><strong>ReflectionUtil</strong> \uFF1A\u7528\u4E8E\u6839\u636E\u914D\u7F6E\u6587\u4EF6\u4E2D\u7684\u81EA\u5DF1\u503C\u8FDB\u884C\u53CD\u5C04\u5B9E\u4F8B\u5316,\u6BD4\u5982\u5728\u4E0A\u4F8B\u4E2D spring-config.xml \u51FA\u73B0\u7684<code>&lt;bean id=&quot;myTestBean&quot; class=&quot;com.chenhao.spring.MyTestBean&quot;/&gt;</code>\uFF0C\u6211\u4EEC\u5C31\u53EF\u4EE5\u6839\u636E com.chenhao.spring.MyTestBean \u8FDB\u884C\u5B9E\u4F8B\u5316</p><p><strong>App</strong> \uFF1A\u7528\u4E8E\u5B8C\u6210\u6574\u4E2A\u903B\u8F91\u7684\u4E32\u8054</p><h3 id="\u5DE5\u7A0B\u642D\u5EFA"><a class="header-anchor" href="#\u5DE5\u7A0B\u642D\u5EFA" aria-hidden="true">#</a> \u5DE5\u7A0B\u642D\u5EFA</h3><p>spring\u7684\u6E90\u7801\u4E2D\u7528\u4E8E\u5B9E\u73B0\u4E0A\u9762\u529F\u80FD\u7684\u662Fspring-bean\u8FD9\u4E2A\u5DE5\u7A0B\uFF0C\u6240\u4EE5\u6211\u4EEC\u63A5\u4E0B\u6765\u770B\u8FD9\u4E2A\u5DE5\u7A0B\uFF0C\u5F53\u7136spring-core\u662F\u5FC5\u987B\u7684\u3002</p><h4 id="beans\u5305\u7684\u5C42\u7EA7\u7ED3\u7ED3\u6784"><a class="header-anchor" href="#beans\u5305\u7684\u5C42\u7EA7\u7ED3\u7ED3\u6784" aria-hidden="true">#</a> beans\u5305\u7684\u5C42\u7EA7\u7ED3\u7ED3\u6784</h4><p>\u9605\u8BFB\u6E90\u7801\u6700\u597D\u7684\u65B9\u5F0F\u662F\u8DDF\u7740\u793A\u4F8B\u64CD\u4F5C\u4E00\u904D\uFF0C\u6211\u4EEC\u5148\u770B\u770Bbeans\u5DE5\u7A0B\u7684\u6E90\u7801\u7ED3\u6784\uFF0C\u5982\u4E0B\u56FE\u6240\u793A\uFF1A</p><p>![image-20220213142829928](./spring5 \u6E90\u7801\u6DF1\u5EA6\u89E3\u6790/image-20220213142829928.png)</p><ul><li>src/main/java \u7528\u4E8E\u5C55\u73B0Spring\u7684\u4E3B\u8981\u903B\u8F91</li><li>src/main/resources \u7528\u4E8E\u5B58\u653E\u7CFB\u7EDF\u7684\u914D\u7F6E\u6587\u4EF6</li><li>src/test/java \u7528\u4E8E\u5BF9\u4E3B\u8981\u903B\u8F91\u8FDB\u884C\u5355\u5143\u6D4B\u8BD5</li><li>src/test/resources \u7528\u4E8E\u5B58\u653E\u6D4B\u8BD5\u7528\u7684\u914D\u7F6E\u6587\u4EF6</li></ul><h4 id="\u6838\u5FC3\u7C7B\u4ECB\u7ECD"><a class="header-anchor" href="#\u6838\u5FC3\u7C7B\u4ECB\u7ECD" aria-hidden="true">#</a> \u6838\u5FC3\u7C7B\u4ECB\u7ECD</h4><p>\u63A5\u4E0B\u6765\u6211\u4EEC\u5148\u4E86\u89E3\u4E0Bspring-bean\u6700\u6838\u5FC3\u7684\u4E24\u4E2A\u7C7B\uFF1ADefaultListableBeanFactory\u548CXmlBeanDefinitionReader</p><h5 id="defaultlistablebeanfactory"><a class="header-anchor" href="#defaultlistablebeanfactory" aria-hidden="true">#</a> DefaultListableBeanFactory</h5><p>XmlBeanFactory\u7EE7\u627F\u81EADefaultListableBeanFactory\uFF0C\u800CDefaultListableBeanFactory\u662F\u6574\u4E2Abean\u52A0\u8F7D\u7684\u6838\u5FC3\u90E8\u5206\uFF0C\u662FSpring\u6CE8\u518C\u53CA\u52A0\u8F7Dbean\u7684\u9ED8\u8BA4\u5B9E\u73B0\uFF0C\u800C\u5BF9\u4E8EXmlBeanFactory\u4E0EDefaultListableBeanFactory\u4E0D\u540C\u7684\u5730\u65B9\u5176\u5B9E\u662F\u5728XmlBeanFactory\u4E2D\u4F7F\u7528\u4E86\u81EA\u5B9A\u4E49\u7684XML\u8BFB\u53D6\u5668XmlBeanDefinitionReader\uFF0C\u5B9E\u73B0\u4E86\u4E2A\u6027\u5316\u7684BeanDefinitionReader\u8BFB\u53D6\uFF0CDefaultListableBeanFactory\u7EE7\u627F\u4E86AbstractAutowireCapableBeanFactory\u5E76\u5B9E\u73B0\u4E86ConfigurableListableBeanFactory\u4EE5\u53CABeanDefinitionRegistry\u63A5\u53E3\u3002</p><p>\u4EE5\u4E0B\u662FConfigurableListableBeanFactory\u7684\u5C42\u6B21\u7ED3\u6784\u56FE\u4EE5\u4E0B\u76F8\u5173\u7C7B\u56FE</p><p>![img](./spring5 \u6E90\u7801\u6DF1\u5EA6\u89E3\u6790/1168971-20190701115923987-1702761663.png)</p><p>\u4E0A\u9762\u7C7B\u56FE\u4E2D\u5404\u4E2A\u7C7B\u53CA\u63A5\u53E3\u7684\u4F5C\u7528\u5982\u4E0B\uFF1A</p><ul><li>AliasRegistry\uFF1A\u5B9A\u4E49\u5BF9alias\u7684\u7B80\u5355\u589E\u5220\u6539\u7B49\u64CD\u4F5C</li><li>SimpleAliasRegistry\uFF1A\u4E3B\u8981\u4F7F\u7528map\u4F5C\u4E3Aalias\u7684\u7F13\u5B58\uFF0C\u5E76\u5BF9\u63A5\u53E3AliasRegistry\u8FDB\u884C\u5B9E\u73B0</li><li>SingletonBeanRegistry\uFF1A\u5B9A\u4E49\u5BF9\u5355\u4F8B\u7684\u6CE8\u518C\u53CA\u83B7\u53D6</li><li>BeanFactory\uFF1A\u5B9A\u4E49\u83B7\u53D6bean\u53CAbean\u7684\u5404\u79CD\u5C5E\u6027</li><li>DefaultSingletonBeanRegistry\uFF1A\u9ED8\u8BA4\u5BF9\u63A5\u53E3SingletonBeanRegistry\u5404\u51FD\u6570\u7684\u5B9E\u73B0</li><li>HierarchicalBeanFactory\uFF1A\u7EE7\u627FBeanFactory\uFF0C\u4E5F\u5C31\u662F\u5728BeanFactory\u5B9A\u4E49\u7684\u529F\u80FD\u7684\u57FA\u7840\u4E0A\u589E\u52A0\u4E86\u5BF9parentFactory\u7684\u652F\u6301</li><li>BeanDefinitionRegistry\uFF1A\u5B9A\u4E49\u5BF9BeanDefinition\u7684\u5404\u79CD\u589E\u5220\u6539\u64CD\u4F5C</li><li>FactoryBeanRegistrySupport\uFF1A\u5728DefaultSingletonBeanRegistry\u57FA\u7840\u4E0A\u589E\u52A0\u4E86\u5BF9FactoryBean\u7684\u7279\u6B8A\u5904\u7406\u529F\u80FD</li><li>ConfigurableBeanFactory\uFF1A\u63D0\u4F9B\u914D\u7F6EFactory\u7684\u5404\u79CD\u65B9\u6CD5</li><li>ListableBeanFactory\uFF1A\u6839\u636E\u5404\u79CD\u6761\u4EF6\u83B7\u53D6bean\u7684\u914D\u7F6E\u6E05\u5355</li><li>AbstractBeanFactory\uFF1A\u7EFC\u5408FactoryBeanRegistrySupport\u548CConfigurationBeanFactory\u7684\u529F\u80FD</li><li>AutowireCapableBeanFactory\uFF1A\u63D0\u4F9B\u521B\u5EFAbean\u3001\u81EA\u52A8\u6CE8\u5165\u3001\u521D\u59CB\u5316\u4EE5\u53CA\u5E94\u7528bean\u7684\u540E\u5904\u7406\u5668</li><li>AbstractAutowireCapableBeanFactory\uFF1A\u7EFC\u5408AbstractBeanFactory\u5E76\u5BF9\u63A5\u53E3AutowireCapableBeanFactory\u8FDB\u884C\u5B9E\u73B0</li><li>ConfigurableListableBeanFactory\uFF1ABeanFactory\u914D\u7F6E\u6E05\u5355\uFF0C\u6307\u5B9A\u5FFD\u7565\u7C7B\u578B\u53CA\u63A5\u53E3\u7B49</li><li>DefaultListableBeanFactory\uFF1A\u7EFC\u5408\u4E0A\u9762\u6240\u6709\u529F\u80FD\uFF0C\u4E3B\u8981\u662F\u5BF9Bean\u6CE8\u518C\u540E\u7684\u5904\u7406</li></ul><p>XmlBeanFactory\u5BF9DefaultListableBeanFactory\u7C7B\u8FDB\u884C\u4E86\u6269\u5C55\uFF0C\u4E3B\u8981\u7528\u4E8E\u4ECEXML\u6587\u6863\u4E2D\u8BFB\u53D6BeanDefinition\uFF0C\u5BF9\u4E8E\u6CE8\u518C\u53CA\u83B7\u53D6Bean\u90FD\u662F\u4F7F\u7528\u4ECE\u7236\u7C7BDefaultListableBeanFactory\u7EE7\u627F\u7684\u65B9\u6CD5\u53BB\u5B9E\u73B0\uFF0C\u800C\u552F\u72EC\u4E0E\u7236\u7C7B\u4E0D\u540C\u7684\u4E2A\u6027\u5316\u5B9E\u73B0\u5C31\u662F\u589E\u52A0\u4E86XmlBeanDefinitionReader\u7C7B\u578B\u7684reader\u5C5E\u6027\u3002</p><p>\u5728XmlBeanFactory\u4E2D\u4E3B\u8981\u4F7F\u7528reader\u5C5E\u6027\u5BF9\u8D44\u6E90\u6587\u4EF6\u8FDB\u884C\u8BFB\u53D6\u548C\u6CE8\u518C</p><h5 id="xmlbeandefinitionreader"><a class="header-anchor" href="#xmlbeandefinitionreader" aria-hidden="true">#</a> XmlBeanDefinitionReader</h5><p>XML\u914D\u7F6E\u6587\u4EF6\u7684\u8BFB\u53D6\u662FSpring\u4E2D\u91CD\u8981\u7684\u529F\u80FD\uFF0C\u56E0\u4E3ASpring\u7684\u5927\u90E8\u5206\u529F\u80FD\u90FD\u662F\u4EE5\u914D\u7F6E\u4F5C\u4E3A\u5207\u5165\u70B9\u7684\uFF0C\u53EF\u4EE5\u4ECEXmlBeanDefinitionReader\u4E2D\u68B3\u7406\u4E00\u4E0B\u8D44\u6E90\u6587\u4EF6\u8BFB\u53D6\u3001\u89E3\u6790\u53CA\u6CE8\u518C\u7684\u5927\u81F4\u8109\u7EDC\uFF0C\u9996\u5148\u770B\u770B\u5404\u4E2A\u7C7B\u7684\u529F\u80FD</p><ul><li>ResourceLoader\uFF1A\u5B9A\u4E49\u8D44\u6E90\u52A0\u8F7D\u5668\uFF0C\u4E3B\u8981\u5E94\u7528\u4E8E\u6839\u636E\u7ED9\u5B9A\u7684\u8D44\u6E90\u6587\u4EF6\u5730\u5740\u8FD4\u56DE\u5BF9\u5E94\u7684Resource</li><li>BeanDefinitionReader\uFF1A\u4E3B\u8981\u5B9A\u4E49\u8D44\u6E90\u6587\u4EF6\u8BFB\u53D6\u5E76\u8F6C\u6362\u4E3ABeanDefinition\u7684\u5404\u4E2A\u529F\u80FD</li><li>EnvironmentCapable\uFF1A\u5B9A\u4E49\u83B7\u53D6Environment\u65B9\u6CD5</li><li>DocumentLoader\uFF1A\u5B9A\u4E49\u4ECE\u8D44\u6E90\u6587\u4EF6\u52A0\u8F7D\u5230\u8F6C\u6362\u4E3ADocument\u7684\u529F\u80FD</li><li>AbstractBeanDefinitionReader\uFF1A\u5BF9EnvironmentCapable\u3001BeanDefinitionReader\u7C7B\u5B9A\u4E49\u7684\u529F\u80FD\u8FDB\u884C\u5B9E\u73B0</li><li>BeanDefinitionDocumentReader\uFF1A\u5B9A\u4E49\u8BFB\u53D6Document\u5E76\u6CE8\u518CBeanDefinition\u529F\u80FD</li><li>BeanDefinitionParserDelegate\uFF1A\u5B9A\u4E49\u89E3\u6790Element\u7684\u5404\u79CD\u65B9\u6CD5</li></ul><p>\u6574\u4E2AXML\u914D\u7F6E\u6587\u4EF6\u8BFB\u53D6\u7684\u5927\u81F4\u6D41\u7A0B\uFF0C\u5728XmlBeanDefinitionReader\u4E2D\u4E3B\u8981\u5305\u542B\u4EE5\u4E0B\u51E0\u6B65\u5904\u7406</p><p>![img](./spring5 \u6E90\u7801\u6DF1\u5EA6\u89E3\u6790/1168971-20190701120420747-847000393.png)</p><ul><li>\u901A\u8FC7\u7EE7\u627F\u81EAAbstractBeanDefinitionReader\u4E2D\u7684\u65B9\u6CD5\uFF0C\u6765\u4F7F\u7528ResourceLoader\u5C06\u8D44\u6E90\u6587\u4EF6\u8DEF\u5F84\u8F6C\u6362\u4E3A\u5BF9\u5E94\u7684Resource\u6587\u4EF6</li><li>\u901A\u8FC7DocumentLoader\u5BF9Resource\u6587\u4EF6\u8FDB\u884C\u8F6C\u6362\uFF0C\u5C06Resource\u6587\u4EF6\u8F6C\u6362\u4E3ADocument\u6587\u4EF6</li><li>\u901A\u8FC7\u5B9E\u73B0\u63A5\u53E3BeanDefinitionDocumentReader\u7684DefaultBeanDefinitionDocumentReader\u7C7B\u5BF9Document\u8FDB\u884C\u89E3\u6790\uFF0C\u5E76\u4F7F\u7528BeanDefinitionParserDelegate\u5BF9Element\u8FDB\u884C\u89E3\u6790</li></ul><h3 id="\u5BB9\u5668\u7684\u57FA\u7840xmlbeanfactory"><a class="header-anchor" href="#\u5BB9\u5668\u7684\u57FA\u7840xmlbeanfactory" aria-hidden="true">#</a> \u5BB9\u5668\u7684\u57FA\u7840XmlBeanFactory</h3><p>\u901A\u8FC7\u4E0A\u9762\u7684\u5185\u5BB9\u6211\u4EEC\u5BF9spring\u7684\u5BB9\u5668\u5DF2\u7ECF\u6709\u4E86\u5927\u81F4\u7684\u4E86\u89E3\uFF0C\u63A5\u4E0B\u6765\u6211\u4EEC\u8BE6\u7EC6\u63A2\u7D22\u6BCF\u4E2A\u6B65\u9AA4\u7684\u8BE6\u7EC6\u5B9E\u73B0\uFF0C\u63A5\u4E0B\u6765\u8981\u5206\u6790\u7684\u529F\u80FD\u90FD\u662F\u57FA\u4E8E\u5982\u4E0B\u4EE3\u7801\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">final</span> <span class="token class-name">XmlBeanFactory</span> factory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XmlBeanFactory</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ClassPathResource</span><span class="token punctuation">(</span><span class="token string">&quot;spring.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u9996\u5148\u8C03\u7528ClassPathResource\u7684\u6784\u9020\u51FD\u6570\u6765\u6784\u9020Resource\u8D44\u6E90\u6587\u4EF6\u7684\u5B9E\u4F8B\u5BF9\u8C61\uFF0C\u8FD9\u6837\u540E\u7EED\u7684\u8D44\u6E90\u5904\u7406\u5C31\u53EF\u4EE5\u7528Resource\u63D0\u4F9B\u7684\u5404\u79CD\u670D\u52A1\u6765\u64CD\u4F5C\u4E86\u3002\u6709\u4E86Resource\u540E\u5C31\u53EF\u4EE5\u5BF9BeanFactory\u8FDB\u884C\u521D\u59CB\u5316\u64CD\u4F5C\uFF0C\u90A3\u914D\u7F6E\u6587\u4EF6\u662F\u5982\u4F55\u5C01\u88C5\u7684\u5462\uFF1F</p><h4 id="\u914D\u7F6E\u6587\u4EF6\u7684\u5C01\u88C5"><a class="header-anchor" href="#\u914D\u7F6E\u6587\u4EF6\u7684\u5C01\u88C5" aria-hidden="true">#</a> \u914D\u7F6E\u6587\u4EF6\u7684\u5C01\u88C5</h4><p>Spring\u7684\u914D\u7F6E\u6587\u4EF6\u8BFB\u53D6\u662F\u901A\u8FC7ClassPathResource\u8FDB\u884C\u5C01\u88C5\u7684\uFF0CSpring\u5BF9\u5176\u5185\u90E8\u4F7F\u7528\u5230\u7684\u8D44\u6E90\u5B9E\u73B0\u4E86\u81EA\u5DF1\u7684\u62BD\u8C61\u7ED3\u6784\uFF1AResource\u63A5\u53E3\u6765\u5C01\u88C5\u5E95\u5C42\u8D44\u6E90\uFF0C\u5982\u4E0B\u6E90\u7801\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">InputStreamSource</span> <span class="token punctuation">{</span>
    <span class="token class-name">InputStream</span> <span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Resource</span> <span class="token keyword">extends</span> <span class="token class-name">InputStreamSource</span> <span class="token punctuation">{</span>
    <span class="token keyword">boolean</span> <span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span> <span class="token keyword">boolean</span> <span class="token function">isReadable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">default</span> <span class="token keyword">boolean</span> <span class="token function">isOpen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">default</span> <span class="token keyword">boolean</span> <span class="token function">isFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">URL</span> <span class="token function">getURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">;</span>
    <span class="token class-name">URI</span> <span class="token function">getURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">;</span>
    <span class="token class-name">File</span> <span class="token function">getFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span> <span class="token class-name">ReadableByteChannel</span> <span class="token function">readableChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Channels</span><span class="token punctuation">.</span><span class="token function">newChannel</span><span class="token punctuation">(</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">long</span> <span class="token function">contentLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">;</span>
    <span class="token keyword">long</span> <span class="token function">lastModified</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">;</span>
    <span class="token class-name">Resource</span> <span class="token function">createRelative</span><span class="token punctuation">(</span><span class="token class-name">String</span> relativePath<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> <span class="token function">getFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> <span class="token function">getDescription</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>InputStreamSource\u5C01\u88C5\u4EFB\u4F55\u80FD\u8FD4\u56DEInputStream\u7684\u7C7B\uFF0C\u6BD4\u5982File\u3001Classpath\u4E0B\u7684\u8D44\u6E90\u548CByte Array\u7B49\uFF0C \u5B83\u53EA\u6709\u4E00\u4E2A\u65B9\u6CD5\u5B9A\u4E49\uFF1AgetInputStream()\uFF0C\u8BE5\u65B9\u6CD5\u8FD4\u56DE\u4E00\u4E2A\u65B0\u7684InputStream\u5BF9\u8C61</p><p>Resource\u63A5\u53E3\u62BD\u8C61\u4E86\u6240\u6709Spring\u5185\u90E8\u4F7F\u7528\u5230\u7684\u5E95\u5C42\u8D44\u6E90\uFF1AFile\u3001URL\u3001Classpath\u7B49\u3002\u9996\u5148\uFF0C\u5B83\u5B9A\u4E49\u4E863\u4E2A\u5224\u65AD\u5F53\u524D\u8D44\u6E90\u72B6\u6001\u7684\u65B9\u6CD5\uFF1A\u5B58\u5728\u6027(exists)\u3001\u53EF\u8BFB\u6027(isReadable)\u3001\u662F\u5426\u5904\u4E8E\u6253\u5F00\u72B6\u6001(isOpen)\u3002</p><p>\u53E6\u5916\uFF0CResource\u63A5\u53E3\u8FD8\u63D0\u4F9B\u4E86\u4E0D\u540C\u8D44\u6E90\u5230URL\u3001URI\u3001File\u7C7B\u578B\u7684\u8F6C\u6362\uFF0C\u4EE5\u53CA\u83B7\u53D6lastModified\u5C5E\u6027\u3001\u6587\u4EF6\u540D(\u4E0D\u5E26\u8DEF\u5F84\u4FE1\u606F\u7684\u6587\u4EF6\u540D\uFF0CgetFilename())\u7684\u65B9\u6CD5\uFF0C\u4E3A\u4E86\u4FBF\u4E8E\u64CD\u4F5C\uFF0CResource\u8FD8\u63D0\u4F9B\u4E86\u57FA\u4E8E\u5F53\u524D\u8D44\u6E90\u521B\u5EFA\u4E00\u4E2A\u76F8\u5BF9\u8D44\u6E90\u7684\u65B9\u6CD5\uFF1AcreateRelative()\uFF0C\u8FD8\u63D0\u4F9B\u4E86getDescription()\u65B9\u6CD5\u7528\u4E8E\u5728\u9519\u8BEF\u5904\u7406\u4E2D\u7684\u6253\u5370\u4FE1\u606F\u3002</p><p>\u5BF9\u4E0D\u540C\u6765\u6E90\u7684\u8D44\u6E90\u6587\u4EF6\u90FD\u6709\u76F8\u5E94\u7684Resource\u5B9E\u73B0\uFF1A\u6587\u4EF6(FileSystemResource)\u3001Classpath\u8D44\u6E90(ClassPathResource)\u3001URL\u8D44\u6E90(UrlResource)\u3001InputStream\u8D44\u6E90(InputStreamResource)\u3001Byte\u6570\u7EC4(ByteArrayResource)\u7B49\uFF0C\u76F8\u5173\u7C7B\u56FE\u5982\u4E0B\u6240\u793A\uFF1A</p><p>![img](./spring5 \u6E90\u7801\u6DF1\u5EA6\u89E3\u6790/1168971-20190701142825113-392211212.png)</p><p>\u5728\u65E5\u5E38\u5F00\u53D1\u4E2D\u6211\u4EEC\u53EF\u4EE5\u76F4\u63A5\u4F7F\u7528spring\u63D0\u4F9B\u7684\u7C7B\u6765\u52A0\u8F7D\u8D44\u6E90\u6587\u4EF6\uFF0C\u6BD4\u5982\u5728\u5E0C\u671B\u52A0\u8F7D\u8D44\u6E90\u6587\u4EF6\u65F6\u53EF\u4EE5\u4F7F\u7528\u4E0B\u9762\u7684\u4EE3\u7801\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Resource</span> resource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathResource</span><span class="token punctuation">(</span><span class="token string">&quot;spring-config.xml&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">InputStream</span> is <span class="token operator">=</span> resource<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6709\u4E86 Resource \u63A5\u53E3\u4FBF\u53EF\u4EE5\u5BF9\u6240\u6709\u8D44\u6E90\u6587\u4EF6\u8FDB\u884C\u7EDF\u4E00\u5904\u7406 \u81F3\u4E8E\u5B9E\u73B0\uFF0C\u5176\u5B9E\u662F\u975E\u5E38\u7B80\u5355\u7684\uFF0C\u4EE5 getlnputStream \u4E3A\u4F8B\uFF0CClassPathResource \u4E2D\u7684\u5B9E\u73B0\u65B9\u5F0F\u4FBF\u662F\u901A class \u6216\u8005 classLoader \u63D0\u4F9B\u7684\u5E95\u5C42\u65B9\u6CD5\u8FDB\u884C\u8C03\u7528\uFF0C\u800C\u5BF9\u4E8E FileSystemResource \u5176\u5B9E\u66F4\u7B80\u5355\uFF0C\u76F4\u63A5\u4F7F\u7528 FileInputStream \u5BF9\u6587\u4EF6\u8FDB\u884C\u5B9E\u4F8B\u5316</p><p>ClassPathResource.java</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Nullable</span>
<span class="token keyword">protected</span> <span class="token class-name">URL</span> <span class="token function">resolveURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>clazz <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>clazz<span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>classLoader <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>classLoader<span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">ClassLoader</span><span class="token punctuation">.</span><span class="token function">getSystemResource</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>FileSystemResource.java</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">InputStream</span> <span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">Files</span><span class="token punctuation">.</span><span class="token function">newInputStream</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">NoSuchFileException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">FileNotFoundException</span><span class="token punctuation">(</span>ex<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5F53\u901A\u8FC7Resource\u76F8\u5173\u7C7B\u5B8C\u6210\u4E86\u5BF9\u914D\u7F6E\u6587\u4EF6\u8FDB\u884C\u5C01\u88C5\u540E\uFF0C\u914D\u7F6E\u6587\u4EF6\u7684\u8BFB\u53D6\u5DE5\u4F5C\u5C31\u5168\u6743\u4EA4\u7ED9XmlBeanDefinitionReader\u6765\u5904\u7406\u4E86</p><p>\u63A5\u4E0B\u6765\u5C31\u8FDB\u5165\u5230XmlBeanFactory\u7684\u521D\u59CB\u5316\u8FC7\u7A0B\u4E86\uFF0CXmlBeanFactory\u7684\u521D\u59CB\u5316\u6709\u82E5\u5E72\u529E\u6CD5\uFF0CSpring\u63D0\u4F9B\u4E86\u5F88\u591A\u7684\u6784\u9020\u51FD\u6570\uFF0C\u5728\u8FD9\u91CC\u5206\u6790\u7684\u662F\u4F7F\u7528Resource\u5B9E\u4F8B\u4F5C\u4E3A\u6784\u9020\u51FD\u6570\u53C2\u6570\u7684\u529E\u6CD5\uFF0C\u4EE3\u7801\u5982\u4E0B\uFF1A</p><p>XmlBeanFactory.java</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">XmlBeanFactory</span><span class="token punctuation">(</span><span class="token class-name">Resource</span> resource<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">(</span>resource<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// reader\u5B9A\u4E49</span>
<span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">XmlBeanDefinitionReader</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XmlBeanDefinitionReader</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token class-name">XmlBeanFactory</span><span class="token punctuation">(</span><span class="token class-name">Resource</span> resource<span class="token punctuation">,</span> <span class="token class-name">BeanFactory</span> parentBeanFactory<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>parentBeanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>reader<span class="token punctuation">.</span><span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E0A\u9762\u51FD\u6570\u4E2D\u7684\u4EE3\u7801this.reader.loadBeanDefinitions(resource)\u624D\u662F\u8D44\u6E90\u52A0\u8F7D\u7684\u771F\u6B63\u5B9E\u73B0\uFF0C\u4F46\u662F\u5728XmlBeanDefinitionReader\u52A0\u8F7D\u6570\u636E\u524D\u8FD8\u6709\u4E00\u4E2A\u8C03\u7528\u7236\u7C7B\u6784\u9020\u51FD\u6570\u521D\u59CB\u5316\u7684\u8FC7\u7A0B\uFF1Asuper(parentBeanFactory)\uFF0C\u6211\u4EEC\u6309\u7167\u4EE3\u7801\u5C42\u7EA7\u8FDB\u884C\u8DDF\u8E2A\uFF0C\u9996\u5148\u8DDF\u8E2A\u5230\u5982\u4E0B\u7236\u7C7B\u4EE3\u7801\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">DefaultListableBeanFactory</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">BeanFactory</span> parentBeanFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>parentBeanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7136\u540E\u7EE7\u7EED\u8DDF\u8E2A\uFF0C\u8DDF\u8E2A\u4EE3\u7801\u5230\u7236\u7C7BAbstractAutowireCapableBeanFactory\u7684\u6784\u9020\u51FD\u6570\u4E2D\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">AbstractAutowireCapableBeanFactory</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Nullable</span> <span class="token class-name">BeanFactory</span> parentBeanFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setParentBeanFactory</span><span class="token punctuation">(</span>parentBeanFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token class-name">AbstractAutowireCapableBeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">ignoreDependencyInterface</span><span class="token punctuation">(</span><span class="token class-name">BeanNameAware</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">ignoreDependencyInterface</span><span class="token punctuation">(</span><span class="token class-name">BeanFactoryAware</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">ignoreDependencyInterface</span><span class="token punctuation">(</span><span class="token class-name">BeanClassLoaderAware</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD9\u91CC\u6709\u5FC5\u8981\u63D0\u53CA ignoreDependencylnterface\u65B9\u6CD5\uFF0CignoreDependencylnterface \u7684\u4E3B\u8981\u529F\u80FD\u662F\u5FFD\u7565\u7ED9\u5B9A\u63A5\u53E3\u7684\u81EA\u52A8\u88C5\u914D\u529F\u80FD\uFF0C\u90A3\u4E48\uFF0C\u8FD9\u6837\u505A\u7684\u76EE\u7684\u662F\u4EC0\u4E48\u5462\uFF1F\u4F1A\u4EA7\u751F\u4EC0\u4E48\u6837\u7684\u6548\u679C\u5462\uFF1F</p><p>\u4E3E\u4F8B\u6765\u8BF4\uFF0C\u5F53 A \u4E2D\u6709\u5C5E\u6027 B \uFF0C\u90A3\u4E48\u5F53 Spring \u5728\u83B7\u53D6 A\u7684 Bean \u7684\u65F6\u5019\u5982\u679C\u5176\u5C5E\u6027 B \u8FD8\u6CA1\u6709 \u521D\u59CB\u5316\uFF0C\u90A3\u4E48 Spring \u4F1A\u81EA\u52A8\u521D\u59CB\u5316 B\uFF0C\u8FD9\u4E5F\u662F Spring \u63D0\u4F9B\u7684\u4E00\u4E2A\u91CD\u8981\u7279\u6027 \u3002</p><p>\u4F46\u662F\uFF0C\u67D0\u4E9B\u60C5\u51B5\u4E0B\uFF0C B\u4E0D\u4F1A\u88AB\u521D\u59CB\u5316\uFF0C\u5176\u4E2D\u7684\u4E00\u79CD\u60C5\u51B5\u5C31\u662FB \u5B9E\u73B0\u4E86 BeanNameAware \u63A5\u53E3 \u3002</p><p>Spring \u4E2D\u662F\u8FD9\u6837\u4ECB\u7ECD\u7684\uFF1A\u81EA\u52A8\u88C5\u914D\u65F6\u5FFD\u7565\u7ED9\u5B9A\u7684\u4F9D\u8D56\u63A5\u53E3\uFF0C\u5178\u578B\u5E94\u7528\u662F\u901A\u8FC7\u5176\u4ED6\u65B9\u5F0F\u89E3\u6790 Application \u4E0A\u4E0B\u6587\u6CE8\u518C\u4F9D\u8D56\uFF0C\u7C7B\u4F3C\u4E8E BeanFactory \u901A\u8FC7 BeanFactoryAware \u8FDB\u884C\u6CE8\u5165\u6216\u8005 ApplicationContext \u901A\u8FC7 ApplicationContextAware \u8FDB\u884C\u6CE8\u5165</p><p>\u8C03\u7528ignoreDependencyInterface\u65B9\u6CD5\u540E\uFF0C\u88AB\u5FFD\u7565\u7684\u63A5\u53E3\u4F1A\u5B58\u50A8\u5728BeanFactory\u7684\u540D\u4E3AignoredDependencyInterfaces\u7684Set\u96C6\u5408\u4E2D\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">AbstractAutowireCapableBeanFactory</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractBeanFactory</span>
        <span class="token keyword">implements</span> <span class="token class-name">AutowireCapableBeanFactory</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> ignoredDependencyInterfaces <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">ignoreDependencyInterface</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> ifc<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>ignoredDependencyInterfaces<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>ifc<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ignoredDependencyInterfaces\u96C6\u5408\u5728\u540C\u7C7B\u4E2D\u88AB\u4F7F\u7528\u4EC5\u5728\u4E00\u5904\u2014\u2014isExcludedFromDependencyCheck\u65B9\u6CD5\u4E2D\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token keyword">boolean</span> <span class="token function">isExcludedFromDependencyCheck</span><span class="token punctuation">(</span><span class="token class-name">PropertyDescriptor</span> pd<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">AutowireUtils</span><span class="token punctuation">.</span><span class="token function">isExcludedFromDependencyCheck</span><span class="token punctuation">(</span>pd<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ignoredDependencyTypes<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span><span class="token function">getPropertyType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">AutowireUtils</span><span class="token punctuation">.</span><span class="token function">isSetterDefinedInInterface</span><span class="token punctuation">(</span>pd<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ignoredDependencyInterfaces<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u800CignoredDependencyInterface\u7684\u771F\u6B63\u4F5C\u7528\u8FD8\u5F97\u770BAutowireUtils\u7C7B\u7684isSetterDefinedInInterface\u65B9\u6CD5\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">isSetterDefinedInInterface</span><span class="token punctuation">(</span><span class="token class-name">PropertyDescriptor</span> pd<span class="token punctuation">,</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> interfaces<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//\u83B7\u53D6bean\u4E2D\u67D0\u4E2A\u5C5E\u6027\u5BF9\u8C61\u5728bean\u7C7B\u4E2D\u7684setter\u65B9\u6CD5</span>
    <span class="token class-name">Method</span> setter <span class="token operator">=</span> pd<span class="token punctuation">.</span><span class="token function">getWriteMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>setter <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u83B7\u53D6bean\u7684\u7C7B\u578B</span>
        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> targetClass <span class="token operator">=</span> setter<span class="token punctuation">.</span><span class="token function">getDeclaringClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> ifc <span class="token operator">:</span> interfaces<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>ifc<span class="token punctuation">.</span><span class="token function">isAssignableFrom</span><span class="token punctuation">(</span>targetClass<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token comment">// bean\u7C7B\u578B\u662F\u5426\u63A5\u53E3\u7684\u5B9E\u73B0\u7C7B</span>
                <span class="token class-name">ClassUtils</span><span class="token punctuation">.</span><span class="token function">hasMethod</span><span class="token punctuation">(</span>ifc<span class="token punctuation">,</span> setter<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> setter<span class="token punctuation">.</span><span class="token function">getParameterTypes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// \u63A5\u53E3\u662F\u5426\u6709\u5165\u53C2\u548Cbean\u7C7B\u578B\u5B8C\u5168\u76F8\u540C\u7684setter\u65B9\u6CD5</span>
                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ignoredDependencyInterface\u65B9\u6CD5\u5E76\u4E0D\u662F\u8BA9\u6211\u4EEC\u5728\u81EA\u52A8\u88C5\u914D\u65F6\u76F4\u63A5\u5FFD\u7565\u5B9E\u73B0\u4E86\u8BE5\u63A5\u53E3\u7684\u4F9D\u8D56\u3002\u8FD9\u4E2A\u65B9\u6CD5\u7684\u771F\u6B63\u610F\u601D\u662F\u5FFD\u7565\u8BE5\u63A5\u53E3\u7684\u5B9E\u73B0\u7C7B\u4E2D\u548C\u63A5\u53E3setter\u65B9\u6CD5\u5165\u53C2\u7C7B\u578B\u76F8\u540C\u7684\u4F9D\u8D56</p><p>\u4E3E\u4E2A\u4F8B\u5B50\u3002\u9996\u5148\u5B9A\u4E49\u4E00\u4E2A\u8981\u88AB\u5FFD\u7565\u7684\u63A5\u53E3</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">IgnoreInterface</span> <span class="token punctuation">{</span>

    <span class="token keyword">void</span> <span class="token function">setList</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">setSet</span><span class="token punctuation">(</span><span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> set<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7136\u540E\u9700\u8981\u5B9E\u73B0\u8BE5\u63A5\u53E3\uFF0C\u5728\u5B9E\u73B0\u7C7B\u4E2D\u6CE8\u610F\u8981\u6709setter\u65B9\u6CD5\u5165\u53C2\u76F8\u540C\u7C7B\u578B\u7684\u57DF\u5BF9\u8C61\uFF0C\u5728\u4F8B\u5B50\u4E2D\u5C31\u662F<code>List&lt;String&gt;</code>\u548C<code>Set&lt;String&gt;</code></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">IgnoreInterfaceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">IgnoreInterface</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> set<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setList</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>list <span class="token operator">=</span> list<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setSet</span><span class="token punctuation">(</span><span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> set<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>set <span class="token operator">=</span> set<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> list<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> set<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5B9A\u4E49xml\u914D\u7F6E\u6587\u4EF6\uFF1A</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>context</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/context<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context.xsd<span class="token punctuation">&quot;</span></span>
<span class="token attr-name">default-autowire</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>byType<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>


    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>list<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>java.util.ArrayList<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>list</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>foo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>bar<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>list</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>constructor-arg</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>set<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>java.util.HashSet<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>constructor-arg</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>list</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>foo<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>bar<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>list</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>constructor-arg</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ii<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.chenhao.ignoreDependency.IgnoreInterfaceImpl<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.chenhao.autowire.IgnoreAutowiringProcessor<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6700\u540E\u8C03\u7528ignoreDependencyInterface</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>beanFactory<span class="token punctuation">.</span><span class="token function">ignoreDependencyInterface</span><span class="token punctuation">(</span><span class="token class-name">IgnoreInterface</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u8FD0\u884C\u7ED3\u679C\uFF1A null null \u800C\u5982\u679C\u4E0D\u8C03\u7528ignoreDependencyInterface\uFF0C\u5219\u662F\uFF1A [foo, bar] [bar, foo]</p><p>\u6211\u4EEC\u6700\u521D\u7406\u89E3\u662F\u5728\u81EA\u52A8\u88C5\u914D\u65F6\u5FFD\u7565\u8BE5\u63A5\u53E3\u7684\u5B9E\u73B0\uFF0C\u5B9E\u9645\u4E0A\u662F\u5728\u81EA\u52A8\u88C5\u914D\u65F6\u5FFD\u7565\u8BE5\u63A5\u53E3\u5B9E\u73B0\u7C7B\u4E2D\u548Csetter\u65B9\u6CD5\u5165\u53C2\u76F8\u540C\u7684\u7C7B\u578B\uFF0C\u4E5F\u5C31\u662F\u5FFD\u7565\u8BE5\u63A5\u53E3\u5B9E\u73B0\u7C7B\u4E2D\u5B58\u5728\u4F9D\u8D56\u5916\u90E8\u7684bean\u5C5E\u6027\u6CE8\u5165</p><p>\u5178\u578B\u5E94\u7528\u5C31\u662FBeanFactoryAware\u548CApplicationContextAware\u63A5\u53E3\u3002</p><p>\u9996\u5148\u770B\u8BE5\u4E24\u4E2A\u63A5\u53E3\u7684\u6E90\u7801\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">BeanFactoryAware</span> <span class="token keyword">extends</span> <span class="token class-name">Aware</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">setBeanFactory</span><span class="token punctuation">(</span><span class="token class-name">BeanFactory</span> beanFactory<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ApplicationContextAware</span> <span class="token keyword">extends</span> <span class="token class-name">Aware</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">setApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">ApplicationContext</span> applicationContext<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728Spring\u6E90\u7801\u4E2D\u5728\u4E0D\u540C\u7684\u5730\u65B9\u5FFD\u7565\u4E86\u8BE5\u4E24\u4E2A\u63A5\u53E3\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>beanFactory<span class="token punctuation">.</span><span class="token function">ignoreDependencyInterface</span><span class="token punctuation">(</span><span class="token class-name">ApplicationContextAware</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ignoreDependencyInterface</span><span class="token punctuation">(</span><span class="token class-name">BeanFactoryAware</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4F7F\u5F97\u6211\u4EEC\u7684BeanFactoryAware\u63A5\u53E3\u5B9E\u73B0\u7C7B\u5728\u81EA\u52A8\u88C5\u914D\u65F6\u4E0D\u80FD\u88AB\u6CE8\u5165BeanFactory\u5BF9\u8C61\u7684\u4F9D\u8D56\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyBeanFactoryAware</span> <span class="token keyword">implements</span> <span class="token class-name">BeanFactoryAware</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">BeanFactory</span> beanFactory<span class="token punctuation">;</span> <span class="token comment">// \u81EA\u52A8\u88C5\u914D\u65F6\u5FFD\u7565\u6CE8\u5165</span>
  	
  	<span class="token doc-comment comment">/**
  	* \u6309\u7167\u5E73\u65F6\u6765\u8BF4\uFF0C\u5F53\u6211\u4EEC\u4F7F\u7528MyBeanFactoryAware\u7684\u65F6\u5019\u56DE\u81EA\u52A8\u7ED9\u6211\u4EEC\u6CE8\u5165beanFactory\uFF0C\u4F46\u662F\u5F53\u6211\u4EEC\u5FFD\u7565BeanFactoryAware\u7684set\u4E2D\u7684\u7C7B\u578B\u6CE8\u5165\u7684\u65F6\u5019\uFF0C
  	* \u5C31\u9700\u8981\u6211\u4EEC\u81EA\u5DF1\u8FDB\u884C\u6CE8\u5165\u7684\u64CD\u4F5C
  	*/</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setBeanFactory</span><span class="token punctuation">(</span><span class="token class-name">BeanFactory</span> beanFactory<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>beanFactory <span class="token operator">=</span> beanFactory<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">BeanFactory</span> <span class="token function">getBeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> beanFactory<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ApplicationContextAware\u63A5\u53E3\u5B9E\u73B0\u7C7B\u4E2D\u7684ApplicationContext\u5BF9\u8C61\u7684\u4F9D\u8D56\u540C\u7406\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyApplicationContextAware</span> <span class="token keyword">implements</span> <span class="token class-name">ApplicationContextAware</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">ApplicationContext</span> applicationContext<span class="token punctuation">;</span> <span class="token comment">// \u81EA\u52A8\u88C5\u914D\u65F6\u88AB\u5FFD\u7565\u6CE8\u5165</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">ApplicationContext</span> applicationContext<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>applicationContext <span class="token operator">=</span> applicationContext<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">ApplicationContext</span> <span class="token function">getApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> applicationContext<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD9\u6837\u7684\u505A\u6CD5\u4F7F\u5F97ApplicationContextAware\u548CBeanFactoryAware\u4E2D\u7684ApplicationContext\u6216BeanFactory\u4F9D\u8D56\u5728\u81EA\u52A8\u88C5\u914D\u65F6\u88AB\u5FFD\u7565\uFF0C\u800C\u7EDF\u4E00\u7531\u6846\u67B6\u8BBE\u7F6E\u4F9D\u8D56\uFF0C\u5982ApplicationContextAware\u63A5\u53E3\u7684\u8BBE\u7F6E\u4F1A\u5728ApplicationContextAwareProcessor\u7C7B\u4E2D\u5B8C\u6210\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">invokeAwareInterfaces</span><span class="token punctuation">(</span><span class="token class-name">Object</span> bean<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>bean <span class="token keyword">instanceof</span> <span class="token class-name">Aware</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>bean <span class="token keyword">instanceof</span> <span class="token class-name">EnvironmentAware</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">EnvironmentAware</span><span class="token punctuation">)</span> bean<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setEnvironment</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>applicationContext<span class="token punctuation">.</span><span class="token function">getEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>bean <span class="token keyword">instanceof</span> <span class="token class-name">EmbeddedValueResolverAware</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">EmbeddedValueResolverAware</span><span class="token punctuation">)</span> bean<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setEmbeddedValueResolver</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>embeddedValueResolver<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>bean <span class="token keyword">instanceof</span> <span class="token class-name">ResourceLoaderAware</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">ResourceLoaderAware</span><span class="token punctuation">)</span> bean<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setResourceLoader</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>applicationContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>bean <span class="token keyword">instanceof</span> <span class="token class-name">ApplicationEventPublisherAware</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">ApplicationEventPublisherAware</span><span class="token punctuation">)</span> bean<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setApplicationEventPublisher</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>applicationContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>bean <span class="token keyword">instanceof</span> <span class="token class-name">MessageSourceAware</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">MessageSourceAware</span><span class="token punctuation">)</span> bean<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setMessageSource</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>applicationContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>bean <span class="token keyword">instanceof</span> <span class="token class-name">ApplicationContextAware</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">ApplicationContextAware</span><span class="token punctuation">)</span> bean<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setApplicationContext</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>applicationContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u901A\u8FC7\u8FD9\u79CD\u65B9\u5F0F\u4FDD\u8BC1\u4E86ApplicationContextAware\u548CBeanFactoryAware\u4E2D\u7684\u5BB9\u5668\u4FDD\u8BC1\u662F\u751F\u6210\u8BE5bean\u7684\u5BB9\u5668</p><h4 id="bean\u52A0\u8F7D"><a class="header-anchor" href="#bean\u52A0\u8F7D" aria-hidden="true">#</a> bean\u52A0\u8F7D</h4><p>\u5728\u4E4B\u524DXmlBeanFactory\u6784\u9020\u51FD\u6570\u4E2D\u8C03\u7528\u4E86XmlBeanDefinitionReader\u7C7B\u578B\u7684reader\u5C5E\u6027\u63D0\u4F9B\u7684\u65B9\u6CD5this.reader.loadBeanDefinitions(resource)\uFF0C\u800C\u8FD9\u53E5\u4EE3\u7801\u5219\u662F\u6574\u4E2A\u8D44\u6E90\u52A0\u8F7D\u7684\u5207\u5165\u70B9\uFF0C\u8FD9\u4E2A\u65B9\u6CD5\u7684\u65F6\u5E8F\u56FE\u5982\u4E0B\uFF1A</p><p>![image-20220213154515727](./spring5 \u6E90\u7801\u6DF1\u5EA6\u89E3\u6790/image-20220213154515727.png)</p><p>\u6211\u4EEC\u6765\u68B3\u7406\u4E0B\u4E0A\u8FF0\u65F6\u5E8F\u56FE\u7684\u5904\u7406\u8FC7\u7A0B\uFF1A</p><p>\uFF081\uFF09\u5C01\u88C5\u8D44\u6E90\u6587\u4EF6\u3002\u5F53\u8FDB\u5165XmlBeanDefinitionReader\u540E\u9996\u5148\u5BF9\u53C2\u6570Resource\u4F7F\u7528EncodedResource\u7C7B\u8FDB\u884C\u5C01\u88C5 \uFF082\uFF09\u83B7\u53D6\u8F93\u5165\u6D41\u3002\u4ECEResource\u4E2D\u83B7\u53D6\u5BF9\u5E94\u7684InputStream\u5E76\u6784\u9020InputSource \uFF083\uFF09\u901A\u8FC7\u6784\u9020\u7684InputSource\u5B9E\u4F8B\u548CResource\u5B9E\u4F8B\u7EE7\u7EED\u8C03\u7528\u51FD\u6570doLoadBeanDefinitions\uFF0CloadBeanDefinitions\u51FD\u6570\u5177\u4F53\u7684\u5B9E\u73B0\u8FC7\u7A0B\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">loadBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">EncodedResource</span> encodedResource<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeanDefinitionStoreException</span> <span class="token punctuation">{</span>
    <span class="token class-name">Assert</span><span class="token punctuation">.</span><span class="token function">notNull</span><span class="token punctuation">(</span>encodedResource<span class="token punctuation">,</span> <span class="token string">&quot;EncodedResource must not be null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>logger<span class="token punctuation">.</span><span class="token function">isTraceEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">trace</span><span class="token punctuation">(</span><span class="token string">&quot;Loading XML bean definitions from &quot;</span> <span class="token operator">+</span> encodedResource<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">EncodedResource</span><span class="token punctuation">&gt;</span></span> currentResources <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>resourcesCurrentlyBeingLoaded<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>currentResources <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        currentResources <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>resourcesCurrentlyBeingLoaded<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>currentResources<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>currentResources<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>encodedResource<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BeanDefinitionStoreException</span><span class="token punctuation">(</span>
                <span class="token string">&quot;Detected cyclic loading of &quot;</span> <span class="token operator">+</span> encodedResource <span class="token operator">+</span> <span class="token string">&quot; - check your import definitions!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> encodedResource<span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">InputSource</span> inputSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InputSource</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>encodedResource<span class="token punctuation">.</span><span class="token function">getEncoding</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                inputSource<span class="token punctuation">.</span><span class="token function">setEncoding</span><span class="token punctuation">(</span>encodedResource<span class="token punctuation">.</span><span class="token function">getEncoding</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token function">doLoadBeanDefinitions</span><span class="token punctuation">(</span>inputSource<span class="token punctuation">,</span> encodedResource<span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            inputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>EncodedResource\u7684\u4F5C\u7528\u662F\u5BF9\u8D44\u6E90\u6587\u4EF6\u7684\u7F16\u7801\u8FDB\u884C\u5904\u7406\u7684\uFF0C\u5176\u4E2D\u7684\u4E3B\u8981\u903B\u8F91\u4F53\u73B0\u5728getReader()\u65B9\u6CD5\u4E2D\uFF0C\u5F53\u8BBE\u7F6E\u4E86\u7F16\u7801\u5C5E\u6027\u7684\u65F6\u5019Spring\u4F1A\u4F7F\u7528\u76F8\u5E94\u7684\u7F16\u7801\u4F5C\u4E3A\u8F93\u5165\u6D41\u7684\u7F16\u7801\uFF0C\u5728\u6784\u9020\u597D\u4E86encodeResource\u5BF9\u8C61\u540E\uFF0C\u518D\u6B21\u8F6C\u5165\u4E86\u53EF\u590D\u7528\u65B9\u6CD5loadBeanDefinitions(new EncodedResource(resource))\uFF0C\u8FD9\u4E2A\u65B9\u6CD5\u5185\u90E8\u624D\u662F\u771F\u6B63\u7684\u6570\u636E\u51C6\u5907\u9636\u6BB5\uFF0C\u4EE3\u7801\u5982\u4E0B\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token keyword">int</span> <span class="token function">doLoadBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">InputSource</span> inputSource<span class="token punctuation">,</span> <span class="token class-name">Resource</span> resource<span class="token punctuation">)</span>
        <span class="token keyword">throws</span> <span class="token class-name">BeanDefinitionStoreException</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u83B7\u53D6 Document \u5B9E\u4F8B</span>
        <span class="token class-name">Document</span> doc <span class="token operator">=</span> <span class="token function">doLoadDocument</span><span class="token punctuation">(</span>inputSource<span class="token punctuation">,</span> resource<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u6839\u636E Document \u5B9E\u4F8B****\u6CE8\u518C Bean\u4FE1\u606F</span>
        <span class="token keyword">return</span> <span class="token function">registerBeanDefinitions</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> resource<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6838\u5FC3\u90E8\u5206\u5C31\u662F try \u5757\u7684\u4E24\u884C\u4EE3\u7801</p><ol><li>\u8C03\u7528 <code>doLoadDocument()</code> \u65B9\u6CD5\uFF0C\u6839\u636E xml \u6587\u4EF6\u83B7\u53D6 Document \u5B9E\u4F8B\u3002</li><li>\u6839\u636E\u83B7\u53D6\u7684 Document \u5B9E\u4F8B\u6CE8\u518C Bean \u4FE1\u606F</li></ol><p>\u5176\u5B9E\u5728<code>doLoadDocument()</code>\u65B9\u6CD5\u5185\u90E8\u8FD8\u83B7\u53D6\u4E86 xml \u6587\u4EF6\u7684\u9A8C\u8BC1\u6A21\u5F0F\u3002\u5982\u4E0B:</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token class-name">Document</span> <span class="token function">doLoadDocument</span><span class="token punctuation">(</span><span class="token class-name">InputSource</span> inputSource<span class="token punctuation">,</span> <span class="token class-name">Resource</span> resource<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>documentLoader<span class="token punctuation">.</span><span class="token function">loadDocument</span><span class="token punctuation">(</span>inputSource<span class="token punctuation">,</span> <span class="token function">getEntityResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>errorHandler<span class="token punctuation">,</span>
            <span class="token function">getValidationModeForResource</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">isNamespaceAware</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8C03\u7528 <code>getValidationModeForResource()</code> \u83B7\u53D6\u6307\u5B9A\u8D44\u6E90\uFF08xml\uFF09\u7684\u9A8C\u8BC1\u6A21\u5F0F\u3002\u6240\u4EE5 <code>doLoadBeanDefinitions()</code>\u4E3B\u8981\u5C31\u662F\u505A\u4E86\u4E09\u4EF6\u4E8B\u60C5\u3002</p><ol><li>\u8C03\u7528 <code>getValidationModeForResource()</code> \u83B7\u53D6 xml \u6587\u4EF6\u7684\u9A8C\u8BC1\u6A21\u5F0F</li><li>\u8C03\u7528 <code>loadDocument()</code> \u6839\u636E xml \u6587\u4EF6\u83B7\u53D6\u76F8\u5E94\u7684 Document \u5B9E\u4F8B\u3002</li><li>\u8C03\u7528 <code>registerBeanDefinitions()</code> \u6CE8\u518C Bean \u5B9E\u4F8B\u3002</li></ol><h5 id="\u83B7\u53D6xml\u7684\u9A8C\u8BC1\u6A21\u5F0F"><a class="header-anchor" href="#\u83B7\u53D6xml\u7684\u9A8C\u8BC1\u6A21\u5F0F" aria-hidden="true">#</a> \u83B7\u53D6XML\u7684\u9A8C\u8BC1\u6A21\u5F0F</h5><ol><li>DTD\u548CXSD\u7684\u533A\u522B</li></ol><p>DTD(Document Type Definition)\u5373\u6587\u6863\u7C7B\u578B\u5B9A\u4E49\uFF0C\u662F\u4E00\u79CDXML\u7EA6\u675F\u6A21\u5F0F\u8BED\u8A00\uFF0C\u662FXML\u6587\u4EF6\u7684\u9A8C\u8BC1\u673A\u5236\uFF0C\u5C5E\u4E8EXML\u6587\u4EF6\u7EC4\u6210\u7684\u4E00\u90E8\u5206\u3002DTD\u662F\u4E00\u79CD\u4FDD\u8BC1XML\u6587\u6863\u683C\u5F0F\u6B63\u786E\u7684\u6709\u6548\u65B9\u6CD5\uFF0C\u53EF\u4EE5\u901A\u8FC7\u6BD4\u8F83XML\u6587\u6863\u548CDTD\u6587\u4EF6\u6765\u770B\u6587\u6863\u662F\u5426\u7B26\u5408\u89C4\u8303\uFF0C\u5143\u7D20\u548C\u6807\u7B7E\u4F7F\u7528\u662F\u5426\u6B63\u786E\u3002</p><p>\u4E00\u4E2ADTD\u6587\u6863\u5305\u542B\uFF1A\u5143\u7D20\u7684\u5B9A\u4E49\u89C4\u5219\uFF0C\u5143\u7D20\u95F4\u5173\u7CFB\u7684\u5B9A\u4E49\u89C4\u5219\uFF0C\u5143\u7D20\u53EF\u4F7F\u7528\u7684\u5C5E\u6027\uFF0C\u53EF\u4F7F\u7528\u7684\u5B9E\u4F53\u6216\u7B26\u5408\u89C4\u5219\u3002</p><p>\u4F7F\u7528DTD\u9A8C\u8BC1\u6A21\u5F0F\u7684\u65F6\u5019\u9700\u8981\u5728XML\u6587\u4EF6\u7684\u5934\u90E8\u58F0\u660E\uFF0C\u4EE5\u4E0B\u662F\u5728Spring\u4E2D\u4F7F\u7528DTD\u58F0\u660E\u65B9\u5F0F\u7684\u4EE3\u7801\uFF1A</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">beans</span> <span class="token name">PUBLIC</span> <span class="token string">&quot;-//Spring//DTD BEAN 2.0//EN&quot;</span> <span class="token string">&quot;http://www.Springframework.org/dtd/Spring-beans-2.0.dtd&quot;</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>XML Schema\u8BED\u8A00\u5C31\u662FXSD(XML Schemas Definition)\u3002XML Schema\u63CF\u8FF0\u4E86XML\u6587\u6863\u7684\u7ED3\u6784\uFF0C\u53EF\u4EE5\u7528\u4E00\u4E2A\u6307\u5B9A\u7684XML Schema\u6765\u9A8C\u8BC1\u67D0\u4E2AXML\u6587\u6863\uFF0C\u4EE5\u68C0\u67E5\u8BE5XML\u6587\u6863\u662F\u5426\u7B26\u5408\u5176\u8981\u6C42\uFF0C\u6587\u6863\u8BBE\u8BA1\u8005\u53EF\u4EE5\u901A\u8FC7XML Schema\u6307\u5B9A\u4E00\u4E2AXML\u6587\u6863\u6240\u5141\u8BB8\u7684\u7ED3\u6784\u548C\u5185\u5BB9\uFF0C\u5E76\u53EF\u636E\u6B64\u68C0\u67E5\u4E00\u4E2AXML\u6587\u6863\u662F\u5426\u662F\u6709\u6548\u7684\u3002</p><p>\u5728\u4F7F\u7528XML Schema\u6587\u6863\u5BF9XML\u5B9E\u4F8B\u6587\u6863\u8FDB\u884C\u68C0\u9A8C\uFF0C\u9664\u4E86\u8981\u58F0\u660E<strong>\u540D\u79F0\u7A7A\u95F4</strong>\u5916(<strong><code>xmlns=http://www.Springframework.org/schema/beans</code></strong>)\uFF0C\u8FD8\u5FC5\u987B\u6307\u5B9A\u8BE5\u540D\u79F0\u7A7A\u95F4\u6240\u5BF9\u5E94\u7684<strong>XML Schema\u6587\u6863\u7684\u5B58\u50A8\u4F4D\u7F6E</strong>\uFF0C\u901A\u8FC7<strong>schemaLocation</strong>\u5C5E\u6027\u6765\u6307\u5B9A\u540D\u79F0\u7A7A\u95F4\u6240\u5BF9\u5E94\u7684XML Schema\u6587\u6863\u7684\u5B58\u50A8\u4F4D\u7F6E\uFF0C\u5B83\u5305\u542B\u4E24\u4E2A\u90E8\u5206\uFF0C\u4E00\u90E8\u5206\u662F\u540D\u79F0\u7A7A\u95F4\u7684URI\uFF0C\u53E6\u4E00\u90E8\u5206\u5C31\u8BE5\u540D\u79F0\u7A7A\u95F4\u6240\u6807\u8BC6\u7684XML Schema\u6587\u4EF6\u4F4D\u7F6E\u6216URL\u5730\u5740(<code>xsi:schemaLocation=\u201Dhttp://www.Springframework.org/schema/beans</code> <strong><code>http://www.Springframework.org/schema/beans/Spring-beans.xsd</code></strong>\u201C)\uFF0C\u4EE3\u7801\u5982\u4E0B\uFF1A</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
       <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>myTestBean<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.chenhao.spring.MyTestBean<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>\u9A8C\u8BC1\u6A21\u5F0F\u7684\u8BFB\u53D6</li></ol><p>\u5728spring\u4E2D\uFF0C\u662F\u901A\u8FC7getValidationModeForResource\u65B9\u6CD5\u6765\u83B7\u53D6\u5BF9\u5E94\u8D44\u6E90\u7684\u9A8C\u8BC1\u6A21\u5F0F\uFF0C\u5176\u6E90\u7801\u5982\u4E0B\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token keyword">int</span> <span class="token function">getValidationModeForResource</span><span class="token punctuation">(</span><span class="token class-name">Resource</span> resource<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> validationModeToUse <span class="token operator">=</span> <span class="token function">getValidationMode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>validationModeToUse <span class="token operator">!=</span> VALIDATION_AUTO<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> validationModeToUse<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">int</span> detectedMode <span class="token operator">=</span> <span class="token function">detectValidationMode</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>detectedMode <span class="token operator">!=</span> VALIDATION_AUTO<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> detectedMode<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// Hmm, we didn&#39;t get a clear indication... Let&#39;s assume XSD,</span>
    <span class="token comment">// since apparently no DTD declaration has been found up until</span>
    <span class="token comment">// detection stopped (before finding the document&#39;s root tag).</span>
    <span class="token keyword">return</span> VALIDATION_XSD<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u65B9\u6CD5\u7684\u5B9E\u73B0\u8FD8\u662F\u5F88\u7B80\u5355\u7684\uFF0C\u5982\u679C\u8BBE\u5B9A\u4E86\u9A8C\u8BC1\u6A21\u5F0F\u5219\u4F7F\u7528\u8BBE\u5B9A\u7684\u9A8C\u8BC1\u6A21\u5F0F\uFF08\u53EF\u4EE5\u901A\u8FC7\u4F7F\u7528XmlBeanDefinitionReader\u4E2D\u7684setValidationMode\u65B9\u6CD5\u8FDB\u884C\u8BBE\u5B9A\uFF09\uFF0C\u5426\u5219\u4F7F\u7528\u81EA\u52A8\u68C0\u6D4B\u7684\u65B9\u5F0F\u3002\u800C\u81EA\u52A8\u68C0\u6D4B\u9A8C\u8BC1\u6A21\u5F0F\u7684\u529F\u80FD\u662F\u5728\u51FD\u6570detectValidationMode\u65B9\u6CD5\u4E2D\uFF0C\u800C\u5728\u6B64\u65B9\u6CD5\u4E2D\u53C8\u5C06\u81EA\u52A8\u68C0\u6D4B\u9A8C\u8BC1\u6A21\u5F0F\u7684\u5DE5\u4F5C\u59D4\u6258\u7ED9\u4E86\u4E13\u95E8\u5904\u7406\u7C7BXmlValidationModeDetector\u7684validationModeDetector\u65B9\u6CD5\uFF0C\u5177\u4F53\u4EE3\u7801\u5982\u4E0B\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">detectValidationMode</span><span class="token punctuation">(</span><span class="token class-name">InputStream</span> inputStream<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token comment">// Peek into the file to look for DOCTYPE.</span>
    <span class="token class-name">BufferedReader</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BufferedReader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">boolean</span> isDtdValidated <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> content<span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>content <span class="token operator">=</span> reader<span class="token punctuation">.</span><span class="token function">readLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            content <span class="token operator">=</span> <span class="token function">consumeCommentTokens</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>inComment <span class="token operator">||</span> <span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasText</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">hasDoctype</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                isDtdValidated <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">hasOpeningTag</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// End of meaningful data...</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>isDtdValidated <span class="token operator">?</span> VALIDATION_DTD <span class="token operator">:</span> VALIDATION_XSD<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">CharConversionException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Choked on some character encoding...</span>
        <span class="token comment">// Leave the decision up to the caller.</span>
        <span class="token keyword">return</span> VALIDATION_AUTO<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">finally</span> <span class="token punctuation">{</span>
        reader<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4ECE\u4EE3\u7801\u4E2D\u770B\uFF0C\u4E3B\u8981\u662F\u901A\u8FC7\u8BFB\u53D6 XML \u6587\u4EF6\u7684\u5185\u5BB9\uFF0C\u5224\u65AD\u5185\u5BB9\u4E2D\u662F\u5426\u5305\u542B\u6709 DOCTYPE \uFF0C\u5982\u679C\u662F \u5219\u4E3A DTD\uFF0C\u5426\u5219\u4E3A XSD\uFF0C\u5F53\u7136\u53EA\u4F1A\u8BFB\u53D6\u5230 \u7B2C\u4E00\u4E2A \u201C<code>&lt;</code>\u201D \u5904\uFF0C\u56E0\u4E3A \u9A8C\u8BC1\u6A21\u5F0F\u4E00\u5B9A\u4F1A\u5728\u7B2C\u4E00\u4E2A \u201C<code>&lt;</code>\u201D \u4E4B\u524D\u3002\u5982\u679C\u5F53\u4E2D\u51FA\u73B0\u4E86 CharConversionException \u5F02\u5E38\uFF0C\u5219\u4E3A XSD\u6A21\u5F0F</p><h4 id="\u83B7\u53D6document"><a class="header-anchor" href="#\u83B7\u53D6document" aria-hidden="true">#</a> \u83B7\u53D6Document</h4><p>\u7ECF\u8FC7\u4E86\u9A8C\u8BC1\u6A21\u5F0F\u51C6\u5907\u7684\u6B65\u9AA4\u5C31\u53EF\u4EE5\u8FDB\u884CDocument\u52A0\u8F7D\u4E86\uFF0C\u5BF9\u4E8E\u6587\u6863\u7684\u8BFB\u53D6\u59D4\u6258\u7ED9\u4E86DocumentLoader\u53BB\u6267\u884C\uFF0C\u8FD9\u91CC\u7684DocumentLoader\u662F\u4E2A\u63A5\u53E3\uFF0C\u800C\u771F\u6B63\u8C03\u7528\u7684\u662FDefaultDocumentLoader\uFF0C\u89E3\u6790\u4EE3\u7801\u5982\u4E0B:</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">Document</span> <span class="token function">loadDocument</span><span class="token punctuation">(</span><span class="token class-name">InputSource</span> inputSource<span class="token punctuation">,</span> <span class="token class-name">EntityResolver</span> entityResolver<span class="token punctuation">,</span>
        <span class="token class-name">ErrorHandler</span> errorHandler<span class="token punctuation">,</span> <span class="token keyword">int</span> validationMode<span class="token punctuation">,</span> <span class="token keyword">boolean</span> namespaceAware<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token class-name">DocumentBuilderFactory</span> factory <span class="token operator">=</span> <span class="token function">createDocumentBuilderFactory</span><span class="token punctuation">(</span>validationMode<span class="token punctuation">,</span> namespaceAware<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>logger<span class="token punctuation">.</span><span class="token function">isDebugEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;Using JAXP provider [&quot;</span> <span class="token operator">+</span> factory<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">DocumentBuilder</span> builder <span class="token operator">=</span> <span class="token function">createDocumentBuilder</span><span class="token punctuation">(</span>factory<span class="token punctuation">,</span> entityResolver<span class="token punctuation">,</span> errorHandler<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> builder<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>inputSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5206\u6790\u4EE3\u7801\uFF0C\u9996\u9009\u521B\u5EFADocumentBuildFactory\uFF0C\u518D\u901A\u8FC7DocumentBuilderFactory\u521B\u5EFADocumentBuilder\uFF0C\u8FDB\u800C\u89E3\u6790InputSource\u6765\u8FD4\u56DEDocument\u5BF9\u8C61\u3002\u5BF9\u4E8E\u53C2\u6570entityResolver\uFF0C\u4F20\u5165\u7684\u662F\u901A\u8FC7getEntityResolver()\u51FD\u6570\u83B7\u53D6\u7684\u8FD4\u56DE\u503C\uFF0C\u4EE3\u7801\u5982\u4E0B\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token class-name">EntityResolver</span> <span class="token function">getEntityResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>entityResolver <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Determine default EntityResolver to use.</span>
        <span class="token class-name">ResourceLoader</span> resourceLoader <span class="token operator">=</span> <span class="token function">getResourceLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>resourceLoader <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>entityResolver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ResourceEntityResolver</span><span class="token punctuation">(</span>resourceLoader<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>entityResolver <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DelegatingEntityResolver</span><span class="token punctuation">(</span><span class="token function">getBeanClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>entityResolver<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD9\u4E2AentityResolver\u662F\u505A\u4EC0\u4E48\u7528\u7684\u5462\uFF0C\u63A5\u4E0B\u6765\u6211\u4EEC\u8BE6\u7EC6\u5206\u6790\u4E0B</p><p>\u5BF9\u4E8E\u89E3\u6790\u4E00\u4E2AXML\uFF0CSAX\u9996\u5148\u8BFB\u53D6\u8BE5XML\u6587\u6863\u4E0A\u7684\u58F0\u660E\uFF0C\u6839\u636E\u58F0\u660E\u53BB\u5BFB\u627E\u76F8\u5E94\u7684DTD\u5B9A\u4E49\uFF0C\u4EE5\u4FBF\u5BF9\u6587\u6863\u8FDB\u884C\u4E00\u4E2A\u9A8C\u8BC1\uFF0C\u9ED8\u8BA4\u7684\u5BFB\u627E\u89C4\u5219\uFF0C\u5373\u901A\u8FC7\u7F51\u7EDC(\u5B9E\u73B0\u4E0A\u5C31\u662F\u58F0\u660EDTD\u7684URI\u5730\u5740)\u6765\u4E0B\u8F7D\u76F8\u5E94\u7684DTD\u58F0\u660E\uFF0C\u5E76\u8FDB\u884C\u8BA4\u8BC1\u3002\u4E0B\u8F7D\u7684\u8FC7\u7A0B\u662F\u4E00\u4E2A\u6F2B\u957F\u7684\u8FC7\u7A0B\uFF0C\u800C\u4E14\u5F53\u7F51\u7EDC\u4E2D\u65AD\u6216\u4E0D\u53EF\u7528\u65F6\uFF0C\u8FD9\u91CC\u4F1A\u62A5\u9519\uFF0C\u5C31\u662F\u56E0\u4E3A\u76F8\u5E94\u7684DTD\u58F0\u660E\u6CA1\u6709\u88AB\u627E\u5230\u7684\u539F\u56E0</p><p>EntityResolver\u7684\u4F5C\u7528\u662F\u9879\u76EE\u672C\u8EAB\u5C31\u53EF\u4EE5\u63D0\u4F9B\u4E00\u4E2A\u5982\u4F55\u5BFB\u627EDTD\u58F0\u660E\u7684\u65B9\u6CD5\uFF0C\u5373\u7531\u7A0B\u5E8F\u6765\u5B9E\u73B0\u5BFB\u627EDTD\u58F0\u660E\u7684\u8FC7\u7A0B\uFF0C\u6BD4\u5982\u5C06DTD\u6587\u4EF6\u653E\u5230\u9879\u76EE\u4E2D\u67D0\u5904\uFF0C\u5728\u5B9E\u73B0\u65F6\u76F4\u63A5\u5C06\u6B64\u6587\u6863\u8BFB\u53D6\u5E76\u8FD4\u56DE\u7ED9SAX\u5373\u53EF\uFF0C\u5728EntityResolver\u7684\u63A5\u53E3\u53EA\u6709\u4E00\u4E2A\u65B9\u6CD5\u58F0\u660E\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token class-name">InputSource</span> resolveEntity <span class="token punctuation">(</span><span class="token class-name">String</span> publicId<span class="token punctuation">,</span> <span class="token class-name">String</span> systemId<span class="token punctuation">)</span>
    <span class="token keyword">throws</span> <span class="token class-name">SAXException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5B83\u63A5\u6536\u4E24\u4E2A\u53C2\u6570publicId\u548CsystemId\uFF0C\u5E76\u8FD4\u56DE\u4E00\u4E2AInputSource\u5BF9\u8C61\uFF0C\u4EE5\u7279\u5B9A\u914D\u7F6E\u6587\u4EF6\u6765\u8FDB\u884C\u8BB2\u89E3</p><ol><li>\u5982\u679C\u5728\u89E3\u6790\u9A8C\u8BC1\u6A21\u5F0F\u4E3AXSD\u7684\u914D\u7F6E\u6587\u4EF6\uFF0C\u4EE3\u7801\u5982\u4E0B\uFF1A</li></ol><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.Springframework.org/schema/beans<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.Springframework.org/schema/beans http://www.Springframework.org/schema/beans/Spring-beans.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
....
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5219\u4F1A\u8BFB\u53D6\u5230\u4EE5\u4E0B\u4E24\u4E2A\u53C2\u6570</p>`,216),k=n("li",null,"publicId\uFF1Anull",-1),d=a("systemId\uFF1A"),v={href:"http://www.springframework.org/schema/beans/Spring-beans.xsd",target:"_blank",rel:"noopener noreferrer"},m=a("http://www.Springframework.org/schema/beans/Spring-beans.xsd"),g=s(`<ol start="2"><li>\u5982\u679C\u89E3\u6790\u9A8C\u8BC1\u6A21\u5F0F\u4E3ADTD\u7684\u914D\u7F6E\u6587\u4EF6\uFF0C\u4EE3\u7801\u5982\u4E0B\uFF1A</li></ol><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">beans</span> <span class="token name">PUBLIC</span> <span class="token string">&quot;-//Spring//DTD BEAN 2.0//EN&quot;</span> <span class="token string">&quot;http://www.Springframework.org/dtd/Spring-beans-2.0.dtd&quot;</span><span class="token punctuation">&gt;</span></span>
....
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8BFB\u53D6\u5230\u4EE5\u4E0B\u4E24\u4E2A\u53C2\u6570</p><ul><li>publicId\uFF1A-//Spring//DTD BEAN 2.0//EN</li><li>systemId\uFF1A<code>http://www.Springframework.org/dtd/Spring-beans-2.0.dtd</code></li></ul><p>\u4E00\u822C\u90FD\u4F1A\u628A\u9A8C\u8BC1\u6587\u4EF6\u653E\u7F6E\u5728\u81EA\u5DF1\u7684\u5DE5\u7A0B\u91CC\uFF0C\u5982\u679C\u628AURL\u8F6C\u6362\u4E3A\u81EA\u5DF1\u5DE5\u7A0B\u91CC\u5BF9\u5E94\u7684\u5730\u5740\u6587\u4EF6\u5462\uFF1F\u4EE5\u52A0\u8F7DDTD\u6587\u4EF6\u4E3A\u4F8B\u6765\u770B\u770BSpring\u662F\u5982\u4F55\u5B9E\u73B0\u7684\u3002</p><p>\u6839\u636E\u4E4B\u524DSpring\u4E2D\u901A\u8FC7getEntityResolver()\u65B9\u6CD5\u5BF9EntityResolver\u7684\u83B7\u53D6\uFF0C\u6211\u4EEC\u77E5\u9053\uFF0CSpring\u4E2D\u4F7F\u7528DelegatingEntityResolver\u7C7B\u4E3AEntityResolver\u7684\u5B9E\u73B0\u7C7B\uFF0CresolveEntity\u5B9E\u73B0\u65B9\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token annotation punctuation">@Nullable</span>
<span class="token keyword">public</span> <span class="token class-name">InputSource</span> <span class="token function">resolveEntity</span><span class="token punctuation">(</span><span class="token class-name">String</span> publicId<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span> systemId<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SAXException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>systemId <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>systemId<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span>DTD_SUFFIX<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>dtdResolver<span class="token punctuation">.</span><span class="token function">resolveEntity</span><span class="token punctuation">(</span>publicId<span class="token punctuation">,</span> systemId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>systemId<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span>XSD_SUFFIX<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>schemaResolver<span class="token punctuation">.</span><span class="token function">resolveEntity</span><span class="token punctuation">(</span>publicId<span class="token punctuation">,</span> systemId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E0D\u540C\u7684\u9A8C\u8BC1\u6A21\u5F0F\u4F7F\u7528\u4E0D\u540C\u7684\u89E3\u6790\u5668\u89E3\u6790\uFF0C\u6BD4\u5982\u52A0\u8F7DDTD\u7C7B\u578B\u7684BeansDtdResolver\u7684resolveEntity\u662F\u76F4\u63A5\u622A\u53D6systemId\u6700\u540E\u7684xx.dtd\u7136\u540E\u53BB\u5F53\u524D\u8DEF\u5F84\u4E0B\u5BFB\u627E\uFF0C\u800C\u52A0\u8F7DXSD\u7C7B\u578B\u7684PluggableSchemaResolver\u7C7B\u7684resolveEntity\u662F\u9ED8\u8BA4\u5230META-INF/Spring.schemas\u6587\u4EF6\u4E2D\u627E\u5230systemId\u6240\u5BF9\u5E94\u7684XSD\u6587\u4EF6\u5E76\u52A0\u8F7D\u3002</p><p>BeansDtdResolver \u7684\u89E3\u6790\u8FC7\u7A0B\u5982\u4E0B:</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">InputSource</span> <span class="token function">resolveEntity</span><span class="token punctuation">(</span><span class="token class-name">String</span> publicId<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span> systemId<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>logger<span class="token punctuation">.</span><span class="token function">isTraceEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">trace</span><span class="token punctuation">(</span><span class="token string">&quot;Trying to resolve XML entity with public ID [&quot;</span> <span class="token operator">+</span> publicId <span class="token operator">+</span>
                <span class="token string">&quot;] and system ID [&quot;</span> <span class="token operator">+</span> systemId <span class="token operator">+</span> <span class="token string">&quot;]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>systemId <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> systemId<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span>DTD_EXTENSION<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> lastPathSeparator <span class="token operator">=</span> systemId<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token char">&#39;/&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> dtdNameStart <span class="token operator">=</span> systemId<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>DTD_NAME<span class="token punctuation">,</span> lastPathSeparator<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>dtdNameStart <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> dtdFile <span class="token operator">=</span> DTD_NAME <span class="token operator">+</span> DTD_EXTENSION<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>logger<span class="token punctuation">.</span><span class="token function">isTraceEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                logger<span class="token punctuation">.</span><span class="token function">trace</span><span class="token punctuation">(</span><span class="token string">&quot;Trying to locate [&quot;</span> <span class="token operator">+</span> dtdFile <span class="token operator">+</span> <span class="token string">&quot;] in Spring jar on classpath&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token class-name">Resource</span> resource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathResource</span><span class="token punctuation">(</span>dtdFile<span class="token punctuation">,</span> <span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">InputSource</span> source <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InputSource</span><span class="token punctuation">(</span>resource<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                source<span class="token punctuation">.</span><span class="token function">setPublicId</span><span class="token punctuation">(</span>publicId<span class="token punctuation">)</span><span class="token punctuation">;</span>
                source<span class="token punctuation">.</span><span class="token function">setSystemId</span><span class="token punctuation">(</span>systemId<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>logger<span class="token punctuation">.</span><span class="token function">isDebugEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;Found beans DTD [&quot;</span> <span class="token operator">+</span> systemId <span class="token operator">+</span> <span class="token string">&quot;] in classpath: &quot;</span> <span class="token operator">+</span> dtdFile<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">return</span> source<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>logger<span class="token punctuation">.</span><span class="token function">isDebugEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;Could not resolve beans DTD [&quot;</span> <span class="token operator">+</span> systemId <span class="token operator">+</span> <span class="token string">&quot;]: not found in classpath&quot;</span><span class="token punctuation">,</span> ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4ECE\u4E0A\u9762\u7684\u4EE3\u7801\u4E2D\u6211\u4EEC\u53EF\u4EE5\u770B\u5230\u52A0\u8F7D DTD \u7C7B\u578B\u7684 <code>BeansDtdResolver.resolveEntity()</code> \u53EA\u662F\u5BF9 systemId \u8FDB\u884C\u4E86\u7B80\u5355\u7684\u6821\u9A8C\uFF08\u4ECE\u6700\u540E\u4E00\u4E2A / \u5F00\u59CB\uFF0C\u5185\u5BB9\u4E2D\u662F\u5426\u5305\u542B <code>spring-beans</code>\uFF09\uFF0C\u7136\u540E\u6784\u9020\u4E00\u4E2A InputSource \u5E76\u8BBE\u7F6E publicId\u3001systemId\uFF0C\u7136\u540E\u8FD4\u56DE\u3002 PluggableSchemaResolver \u7684\u89E3\u6790\u8FC7\u7A0B\u5982\u4E0B:</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">InputSource</span> <span class="token function">resolveEntity</span><span class="token punctuation">(</span><span class="token class-name">String</span> publicId<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">String</span> systemId<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>logger<span class="token punctuation">.</span><span class="token function">isTraceEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">trace</span><span class="token punctuation">(</span><span class="token string">&quot;Trying to resolve XML entity with public id [&quot;</span> <span class="token operator">+</span> publicId <span class="token operator">+</span>
                <span class="token string">&quot;] and system id [&quot;</span> <span class="token operator">+</span> systemId <span class="token operator">+</span> <span class="token string">&quot;]&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>systemId <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> resourceLocation <span class="token operator">=</span> <span class="token function">getSchemaMappings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>systemId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>resourceLocation <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Resource</span> resource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathResource</span><span class="token punctuation">(</span>resourceLocation<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>classLoader<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token class-name">InputSource</span> source <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InputSource</span><span class="token punctuation">(</span>resource<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                source<span class="token punctuation">.</span><span class="token function">setPublicId</span><span class="token punctuation">(</span>publicId<span class="token punctuation">)</span><span class="token punctuation">;</span>
                source<span class="token punctuation">.</span><span class="token function">setSystemId</span><span class="token punctuation">(</span>systemId<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>logger<span class="token punctuation">.</span><span class="token function">isDebugEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;Found XML schema [&quot;</span> <span class="token operator">+</span> systemId <span class="token operator">+</span> <span class="token string">&quot;] in classpath: &quot;</span> <span class="token operator">+</span> resourceLocation<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">return</span> source<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">FileNotFoundException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>logger<span class="token punctuation">.</span><span class="token function">isDebugEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;Couldn&#39;t find XML schema [&quot;</span> <span class="token operator">+</span> systemId <span class="token operator">+</span> <span class="token string">&quot;]: &quot;</span> <span class="token operator">+</span> resource<span class="token punctuation">,</span> ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u9996\u5148\u8C03\u7528 getSchemaMappings() \u83B7\u53D6\u4E00\u4E2A\u6620\u5C04\u8868(systemId \u4E0E\u5176\u5728\u672C\u5730\u7684\u5BF9\u7167\u5173\u7CFB)\uFF0C\u7136\u540E\u6839\u636E\u4F20\u5165\u7684 systemId \u83B7\u53D6\u8BE5 systemId \u5728\u672C\u5730\u7684\u8DEF\u5F84 resourceLocation\uFF0C\u6700\u540E\u6839\u636E resourceLocation \u6784\u9020 InputSource \u5BF9\u8C61\u3002 \u6620\u5C04\u8868\u5982\u4E0B\uFF08\u90E8\u5206\uFF09:</p><p>![img](./spring5 \u6E90\u7801\u6DF1\u5EA6\u89E3\u6790/1168971-20190701154606281-454064408.png)</p><h4 id="\u89E3\u6790\u53CA\u6CE8\u518Cbeandefinitions"><a class="header-anchor" href="#\u89E3\u6790\u53CA\u6CE8\u518Cbeandefinitions" aria-hidden="true">#</a> \u89E3\u6790\u53CA\u6CE8\u518CBeanDefinitions</h4><p>\u5F53\u628A\u6587\u4EF6\u8F6C\u6362\u6210Document\u540E\uFF0C\u63A5\u4E0B\u6765\u5C31\u662F\u5BF9bean\u7684\u63D0\u53D6\u53CA\u6CE8\u518C\uFF0C\u5F53\u7A0B\u5E8F\u5DF2\u7ECF\u62E5\u6709\u4E86XML\u6587\u6863\u6587\u4EF6\u7684Document\u5B9E\u4F8B\u5BF9\u8C61\u65F6\uFF0C\u5C31\u4F1A\u88AB\u5F15\u5165\u5230XmlBeanDefinitionReader.registerBeanDefinitions\u8FD9\u4E2A\u65B9\u6CD5:</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">registerBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">Document</span> doc<span class="token punctuation">,</span> <span class="token class-name">Resource</span> resource<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeanDefinitionStoreException</span> <span class="token punctuation">{</span>
    <span class="token class-name">BeanDefinitionDocumentReader</span> documentReader <span class="token operator">=</span> <span class="token function">createBeanDefinitionDocumentReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> countBefore <span class="token operator">=</span> <span class="token function">getRegistry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBeanDefinitionCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    documentReader<span class="token punctuation">.</span><span class="token function">registerBeanDefinitions</span><span class="token punctuation">(</span>doc<span class="token punctuation">,</span> <span class="token function">createReaderContext</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">getRegistry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBeanDefinitionCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> countBefore<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5176\u4E2D\u7684doc\u53C2\u6570\u5373\u4E3A\u4E0A\u8282\u8BFB\u53D6\u7684document\uFF0C\u800CBeanDefinitionDocumentReader\u662F\u4E00\u4E2A\u63A5\u53E3\uFF0C\u800C\u5B9E\u4F8B\u5316\u7684\u5DE5\u4F5C\u662F\u5728createBeanDefinitionDocumentReader()\u4E2D\u5B8C\u6210\u7684\uFF0C\u800C\u901A\u8FC7\u6B64\u65B9\u6CD5\uFF0CBeanDefinitionDocumentReader\u771F\u6B63\u7684\u7C7B\u578B\u5176\u5B9E\u5DF2\u7ECF\u662FDefaultBeanDefinitionDocumentReader\u4E86\uFF0C\u8FDB\u5165DefaultBeanDefinitionDocumentReader\u540E\uFF0C\u53D1\u73B0\u8FD9\u4E2A\u65B9\u6CD5\u7684\u91CD\u8981\u76EE\u7684\u4E4B\u4E00\u5C31\u662F\u63D0\u53D6root\uFF0C\u4EE5\u4FBF\u4E8E\u518D\u6B21\u5C06root\u4F5C\u4E3A\u53C2\u6570\u7EE7\u7EEDBeanDefinition\u7684\u6CE8\u518C\uFF0C\u5982\u4E0B\u4EE3\u7801\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">registerBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">Document</span> doc<span class="token punctuation">,</span> <span class="token class-name">XmlReaderContext</span> readerContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>readerContext <span class="token operator">=</span> readerContext<span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;Loading bean definitions&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Element</span> root <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">getDocumentElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">doRegisterBeanDefinitions</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u901A\u8FC7\u8FD9\u91CC\u6211\u4EEC\u770B\u5230\u7EC8\u4E8E\u5230\u4E86\u89E3\u6790\u903B\u8F91\u7684\u6838\u5FC3\u65B9\u6CD5doRegisterBeanDefinitions\uFF0C\u63A5\u7740\u8DDF\u8E2A\u6E90\u7801\u5982\u4E0B\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doRegisterBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">Element</span> root<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">BeanDefinitionParserDelegate</span> parent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>delegate<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>delegate <span class="token operator">=</span> <span class="token function">createDelegate</span><span class="token punctuation">(</span><span class="token function">getReaderContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> root<span class="token punctuation">,</span> parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>delegate<span class="token punctuation">.</span><span class="token function">isDefaultNamespace</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> profileSpec <span class="token operator">=</span> root<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span>PROFILE_ATTRIBUTE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasText</span><span class="token punctuation">(</span>profileSpec<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> specifiedProfiles <span class="token operator">=</span> <span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">tokenizeToStringArray</span><span class="token punctuation">(</span>
                    profileSpec<span class="token punctuation">,</span> <span class="token class-name">BeanDefinitionParserDelegate</span><span class="token punctuation">.</span>MULTI_VALUE_ATTRIBUTE_DELIMITERS<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">getReaderContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">acceptsProfiles</span><span class="token punctuation">(</span>specifiedProfiles<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>logger<span class="token punctuation">.</span><span class="token function">isInfoEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;Skipped XML bean definition file due to specified profiles [&quot;</span> <span class="token operator">+</span> profileSpec <span class="token operator">+</span>
                            <span class="token string">&quot;] not matching: &quot;</span> <span class="token operator">+</span> <span class="token function">getReaderContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">preProcessXml</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">parseBeanDefinitions</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>delegate<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">postProcessXml</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>delegate <span class="token operator">=</span> parent<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6211\u4EEC\u770B\u5230\u9996\u5148\u8981\u89E3\u6790profile\u5C5E\u6027\uFF0C\u7136\u540E\u624D\u5F00\u59CBXML\u7684\u8BFB\u53D6\uFF0C\u5177\u4F53\u7684\u4EE3\u7801\u5982\u4E0B\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">parseBeanDefinitions</span><span class="token punctuation">(</span><span class="token class-name">Element</span> root<span class="token punctuation">,</span> <span class="token class-name">BeanDefinitionParserDelegate</span> delegate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>delegate<span class="token punctuation">.</span><span class="token function">isDefaultNamespace</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">NodeList</span> nl <span class="token operator">=</span> root<span class="token punctuation">.</span><span class="token function">getChildNodes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nl<span class="token punctuation">.</span><span class="token function">getLength</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Node</span> node <span class="token operator">=</span> nl<span class="token punctuation">.</span><span class="token function">item</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token keyword">instanceof</span> <span class="token class-name">Element</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">Element</span> ele <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Element</span><span class="token punctuation">)</span> node<span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>delegate<span class="token punctuation">.</span><span class="token function">isDefaultNamespace</span><span class="token punctuation">(</span>ele<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">parseDefaultElement</span><span class="token punctuation">(</span>ele<span class="token punctuation">,</span> delegate<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    delegate<span class="token punctuation">.</span><span class="token function">parseCustomElement</span><span class="token punctuation">(</span>ele<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
        delegate<span class="token punctuation">.</span><span class="token function">parseCustomElement</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6700\u7EC8\u89E3\u6790\u52A8\u4F5C\u843D\u5730\u5728\u4E24\u4E2A\u65B9\u6CD5\u5904\uFF1A<code>parseDefaultElement(ele, delegate)</code> \u548C <code>delegate.parseCustomElement(root)</code>\u3002\u6211\u4EEC\u77E5\u9053\u5728 Spring \u6709\u4E24\u79CD Bean \u58F0\u660E\u65B9\u5F0F\uFF1A</p><ul><li>\u914D\u7F6E\u6587\u4EF6\u5F0F\u58F0\u660E\uFF1A<code>&lt;bean id=&quot;myTestBean&quot; class=&quot;com.chenhao.spring.MyTestBean&quot;/&gt;</code></li><li>\u81EA\u5B9A\u4E49\u6CE8\u89E3\u65B9\u5F0F\uFF1A<code>&lt;tx:annotation-driven&gt;</code></li></ul><p>\u4E24\u79CD\u65B9\u5F0F\u7684\u8BFB\u53D6\u548C\u89E3\u6790\u90FD\u5B58\u5728\u8F83\u5927\u7684\u5DEE\u5F02\uFF0C\u6240\u4EE5\u91C7\u7528\u4E0D\u540C\u7684\u89E3\u6790\u65B9\u6CD5\uFF0C\u5982\u679C\u6839\u8282\u70B9\u6216\u8005\u5B50\u8282\u70B9\u91C7\u7528\u9ED8\u8BA4\u547D\u540D\u7A7A\u95F4\u7684\u8BDD\uFF0C\u5219\u8C03\u7528 <code>parseDefaultElement()</code> \u8FDB\u884C\u89E3\u6790\uFF0C\u5426\u5219\u8C03\u7528 <code>delegate.parseCustomElement()</code> \u65B9\u6CD5\u8FDB\u884C\u81EA\u5B9A\u4E49\u89E3\u6790\u3002</p><p>\u800C\u5224\u65AD\u662F\u5426\u9ED8\u8BA4\u547D\u540D\u7A7A\u95F4\u8FD8\u662F\u81EA\u5B9A\u4E49\u547D\u540D\u7A7A\u95F4\u7684\u529E\u6CD5\u5176\u5B9E\u662F\u4F7F\u7528node.getNamespaceURI()\u83B7\u53D6\u547D\u540D\u7A7A\u95F4\uFF0C\u5E76\u4E0ESpring\u4E2D\u56FA\u5B9A\u7684\u547D\u540D\u7A7A\u95F4<code>http://www.springframework.org/schema/beans</code>\u8FDB\u884C\u5BF9\u6BD4\uFF0C\u5982\u679C\u4E00\u81F4\u5219\u8BA4\u4E3A\u662F\u9ED8\u8BA4\uFF0C\u5426\u5219\u5C31\u8BA4\u4E3A\u662F\u81EA\u5B9A\u4E49\u3002</p><h5 id="profile\u7684\u7528\u6CD5"><a class="header-anchor" href="#profile\u7684\u7528\u6CD5" aria-hidden="true">#</a> profile\u7684\u7528\u6CD5</h5><p>\u901A\u8FC7profile\u6807\u8BB0\u4E0D\u540C\u7684\u73AF\u5883\uFF0C\u53EF\u4EE5\u901A\u8FC7\u8BBE\u7F6Espring.profiles.active\u548Cspring.profiles.default\u6FC0\u6D3B\u6307\u5B9Aprofile\u73AF\u5883\u3002\u5982\u679C\u8BBE\u7F6E\u4E86active\uFF0Cdefault\u4FBF\u5931\u53BB\u4E86\u4F5C\u7528\u3002\u5982\u679C\u4E24\u4E2A\u90FD\u6CA1\u6709\u8BBE\u7F6E\uFF0C\u90A3\u4E48\u5E26\u6709profiles\u7684bean\u90FD\u4E0D\u4F1A\u751F\u6210\u3002</p><p>\u914D\u7F6Espring\u914D\u7F6E\u6587\u4EF6\u6700\u4E0B\u9762\u914D\u7F6E\u5982\u4E0Bbeans</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- \u5F00\u53D1\u73AF\u5883\u914D\u7F6E\u6587\u4EF6 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">profile</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>development<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>property-placeholder</span>
            <span class="token attr-name">location</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>classpath*:config_common/*.properties, classpath*:config_development/*.properties<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- \u6D4B\u8BD5\u73AF\u5883\u914D\u7F6E\u6587\u4EF6 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">profile</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>test<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>property-placeholder</span>
            <span class="token attr-name">location</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>classpath*:config_common/*.properties, classpath*:config_test/*.properties<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- \u751F\u4EA7\u73AF\u5883\u914D\u7F6E\u6587\u4EF6 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">profile</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>production<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">context:</span>property-placeholder</span>
            <span class="token attr-name">location</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>classpath*:config_common/*.properties, classpath*:config_production/*.properties<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u914D\u7F6Eweb.xml</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- \u591A\u73AF\u5883\u914D\u7F6E \u5728\u4E0A\u4E0B\u6587context-param\u4E2D\u8BBE\u7F6Eprofile.default\u7684\u9ED8\u8BA4\u503C --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>context-param</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">&gt;</span></span>spring.profiles.default<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">&gt;</span></span>production<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>context-param</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- \u591A\u73AF\u5883\u914D\u7F6E \u5728\u4E0A\u4E0B\u6587context-param\u4E2D\u8BBE\u7F6Eprofile.active\u7684\u9ED8\u8BA4\u503C --&gt;</span>
<span class="token comment">&lt;!-- \u8BBE\u7F6Eactive\u540Edefault\u5931\u6548\uFF0Cweb\u542F\u52A8\u65F6\u4F1A\u52A0\u8F7D\u5BF9\u5E94\u7684\u73AF\u5883\u4FE1\u606F --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>context-param</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">&gt;</span></span>spring.profiles.active<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>context-param</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD9\u6837\u542F\u52A8\u7684\u65F6\u5019\u5C31\u53EF\u4EE5\u6309\u7167\u5207\u6362spring.profiles.active\u7684\u5C5E\u6027\u503C\u6765\u8FDB\u884C\u5207\u6362\u4E86</p>`,34);function b(y,w){const t=p("ExternalLinkIcon");return o(),c(i,null,[r,n("ul",null,[k,n("li",null,[d,n("a",v,[m,l(t)])])]),g],64)}var h=e(u,[["render",b],["__file","spring5 \u6E90\u7801\u6DF1\u5EA6\u89E3\u6790.html.vue"]]);export{h as default};
