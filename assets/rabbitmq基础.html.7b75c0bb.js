import{_ as p,r as o,o as i,a as c,b as n,d as t,F as l,c as a,e as s}from"./app.412b4c4c.js";var u="/naive-dafou-ui-dist/assets/image-20211209021623989.489a9fe7.png",r="/naive-dafou-ui-dist/assets/1496926-20201206162020922-723030915.b2b59871.png",d="/naive-dafou-ui-dist/assets/1496926-20201206162022288-710990876.a6a9e8a1.png",k="/naive-dafou-ui-dist/assets/1496926-20190708125542629-2135674001.fc1db137.png",m="/naive-dafou-ui-dist/assets/1496926-20190708125528529-1014015990.fefb4f54.png",b="/naive-dafou-ui-dist/assets/5015984-367dd717d89ae5db.8868931d.png",v="/naive-dafou-ui-dist/assets/5015984-7fd73af768f28704.f2e1a711.png",g="/naive-dafou-ui-dist/assets/5015984-13db639d2c22f2aa.79105456.png",h="/naive-dafou-ui-dist/assets/5015984-2f509b7f34c47170.4f8fe8fe.png",q="/naive-dafou-ui-dist/assets/5015984-275ea009bdf806a0.2aedb163.png",f="/naive-dafou-ui-dist/assets/1496926-20201206162008852-1886576080.185b8dd7.png",y="/naive-dafou-ui-dist/assets/1496926-20201206162009680-1992407247.80c7a89e.png",w="/naive-dafou-ui-dist/assets/1496926-20201206162010556-1179446240.a776c918.png",_="/naive-dafou-ui-dist/assets/1496926-20201206162011544-793083561.d940dd6d.png",x="/naive-dafou-ui-dist/assets/1496926-20201206162012923-103289151.c2e82614.png",C="/naive-dafou-ui-dist/assets/1496926-20201206162016640-682825445.f278ef3b.png",M="/naive-dafou-ui-dist/assets/image-20211209022116979.f9e74229.png",S="/naive-dafou-ui-dist/assets/image-20211209142312115.5356cabb.png",Q="/naive-dafou-ui-dist/assets/image-20211209150119715.8cf2db0e.png",R="/naive-dafou-ui-dist/assets/image-20211209172317812.59699113.png",E="/naive-dafou-ui-dist/assets/image-20211209174027079.ed72a51f.png",P="/naive-dafou-ui-dist/assets/image-20211209184733523.9ce13b65.png",A="/naive-dafou-ui-dist/assets/1496926-20201206161952296-434923127.b65fd3ae.png",T="/naive-dafou-ui-dist/assets/1496926-20201206161955945-1616483470.f4867145.png",I="/naive-dafou-ui-dist/assets/image-20211209143545465.a8de8720.png",j="/naive-dafou-ui-dist/assets/image-20211209192804695.7329201f.png",D="/naive-dafou-ui-dist/assets/image-20211209202255979.e4fbe334.png",O="/naive-dafou-ui-dist/assets/image-20211209202415125.6e2997be.png",N="/naive-dafou-ui-dist/assets/image-20211209202533279.605266a2.png",F="/naive-dafou-ui-dist/assets/image-20211209203436351.e5b3ba2e.png",L="/naive-dafou-ui-dist/assets/image-20211209203606571.4ba6ae8d.png",B="/naive-dafou-ui-dist/assets/image-20211209204912151.0d026a58.png",H="/naive-dafou-ui-dist/assets/image-20211209210931455.68ba763e.png",U="/naive-dafou-ui-dist/assets/python-one.3fb4a1f6.png",K="/naive-dafou-ui-dist/assets/image-20211209212152137.19e83a8e.png",V="/naive-dafou-ui-dist/assets/image-20211209212421513.11b68e4d.png",z="/naive-dafou-ui-dist/assets/image-20211209212826170.cd51ab4f.png",W="/naive-dafou-ui-dist/assets/image-20211209212948402.8c47ee20.png",J="/naive-dafou-ui-dist/assets/image-20211209215445344.7b054ac2.png",G="/naive-dafou-ui-dist/assets/image-20211209215624198.292a7bfb.png",Y="/naive-dafou-ui-dist/assets/image-20211209222548013.33496461.png",X="/naive-dafou-ui-dist/assets/python-two.5e128f74.png",Z="/naive-dafou-ui-dist/assets/image-20211209235035269.630670a5.png",$="/naive-dafou-ui-dist/assets/image-20211209235022376.0f9b96d3.png",nn="/naive-dafou-ui-dist/assets/image-20211210001128181.93e359b7.png",sn="/naive-dafou-ui-dist/assets/exchanges.3025197e.png",an="/naive-dafou-ui-dist/assets/image-20211210021510413.5dc9a8b0.png",en="/naive-dafou-ui-dist/assets/python-four.a4218412.png",tn="/naive-dafou-ui-dist/assets/image-20211210031346694.fd6e483b.png",pn="/naive-dafou-ui-dist/assets/image-20211210031356002.d273b3b6.png",on="/naive-dafou-ui-dist/assets/python-five.2ff2c24d.png",cn="/naive-dafou-ui-dist/assets/image-20211210040511106.d54ab688.png",ln="/naive-dafou-ui-dist/assets/image-20211210040615409.af6ad9d7.png",un="/naive-dafou-ui-dist/assets/image-20211210151410743.efc38bdb.png",rn="/naive-dafou-ui-dist/assets/image-20211210153342265.1f30bffb.png",dn="/naive-dafou-ui-dist/assets/image-20211210160539736.c5d09c11.png",kn="/naive-dafou-ui-dist/assets/image-20211210162635116.107d0d54.png",mn="/naive-dafou-ui-dist/assets/image-20211210163434714.b37a7fad.png",bn="/naive-dafou-ui-dist/assets/image-20211210164308343.0fb1cec8.png",vn="/naive-dafou-ui-dist/assets/image-20211210164443013.35a083b5.png",gn="/naive-dafou-ui-dist/assets/image-20211210164930280.31d35f48.png",hn="/naive-dafou-ui-dist/assets/image-20211210165241322.028908f5.png",qn="/naive-dafou-ui-dist/assets/image-20211210165350873.e4715b25.png",fn="/naive-dafou-ui-dist/assets/image-20211210181040462.b9259465.png",yn="/naive-dafou-ui-dist/assets/image-20211210210801146.5d42ab2a.png",wn="/naive-dafou-ui-dist/assets/image-20211210214818383.ff22b2af.png",_n="/naive-dafou-ui-dist/assets/image-20211210215629445.6c71049b.png",xn="/naive-dafou-ui-dist/assets/image-20211210230936309.0a82ce2e.png",Cn="/naive-dafou-ui-dist/assets/image-20211210182022214.3ac42896.png",Mn="/naive-dafou-ui-dist/assets/1460000038432420.ff5047e1.png",Sn="/naive-dafou-ui-dist/assets/image-20211211003113071.a665cc23.png";const Qn={},Rn=a('<blockquote><p>\u53C2\u7167\u7F51\u5740\uFF1Ahttps://www.jianshu.com/p/79ca08116d57</p><p>\u627E\u5230\u4E00\u7BC7\u4E0D\u9519\u7684\u53C2\u7167\u535A\u6587\uFF1Ahttps://www.cnblogs.com/ZhuChangwu/p/14093107.html</p></blockquote><h2 id="mq\u5F15\u8A00"><a class="header-anchor" href="#mq\u5F15\u8A00" aria-hidden="true">#</a> MQ\u5F15\u8A00</h2><blockquote><p>\u5E02\u9762\u4E0A\u7684\u6D88\u606F\u961F\u5217\u4EA7\u54C1\u6709\u5F88\u591A\uFF0C\u6BD4\u5982\u8001\u724C\u7684 ActiveMQ\u3001RabbitMQ \uFF0C\u76EE\u524D\u6211\u770B\u6700\u706B\u7684 Kafka \uFF0C\u8FD8\u6709 ZeroMQ \uFF0C\u53BB\u5E74\u5E95\u963F\u91CC\u5DF4\u5DF4\u6350\u8D60\u7ED9 Apache \u7684 RocketMQ \uFF0C\u8FDE redis \u8FD9\u6837\u7684 NoSQL \u6570\u636E\u5E93\u4E5F\u652F\u6301 MQ \u529F\u80FD</p></blockquote><h3 id="\u4EC0\u4E48\u662Fmq"><a class="header-anchor" href="#\u4EC0\u4E48\u662Fmq" aria-hidden="true">#</a> \u4EC0\u4E48\u662FMQ</h3><p>\u6D88\u606Fmessage\u662F\u6307\u5728\u5E94\u7528\u95F4\u4F20\u8F93\u7684\u6570\u636E\uFF0C\u6D88\u606F\u53EF\u4EE5\u975E\u5E38\u7B80\u5355\uFF0C\u6BD4\u5982\u53EA\u5305\u542B\u6587\u672C\u5B57\u7B26\u4E32\uFF0C\u4E5F\u53EF\u4EE5\u66F4\u52A0\u590D\u6742\uFF0C\u53EF\u80FD\u5305\u542B\u5D4C\u5165\u5F0F\u5BF9\u8C61</p><blockquote><p>\u6D88\u606F\u961F\u5217\uFF08Message Queue\uFF09\u662F\u4E00\u79CD\u5E94\u7528\u95F4\u7684\u901A\u4FE1\u65B9\u5F0F\uFF0C\u6D88\u606F\u53D1\u9001\u540E\u53EF\u4EE5\u7ACB\u5373\u8FD4\u56DE\uFF0C\u7531\u6D88\u606F\u7CFB\u7EDF\u6765\u786E\u4FDD\u6D88\u606F\u7684\u53EF\u9760\u4F20\u9012\u3002\u6D88\u606F\u53D1\u5E03\u8005\u53EA\u7BA1\u628A\u6D88\u606F\u53D1\u5E03\u5230 MQ \u4E2D\u800C\u4E0D\u7528\u7BA1\u8C01\u6765\u53D6\uFF0C\u6D88\u606F\u4F7F\u7528\u8005\u53EA\u7BA1\u4ECE MQ \u4E2D\u53D6\u6D88\u606F\u800C\u4E0D\u7BA1\u662F\u8C01\u53D1\u5E03\u7684\u3002\u8FD9\u6837\u53D1\u5E03\u8005\u548C\u4F7F\u7528\u8005\u90FD\u4E0D\u7528\u77E5\u9053\u5BF9\u65B9\u7684\u5B58\u5728</p></blockquote><p>mq(message queue)\u7FFB\u8BD1\u4E3A\u6D88\u606F\u961F\u5217\uFF0C\u901A\u8FC7\u5178\u578B\u7684\u751F\u4EA7\u8005\u548C\u6D88\u8D39\u8005\u6A21\u578B\uFF0C\u751F\u4EA7\u8005\u4E0D\u65AD\u5411\u6D88\u606F\u961F\u5217\u4E2D\u751F\u4EA7\u6D88\u606F\uFF0C\u6D88\u8D39\u8005\u4E0D\u65AD\u4ECE\u961F\u5217\u4E2D\u83B7\u53D6\u6D88\u606F\u3002\u56E0\u4E3A\u751F\u4EA7\u548C\u6D88\u8D39\u90FD\u662F\u5F02\u6B65\u7684\uFF0C\u800C\u4E14\u53EA\u5173\u5FC3\u6D88\u606F\u7684\u53D1\u9001\u548C\u63A5\u6536\uFF0C\u6CA1\u6709\u4E1A\u52A1\u903B\u8F91\u7684\u4FB5\u5165\uFF0C\u8F7B\u677E\u663E\u73B0\u7CFB\u7EDF\u95F4\u7684\u8026\u5408\uFF0C\u522B\u540D\u4E3A\u6D88\u606F\u4E2D\u95F4\u4EF6\uFF0C\u901A\u8FC7\u5229\u7528\u9AD8\u6548\u7684\u6D88\u606F\u4F20\u9012\u673A\u5236\u8FDB\u884C\u5E73\u53F0\u65E0\u5173\u7684\u6570\u636E\u4EA4\u6D41\uFF0C\u5E76\u57FA\u4E8E\u6570\u636E\u901A\u4FE1\u6765\u8FDB\u884C\u5206\u5E03\u5F0F\u7CFB\u7EDF\u7684\u96C6\u6210</p><h3 id="\u4E3A\u4F55\u7528\u6D88\u606F\u961F\u5217"><a class="header-anchor" href="#\u4E3A\u4F55\u7528\u6D88\u606F\u961F\u5217" aria-hidden="true">#</a> \u4E3A\u4F55\u7528\u6D88\u606F\u961F\u5217</h3><p>\u6D88\u606F\u961F\u5217\u662F\u4E00\u79CD\u5E94\u7528\u95F4\u7684\u5F02\u6B65\u534F\u4F5C\u673A\u5236\uFF0C\u90A3\u4E48\u4EC0\u4E48\u65F6\u5019\u7528MQ\u5462\uFF1F</p><p>\u4EE5\u5E38\u89C1\u7684\u8BA2\u5355\u7CFB\u7EDF\u4E3A\u4F8B\uFF0C\u7528\u6237\u70B9\u51FB\u3010\u4E0B\u5355\u3011\u6309\u94AE\u4E4B\u540E\u7684\u4E1A\u52A1\u903B\u8F91\u53EF\u80FD\u5305\u62EC\uFF1A\u6263\u51CF\u5E93\u5B58\u3001\u751F\u6210\u76F8\u5E94\u5355\u636E\u3001\u53D1\u7EA2\u5305\u3001\u53D1\u77ED\u4FE1\u901A\u77E5\u3002\u5728\u4E1A\u52A1\u53D1\u5C55\u521D\u671F\u8FD9\u4E9B\u903B\u8F91\u53EF\u80FD\u653E\u5728\u4E00\u8D77\u540C\u6B65\u6267\u884C\uFF0C\u968F\u7740\u4E1A\u52A1\u7684\u53D1\u5C55\u8BA2\u5355\u91CF\u589E\u957F\uFF0C\u9700\u8981\u63D0\u5347\u7CFB\u7EDF\u670D\u52A1\u7684\u6027\u80FD\uFF0C\u8FD9\u65F6\u53EF\u4EE5\u5C06\u4E00\u4E9B\u4E0D\u9700\u8981\u7ACB\u5373\u751F\u6548\u7684\u64CD\u4F5C\u62C6\u5206\u51FA\u6765\u5F02\u6B65\u6267\u884C\uFF0C\u6BD4\u5982\u53D1\u653E\u7EA2\u5305\u3001\u53D1\u77ED\u4FE1\u901A\u77E5\u7B49\u3002\u8FD9\u79CD\u573A\u666F\u4E0B\u5C31\u53EF\u4EE5\u7528 MQ \uFF0C\u5728\u4E0B\u5355\u7684\u4E3B\u6D41\u7A0B\uFF08\u6BD4\u5982\u6263\u51CF\u5E93\u5B58\u3001\u751F\u6210\u76F8\u5E94\u5355\u636E\uFF09\u5B8C\u6210\u4E4B\u540E\u53D1\u9001\u4E00\u6761\u6D88\u606F\u5230 MQ \u8BA9\u4E3B\u6D41\u7A0B\u5FEB\u901F\u5B8C\u7ED3\uFF0C\u800C\u7531\u53E6\u5916\u7684\u5355\u72EC\u7EBF\u7A0B\u62C9\u53D6MQ\u7684\u6D88\u606F\uFF08\u6216\u8005\u7531 MQ \u63A8\u9001\u6D88\u606F\uFF09\uFF0C\u5F53\u53D1\u73B0 MQ \u4E2D\u6709\u53D1\u7EA2\u5305\u6216\u53D1\u77ED\u4FE1\u4E4B\u7C7B\u7684\u6D88\u606F\u65F6\uFF0C\u6267\u884C\u76F8\u5E94\u7684\u4E1A\u52A1\u903B\u8F91</p><h3 id="mq\u6709\u90A3\u4E9B"><a class="header-anchor" href="#mq\u6709\u90A3\u4E9B" aria-hidden="true">#</a> MQ\u6709\u90A3\u4E9B</h3><p>\u5F53\u4ECA\u5E02\u9762\u4E0A\u6709\u5F88\u591A\u4E3B\u6D41\u7684\u6D88\u606F\u4E2D\u95F4\u4EF6\uFF0C\u5982\u8001\u724C\u7684ActiveMQ\u3001RabbitMQ\uFF0C\u7099\u624B\u53EF\u70ED\u7684kafka\uFF0C\u963F\u91CC\u5DF4\u5DF4\u81EA\u4E3B\u5F00\u53D1\u7684RocketMQ\u7B49</p><h3 id="\u4E0D\u540Cmq\u7279\u70B9"><a class="header-anchor" href="#\u4E0D\u540Cmq\u7279\u70B9" aria-hidden="true">#</a> \u4E0D\u540CMQ\u7279\u70B9</h3><ol><li>ActiveMQ</li></ol><p>\u662Fapache\u51FA\u54C1\uFF0C\u6700\u6D41\u884C\u7684\uFF0C\u80FD\u529B\u5F3A\u52B2\u7684\u5F00\u6E90\u6D88\u606F\u603B\u7EBF\uFF0C\u5B83\u662F\u4E00\u4E2A\u5B8C\u5168\u652F\u6301JMS\u89C4\u8303\u7684\u6D88\u606F\u4E2D\u95F4\u4EF6\uFF0C\u4E30\u5BCCAPI\uFF0C\u591A\u79CD\u96C6\u7FA4\u67B6\u6784\u6A21\u5F0F\u8BA9ActiveMQ\u5728\u4E1A\u754C\u79F0\u4E3A\u8001\u724C\u7684\u6D88\u606F\u4E2D\u95F4\u4EF6\uFF0C\u5728\u4E2D\u5C0F\u578B\u4F01\u4E1A\u4E2D\u9887\u53D7\u6B22\u8FCE\uFF0C<strong>\u6027\u80FD\u53D7\u8BDF\u75C5\uFF0C\u541E\u5410\u91CF\u4E0D\u9AD8</strong></p><blockquote><p><strong>JMS</strong>\uFF1A\u5373Java\u6D88\u606F\u670D\u52A1\uFF08Java Message Service\uFF09<strong>\u5E94\u7528\u7A0B\u5E8F\u63A5\u53E3</strong>\uFF0C\u7531sun\u516C\u53F8\u63D0\u51FA\uFF0C\u5E76\u4E14sun\u516C\u53F8\u5B9A\u4E49\u597D\u4E86\u63A5\u53E3\u3002\u5305\u62ECcreate\u3001send\u3001recieve\u3002\u53EA\u8981\u60F3\u4F7F\u7528\u5B83\uFF0C\u5C31\u5F97\u5B9E\u73B0\u5B83\u5B9A\u4E49\u7684\u63A5\u53E3\u3002 \u6D88\u606F\u670D\u52A1\u662F\u4E00\u4E2A\u4E0E\u5177\u4F53\u5E73\u53F0\u65E0\u5173\u7684API\uFF0C\u7EDD\u5927\u591A\u6570MOM\u63D0\u4F9B\u5546\u90FD\u5BF9JMS\u63D0\u4F9B\u652F\u6301\u3002\u4E0D\u597D\u7684\u5730\u65B9\u662F\u8BED\u8A00\u5C42\u9762\u7684\u9650\u5236\uFF0C\u53EA\u80FD\u4E3AJAVA\uFF0C\u8FD9\u5176\u5B9E\u7A0D\u5FAE\u6709\u70B9\u548C\u5FAE\u670D\u52A1\u7684\u89C2\u70B9\u76F8\u8FDD\u80CC\u3002\u8981\u6C42\u8BED\u8A00\u53EA\u80FD\u662FJAVA\uFF0C\u800C\u4E0D\u80FD\u662Fpy\u7B49</p></blockquote><ol start="2"><li>Kafka</li></ol><p>kafka\u662FlinkedIn\u5F00\u6E90\u7684\u5206\u5E03\u5F0F\u53D1\u5E03-\u8BA2\u9605\u6D88\u606F\u7CFB\u7EDF\uFF0C\u76EE\u524D\u5F52\u5C5E\u4E8Eapache\u9876\u7EA7\u9879\u76EE\uFF0Ckafka\u4E3B\u8981\u7279\u70B9\u662F\u57FA\u4E8Epull\u7684\u6A21\u5F0F\u6765\u5904\u7406\u6D88\u606F\u6D88\u8D39\uFF0C\u6700\u6C42\u9AD8\u541E\u5410\u91CF\uFF0C\u4E00\u5F00\u59CB\u7684\u76EE\u7684\u5C31\u662F\u7528\u4E8E\u65E5\u5FD7\u6536\u96C6\u548C\u4F20\u8F93\uFF0C0.8\u7248\u672C\u5F00\u59CB\u652F\u6301\u590D\u5236\uFF0C\u4E0D\u652F\u6301\u4E8B\u52A1\uFF0C\u5BF9\u6D88\u606F\u7684\u91CD\u590D\u3001\u4E22\u5931\u3001\u9519\u8BEF\u6CA1\u6709\u4E25\u683C\u7684\u8981\u6C42\uFF0C\u9002\u5408\u4EA7\u751F\u5927\u91CF\u6570\u636E\u7684\u4E92\u8054\u7F51\u670D\u52A1\u7684\u6570\u636E\u6536\u96C6\u4E1A\u52A1\uFF0C<strong>\u5BF9\u6570\u636E\u4E00\u81F4\u6027\u4E0D\u9AD8</strong></p><ol start="3"><li>rocketmq</li></ol><p>rocketmq\u662F\u963F\u91CC\u4E91\u5F00\u6E90\u7684\u6D88\u606F\u4E2D\u95F4\u4EF6\uFF0C\u5B83\u662F\u7EAFJava\u5F00\u53D1\uFF0C\u5177\u6709\u9AD8\u541E\u5410\u91CF\u3001\u9AD8\u53EF\u7528\u6027\u3001\u9002\u5408\u5927\u89C4\u6A21\u5206\u5E03\u5F0F\u7CFB\u7EDF\u5E94\u7528\u7684\u7279\u70B9\u3002rocketmq\u601D\u8DEF\u8D77\u6E90\u4E8Ekafka\uFF0C\u4F46\u5E76\u4E0D\u662Fkafka\u7684\u4E00\u4E2Acopy\uFF0C\u5B83\u5BF9\u6D88\u606F\u7684\u53EF\u9760\u6027\u4F20\u8F93\u4EE5\u53CA\u4E8B\u52A1\u6027\u505A\u4E86\u4F18\u5316\uFF0C\u76EE\u524D\u5728\u963F\u91CC\u96C6\u56E2\u88AB\u5E7F\u6CDB\u5E94\u7528\u4E8E\u4EA4\u6613\u3001\u5145\u503C\u3001\u6D41\u8BA1\u7B97\u3001\u6D88\u606F\u63A8\u9001\u3001\u65E5\u5FD7\u6D41\u5F0F\u8BA1\u7B97\u3001binglog\u5206\u53D1\u7B49\u573A\u666F\uFF0C<strong>\u5F00\u6E90\u7684\u529F\u80FD\u76F8\u5BF9\u6BD4\u8F83\u5C11\uFF0C\u6BD4\u5982\u4E0D\u652F\u6301\u4E8B\u52A1</strong></p><ol start="4"><li>rabbitmq</li></ol><p>\u4F7F\u7528\u4E86erlang\u8BED\u8A00\u5F00\u53D1\u7684\u5F00\u6E90\u6D88\u606F\u961F\u5217\u7CFB\u7EDF\uFF0C\u57FA\u4E8Eamqp\u534F\u8BAE\u6765\u5B9E\u73B0\uFF0Camqp\u7684\u4E3B\u8981\u7279\u5F81\u662F\u9762\u5411\u6D88\u606F\u3001\u961F\u5217\u3001\u8DEF\u7531\uFF08\u5305\u62EC\u70B9\u5BF9\u70B9\u548C\u53D1\u5E03/\u8BA2\u9605\uFF09\u3001\u53EF\u9760\u6027\u3001\u5B89\u5168\u3002amqp\u534F\u8BAE\u66F4\u591A\u7528\u5728\u4F01\u4E1A\u7CFB\u7EDF\u5185\u5BF9\u6570\u636E\u4E00\u81F4\u6027\u3001\u7A33\u5B9A\u6027\u548C\u53EF\u9760\u6027\u8981\u6C42\u5F88\u9AD8\u7684\u573A\u666F\uFF0C\u5BF9\u6027\u80FD\u548C\u541E\u5410\u91CF\u8FD8\u5728\u5176\u6B21</p><blockquote><p>rabbitmq\u6BD4kafka\u53EF\u9760\uFF0Ckafka\u66F4\u9002\u5408IO\u9AD8\u541E\u5410\u7684\u5904\u7406\uFF0C\u4E00\u822C\u5E94\u7528\u5728\u5927\u6570\u636E\u65E5\u5FD7\u5904\u7406\u6216\u8005\u5BF9\u5B9E\u65F6\u6027\uFF08\u5C11\u91CF\u5EF6\u8FDF\uFF09\uFF0C\u53EF\u9760\u6027\uFF08\u5C11\u91CF\u4E22\u6570\u636E\uFF09\u8981\u6C42\u7A0D\u4F4E\u573A\u666F\u4F7F\u7528\uFF0C\u6BD4\u5982ELK\u65E5\u5FD7\u6536\u96C6</p></blockquote><h2 id="rabbitmq\u5F15\u8A00"><a class="header-anchor" href="#rabbitmq\u5F15\u8A00" aria-hidden="true">#</a> rabbitmq\u5F15\u8A00</h2><h3 id="rabbitmq"><a class="header-anchor" href="#rabbitmq" aria-hidden="true">#</a> rabbitmq</h3><blockquote><p>\u57FA\u4E8EAMQP\u534F\u8BAE\uFF0Cerlang\u8BED\u8A00\u5F00\u53D1\uFF08\u672C\u8EAB\u5C31\u662F\u505Asocket\u7F16\u7A0B\u505A\u7684\u4E0D\u9519\u7684\uFF09\uFF0C\u662F\u90E8\u7F72\u6700\u521A\u53D1\u7684\u5F00\u6E90\u6D88\u606F\u4E2D\u95F4\u4EF6\uFF0C\u662F\u6700\u53D7\u6B22\u8FCE\u7684\u5F00\u6E90\u6D88\u606F\u4E2D\u95F4\u4EF6\u4E4B\u4E00</p><ul><li>AMQP\u652F\u6301\u6D88\u606F\u4E2D\u95F4\u4EF6\u7684\u5F88\u591A\u7684\u4E1A\u52A1\u573A\u666F\uFF0C\u6BD4\u5982\u70B9\u5BF9\u70B9\u7684\u53D1\u5E03\u3001\u4EE5\u53CA\u4EA4\u6362\u673A\u8DEF\u7531\u3001\u53D1\u5E03\u8BA2\u9605\u6A21\u5F0F</li><li>erlang\u8BED\u8A00\u5F00\u53D1\uFF0C\u672C\u8EAB\u5C31\u662F\u505Asocket\u7F16\u7A0B\u505A\u7684\u4E0D\u9519\u7684\uFF0C\u6548\u7387\u5F88\u597D</li><li>\u548Cspring\u6846\u67B6\u5929\u751F\u7684\u65E0\u7F1D\u7684\u6574\u5408</li><li>\u5BF9\u6570\u636E\u4E00\u81F4\u6027\u7684\u8981\u6C42\u548C\u6D88\u606F\u7684\u4E22\u5931\u5904\u7406\u975E\u5E38\uFF0C\u5373\u4F7F\u662F\u6570\u636E\u51FA\u73B0\u9519\u8BEF\u7684\u8BDD\uFF0C\u4E5F\u53EF\u4EE5\u901A\u8FC7\u5185\u90E8\u7684\u673A\u5236\u6062\u590D</li></ul><p>\u5B98\u7F51\uFF1Ahttps://www.rabbitmq.com/</p><p>\u5B98\u65B9\u6559\u7A0B\uFF1Ahttps://www.rabbitmq.c(rabbitmq\u57FA\u7840/om/#getstarted</p></blockquote><h3 id="\u7279\u70B9"><a class="header-anchor" href="#\u7279\u70B9" aria-hidden="true">#</a> \u7279\u70B9</h3><p>RabbitMQ \u662F\u4E00\u4E2A\u7531 Erlang \u8BED\u8A00\u5F00\u53D1\u7684 AMQP \u7684\u5F00\u6E90\u5B9E\u73B0\u3002</p><p>AMQP \uFF1AAdvanced Message Queue\uFF0C\u9AD8\u7EA7\u6D88\u606F\u961F\u5217\u534F\u8BAE\u3002\u5B83\u662F\u5E94\u7528\u5C42\u534F\u8BAE\u7684\u4E00\u4E2A\u5F00\u653E\u6807\u51C6\uFF0C\u4E3A\u9762\u5411\u6D88\u606F\u7684\u4E2D\u95F4\u4EF6\u8BBE\u8BA1\uFF0C\u57FA\u4E8E\u6B64\u534F\u8BAE\u7684\u5BA2\u6237\u7AEF\u4E0E\u6D88\u606F\u4E2D\u95F4\u4EF6\u53EF\u4F20\u9012\u6D88\u606F\uFF0C\u5E76\u4E0D\u53D7\u4EA7\u54C1\u3001\u5F00\u53D1\u8BED\u8A00\u7B49\u6761\u4EF6\u7684\u9650\u5236\u3002</p><p>RabbitMQ \u6700\u521D\u8D77\u6E90\u4E8E\u91D1\u878D\u7CFB\u7EDF\uFF0C\u7528\u4E8E\u5728\u5206\u5E03\u5F0F\u7CFB\u7EDF\u4E2D\u5B58\u50A8\u8F6C\u53D1\u6D88\u606F\uFF0C\u5728\u6613\u7528\u6027\u3001\u6269\u5C55\u6027\u3001\u9AD8\u53EF\u7528\u6027\u7B49\u65B9\u9762\u8868\u73B0\u4E0D\u4FD7\u3002\u5177\u4F53\u7279\u70B9\u5305\u62EC\uFF1A</p><ul><li>\u53EF\u9760\u6027\uFF0C\u6301\u4E45\u5316\u3001\u4F20\u8F93\u786E\u8BA4\u3001\u53D1\u5E03\u786E\u8BA4\u7B49</li><li>\u7075\u6D3B\u7684\u8DEF\u7531\uFF0C\u5728\u6D88\u606F\u8FDB\u5165\u961F\u5217\u4E4B\u524D\uFF0C\u901A\u8FC7exchange\u6765\u8DEF\u7531\u6D88\u606F\uFF0C\u5BF9\u4E8E\u5178\u578B\u7684\u8DEF\u7531\u529F\u80FD\uFF0Crabbitmq\u5DF2\u7ECF\u63D0\u4F9B\u4E86\u4E00\u4E9B\u5185\u7F6E\u7684exchange\u6765\u5B9E\u73B0\u3002\u9488\u5BF9\u66F4\u52A0\u590D\u6742\u7684\u8DEF\u7531\u529F\u80FD\uFF0C\u53EF\u4EE5\u5C06\u591A\u4E2Aexchange\u7ED1\u5B9A\u5728\u4E00\u8D77\uFF0C\u4E5F\u901A\u8FC7\u63D2\u4EF6\u673A\u5236\u5B9E\u73B0\u81EA\u5DF1\u7684exchange</li><li>\u6D88\u606F\u96C6\u7FA4\uFF0C\u591A\u4E2Arabbitmq\u670D\u52A1\u5668\u7EC4\u6210\u4E00\u4E2A\u96C6\u7FA4</li><li>\u9AD8\u53EF\u7528\uFF0C\u961F\u5217\u53EF\u4EE5\u5728\u96C6\u7FA4\u4E2D\u7684\u673A\u5668\u4E0A\u8FDB\u884C\u955C\u50CF\uFF0C\u4F7F\u5F97\u5728\u90E8\u5206\u8282\u70B9\u51FA\u73B0\u95EE\u9898\u65F6\u4ECD\u7136\u53EF\u4EE5\u4F7F\u7528</li><li>\u591A\u79CD\u534F\u8BAE\uFF0C\u652F\u6301\u591A\u79CD\u6D88\u606F\u961F\u5217\u534F\u8BAE</li><li>\u591A\u8BED\u8A00\u5BA2\u6237\u7AEF\uFF0C\u652F\u6301\u591A\u79CD\u8BED\u8A00</li><li>\u7BA1\u7406\u754C\u9762\uFF0C\u6613\u7528\u7BA1\u7406\u754C\u9762</li><li>\u8DDF\u8E2A\u673A\u5236\uFF0C\u5982\u679C\u6D88\u606F\u5F02\u5E38\uFF0C\u4F7F\u7528\u8005\u53EF\u4EE5\u627E\u51FA\u53D1\u751F\u4E86\u4EC0\u4E48</li><li>\u63D2\u4EF6\u673A\u5236\uFF0C\u63D0\u4F9B\u591A\u79CD\u63D2\u4EF6\u8FDB\u884C\u591A\u65B9\u9762\u6269\u5C55\uFF0C\u4E5F\u53EF\u4EE5\u6269\u5C55\u81EA\u5DF1\u7684\u63D2\u4EF6</li></ul><h4 id="amqp\u534F\u8BAE"><a class="header-anchor" href="#amqp\u534F\u8BAE" aria-hidden="true">#</a> AMQP\u534F\u8BAE</h4><p>advance message queuing protocol \uFF08\u9AD8\u7EA7\u6D88\u606F\u961F\u5217\u534F\u8BAE\uFF09\u57282003\u5E74\u65F6\u88AB\u63D0\u51FA\uFF0C\u6700\u65E9\u7528\u4E8E\u89E3\u51B3\u91D1\u878D\u9886\u57DF\u4E0D\u540C\u5E73\u53F0\u4E4B\u95F4\u6D88\u606F\u4F20\u9012\u4EA4\u4E92\u95EE\u9898\u3002\u987E\u540D\u601D\u4E49\uFF0CAMQP\u662F\u4E00\u79CD\u534F\u8BAE\uFF0C\u66F4\u51C6\u786E\u7684\u8BF4\u662F\u4E00\u79CDbinary wire-leavl protocol\uFF08\u94FE\u63A5\u534F\u8BAE\uFF09\u3002\u8FD9\u662F\u5176\u548CJMS\u7684\u672C\u8D28\u5DEE\u522B\uFF0CAMQP\u4E0D\u4ECEapi\u5C42\u8FDB\u884C\u9650\u5B9A\uFF0C\u800C\u662F\u76F4\u63A5\u5B9A\u4E49\u7F51\u7EDC\u4EA4\u6362\u7684\u6570\u636E\u683C\u5F0F\u3002\u8FD9\u4F7F\u5F97\u5B9E\u73B0\u4E86AMQP\u7684provider\u5929\u7136\u6027\u5C31\u662F\u8DE8\u5E73\u53F0\u7684\u3002\u4EE5\u4E0B\u662FAMQP\u534F\u8BAE\u6A21\u578B\uFF1A</p><p><img src="'+u+'" alt="image-20211209021623989"></p><h3 id="rabbitmq\u4E2D\u7684\u6982\u5FF5"><a class="header-anchor" href="#rabbitmq\u4E2D\u7684\u6982\u5FF5" aria-hidden="true">#</a> rabbitmq\u4E2D\u7684\u6982\u5FF5</h3><h4 id="\u6D88\u606F\u6A21\u578B"><a class="header-anchor" href="#\u6D88\u606F\u6A21\u578B" aria-hidden="true">#</a> \u6D88\u606F\u6A21\u578B</h4><p>RabbitMQ\u652F\u6301\u4EE5\u4E0B\u4E94\u79CD\u6D88\u606F\u6A21\u578B\uFF0C\u7B2C\u516D\u79CDRPC\u672C\u8D28\u4E0A\u662F\u670D\u52A1\u8C03\u7528\uFF0C\u6240\u4EE5\u4E0D\u7B97\u505A\u670D\u52A1\u901A\u4FE1\u6D88\u606F\u6A21\u578B\u3002</p><p><img src="'+r+'" alt="img"></p><p><img src="'+d+'" alt="img"></p><p>\u6D88\u8D39\u8005\uFF08consumer\uFF09\u8BA2\u9605\u67D0\u4E2A\u961F\u5217\uFF0C\u751F\u4EA7\u8005\uFF08producer\uFF09\u521B\u5EFA\u6D88\u606F\uFF0C\u7136\u540E\u53D1\u5E03\u5230\u961F\u5217\uFF08queue\uFF09\u4E2D\uFF0C\u6700\u540E\u5C06\u6D88\u606F\u53D1\u9001\u5230\u76D1\u542C\u7684\u6D88\u8D39\u8005\u624B\u91CC</p><p><img src="'+k+'" alt="img"></p><ul><li><p>P\uFF08producer/ publisher\uFF09\uFF1A\u751F\u4EA7\u8005\uFF0C\u53D1\u9001\u6D88\u606F\u7684\u670D\u52A1</p></li><li><p>C\uFF08consumer\uFF09\uFF1A\u6D88\u8D39\u8005\uFF0C\u63A5\u6536\u6D88\u606F\u7684\u670D\u52A1</p></li><li><p>\u7EA2\u8272\u533A\u57DF\u5C31\u662FMQ\u4E2D\u7684Queue\uFF0C\u53EF\u4EE5\u628A\u5B83\u7406\u89E3\u6210\u4E00\u4E2A\u90AE\u7BB1</p><ul><li><p>\u9996\u5148\u4FE1\u4EF6\u6765\u4E86\u4E0D\u5F3A\u6C42\u5FC5\u987B\u9A6C\u4E0A\u9A6C\u53BB\u62FF</p></li><li><p>\u5176\u6B21,\u5B83\u662F\u6709\u6700\u5927\u5BB9\u91CF\u7684(\u53D7\u4E3B\u673A\u548C\u78C1\u76D8\u7684\u9650\u5236,\u662F\u4E00\u4E2A\u7F13\u5B58\u533A)</p></li><li><p>\u5141\u8BB8\u591A\u4E2A\u6D88\u8D39\u8005\u76D1\u542C\u540C\u4E00\u4E2A\u961F\u5217\uFF0C\u4E89\u62A2\u6D88\u606F</p></li></ul></li></ul><p>Worker\u6A21\u578B</p><p><img src="'+m+'" alt="img"></p><p>Worker\u6A21\u578B\u4E2D\u4E5F\u53EA\u6709\u4E00\u4E2A\u5DE5\u4F5C\u961F\u5217\u3002\u4F46\u5B83\u662F\u4E00\u79CD\u7ADE\u4E89\u6D88\u8D39\u6A21\u5F0F\u3002\u53EF\u4EE5\u770B\u5230\u540C\u4E00\u4E2A\u961F\u5217\u6211\u4EEC\u7ED1\u5B9A\u4E0A\u4E86\u591A\u4E2A\u6D88\u8D39\u8005\uFF0C\u6D88\u8D39\u8005\u4E89\u62A2\u7740\u6D88\u8D39\u6D88\u606F\uFF0C<strong>\u8FD9\u53EF\u4EE5\u6709\u6548\u7684\u907F\u514D\u6D88\u606F\u5806\u79EF</strong></p><p>\u6BD4\u5982\u5BF9\u4E8E\u77ED\u4FE1\u5FAE\u670D\u52A1\u96C6\u7FA4\u6765\u8BF4\u5C31\u53EF\u4EE5\u4F7F\u7528\u8FD9\u79CD\u6D88\u606F\u6A21\u578B\uFF0C\u6765\u4E86\u8BF7\u6C42\u5927\u5BB6\u62A2\u7740\u6D88\u8D39\u6389</p><p>\u5982\u4F55\u5B9E\u73B0\u8FD9\u79CD\u67B6\u6784\uFF1A\u5BF9\u4E8E\u4E0A\u9762\u7684HelloWorld\u8FD9\u5176\u5B9E\u5C31\u662F\u76F8\u540C\u7684\u670D\u52A1\u6211\u4EEC\u542F\u52A8\u4E86\u591A\u6B21\u7F62\u4E86\uFF0C\u81EA\u7136\u5C31\u662F\u8FD9\u79CD\u67B6\u6784</p><h4 id="rabbitmq\u57FA\u672C\u6982\u5FF5"><a class="header-anchor" href="#rabbitmq\u57FA\u672C\u6982\u5FF5" aria-hidden="true">#</a> rabbitmq\u57FA\u672C\u6982\u5FF5</h4><p>rabbitmq\u662FAMQP\u534F\u8BAE\u7684\u4E00\u79CD\u5F00\u6E90\u5B9E\u73B0\uFF0C\u6240\u4EE5\u5176\u5185\u90E8\u5B9E\u9645\u4E0A\u4E5F\u662FAMQP\u4E2D\u7684\u57FA\u672C\u6982\u5FF5</p><p><img src="'+b+'" alt="img"></p><ol><li>message</li></ol><p>\u6D88\u606F\uFF0C\u5B83\u7531\u6D88\u606F\u5934\u548C\u6D88\u606F\u4F53\u7EC4\u6210\u3002\u6D88\u606F\u4F53\u662F\u4E0D\u900F\u660E\u7684\uFF0C\u800C\u6D88\u606F\u5934\u5219\u7531\u4E00\u7CFB\u5217\u7684\u53EF\u9009\u5C5E\u6027\u7EC4\u6210\uFF0C\u8FD9\u4E9B\u5C5E\u6027\u5305\u62ECrouting-key\uFF08\u8DEF\u7531\u952E\uFF09\u3001priority\uFF08\u76F8\u5BF9\u4E8E\u5176\u4ED6\u6D88\u606F\u7684\u4F18\u5148\u6743\uFF09\u3001delivery-mode\uFF08\u6307\u51FA\u8BE5\u6D88\u606F\u53EF\u80FD\u9700\u8981\u6301\u4E45\u6027\u5B58\u50A8\uFF09\u7B49</p><ol start="2"><li>publisher</li></ol><p>\u6D88\u606F\u7684\u751F\u4EA7\u8005\uFF0C\u4E5F\u662F\u4E00\u4E2A\u5411\u4EA4\u6362\u673A\u53D1\u5E03\u6D88\u606F\u7684\u5BA2\u6237\u7AEF\u5E94\u7528\u7A0B\u5E8F</p><ol start="3"><li>exchange</li></ol><p>\u4EA4\u6362\u5668\uFF0C\u7528\u6765\u63A5\u6536\u751F\u4EA7\u8005\u53D1\u9001\u7684\u6D88\u606F\u5E76\u5C06\u8FD9\u4E9B\u6D88\u606F\u8DEF\u7531\u7ED9\u670D\u52A1\u5668\u4E2D\u7684\u961F\u5217</p><ol start="4"><li>binding</li></ol><p>\u7ED1\u5B9A\uFF0C\u7528\u4E8E\u6D88\u606F\u961F\u5217\u548C\u4EA4\u6362\u5668\u4E4B\u95F4\u7684\u5173\u8054\u3002\u4E00\u4E2A\u7ED1\u5B9A\u5C31\u662F\u57FA\u4E8E\u8DEF\u7531\u952E\u5C06\u4EA4\u6362\u5668\u548C\u6D88\u606F\u961F\u5217\u8FDE\u63A5\u8D77\u6765\u7684\u8DEF\u7531\u89C4\u5219\uFF0C\u6240\u4EE5\u53EF\u4EE5\u5C06\u4EA4\u6362\u5668\u7406\u89E3\u6210\u4E00\u4E2A\u7531\u7ED1\u5B9A\u6784\u6210\u7684\u8DEF\u7531\u8868</p><ol start="5"><li>queue</li></ol><p>\u6D88\u606F\u961F\u5217\uFF0C\u7528\u6765\u4FDD\u5B58\u6D88\u606F\u76F4\u5230\u53D1\u9001\u7ED9\u6D88\u8D39\u8005\u3002\u5B83\u662F\u6D88\u606F\u7684\u5BB9\u5668\uFF0C\u4E5F\u662F\u6D88\u606F\u7684\u7EC8\u70B9\u3002\u4E00\u4E2A\u6D88\u606F\u53EF\u6295\u5165\u4E00\u4E2A\u6216\u591A\u4E2A\u961F\u5217\u3002\u6D88\u606F\u4E00\u76F4\u5728\u961F\u5217\u91CC\u9762\uFF0C\u7B49\u5F85\u6D88\u8D39\u8005\u8FDE\u63A5\u5230\u8FD9\u4E2A\u961F\u5217\u5C06\u5176\u53D6\u8D70</p><ol start="6"><li>connection</li></ol><p>\u7F51\u7EDC\u8FDE\u63A5\uFF0C\u6BD4\u5982\u4E00\u4E2ATCP\u8FDE\u63A5</p><ol start="7"><li>channel</li></ol><p>\u4FE1\u9053\uFF0C\u591A\u8DEF\u590D\u7528\u8FDE\u63A5\u4E2D\u7684\u4E00\u6761\u72EC\u7ACB\u7684\u53CC\u5411\u6570\u636E\u6D41\u901A\u9053\u3002\u4FE1\u9053\u662F\u5EFA\u7ACB\u5728\u771F\u5B9E\u7684TCP\u8FDE\u63A5\u5185\u5730\u865A\u62DF\u8FDE\u63A5\uFF0CAMQP \u547D\u4EE4\u90FD\u662F\u901A\u8FC7\u4FE1\u9053\u53D1\u51FA\u53BB\u7684\uFF0C\u4E0D\u7BA1\u662F\u53D1\u5E03\u6D88\u606F\u3001\u8BA2\u9605\u961F\u5217\u8FD8\u662F\u63A5\u6536\u6D88\u606F\uFF0C\u8FD9\u4E9B\u52A8\u4F5C\u90FD\u662F\u901A\u8FC7\u4FE1\u9053\u5B8C\u6210\u3002\u56E0\u4E3A\u5BF9\u4E8E\u64CD\u4F5C\u7CFB\u7EDF\u6765\u8BF4\u5EFA\u7ACB\u548C\u9500\u6BC1 TCP \u90FD\u662F\u975E\u5E38\u6602\u8D35\u7684\u5F00\u9500\uFF0C\u6240\u4EE5\u5F15\u5165\u4E86\u4FE1\u9053\u7684\u6982\u5FF5\uFF0C\u4EE5\u590D\u7528\u4E00\u6761 TCP \u8FDE\u63A5</p><ol start="8"><li>consumer</li></ol><p>\u6D88\u606F\u7684\u6D88\u8D39\u8005\uFF0C\u8868\u793A\u4E00\u4E2A\u4ECE\u6D88\u606F\u961F\u5217\u4E2D\u53D6\u8D70\u6D88\u606F\u7684\u5BA2\u6237\u7AEF\u5E94\u7528\u7A0B\u5E8F</p><ol start="9"><li>virtual host</li></ol><p>\u865A\u62DF\u4E3B\u673A\uFF0C\u8868\u793A\u4E00\u6279\u4EA4\u6362\u5668\u3001\u6D88\u606F\u961F\u5217\u548C\u76F8\u5173\u5BF9\u8C61\u3002\u865A\u62DF\u4E3B\u673A\u662F\u5171\u4EAB\u76F8\u540C\u7684\u8EAB\u4EFD\u8BA4\u8BC1\u548C\u52A0\u5BC6\u73AF\u5883\u7684\u72EC\u7ACB\u670D\u52A1\u5668\u57DF\u3002\u6BCF\u4E2A vhost \u672C\u8D28\u4E0A\u5C31\u662F\u4E00\u4E2A mini \u7248\u7684 RabbitMQ \u670D\u52A1\u5668\uFF0C\u62E5\u6709\u81EA\u5DF1\u7684\u961F\u5217\u3001\u4EA4\u6362\u5668\u3001\u7ED1\u5B9A\u548C\u6743\u9650\u673A\u5236\u3002vhost \u662F AMQP \u6982\u5FF5\u7684\u57FA\u7840\uFF0C\u5FC5\u987B\u5728\u8FDE\u63A5\u65F6\u6307\u5B9A\uFF0CRabbitMQ \u9ED8\u8BA4\u7684 vhost \u662F /</p><ol start="10"><li>broker</li></ol><p>\u8868\u793A\u6D88\u606F\u961F\u5217\u670D\u52A1\u5668\u5B9E\u4F53</p><h4 id="amqp\u4E2D\u7684\u8DEF\u7531"><a class="header-anchor" href="#amqp\u4E2D\u7684\u8DEF\u7531" aria-hidden="true">#</a> amqp\u4E2D\u7684\u8DEF\u7531</h4><blockquote><p>AMQP \u4E2D\u6D88\u606F\u7684\u8DEF\u7531\u8FC7\u7A0B\u548C Java \u5F00\u53D1\u8005\u719F\u6089\u7684 JMS \u5B58\u5728\u4E00\u4E9B\u5DEE\u522B\uFF0CAMQP \u4E2D\u589E\u52A0\u4E86 Exchange \u548C Binding \u7684\u89D2\u8272\u3002\u751F\u4EA7\u8005\u628A\u6D88\u606F\u53D1\u5E03\u5230 Exchange \u4E0A\uFF0C\u6D88\u606F\u6700\u7EC8\u5230\u8FBE\u961F\u5217\u5E76\u88AB\u6D88\u8D39\u8005\u63A5\u6536\uFF0C\u800C Binding \u51B3\u5B9A\u4EA4\u6362\u5668\u7684\u6D88\u606F\u5E94\u8BE5\u53D1\u9001\u5230\u90A3\u4E2A\u961F\u5217</p><p><img src="'+v+'" alt="img"></p></blockquote><h4 id="exchange\u7C7B\u578B"><a class="header-anchor" href="#exchange\u7C7B\u578B" aria-hidden="true">#</a> exchange\u7C7B\u578B</h4><p>Exchange\u5206\u53D1\u6D88\u606F\u65F6\u6839\u636E\u7C7B\u578B\u7684\u4E0D\u540C\u5206\u53D1\u7B56\u7565\u6709\u533A\u522B\uFF0C\u76EE\u524D\u5171\u56DB\u79CD\u7C7B\u578B\uFF1Adirect\u3001fanout\u3001topic\u3001headers \u3002headers \u5339\u914D AMQP \u6D88\u606F\u7684 header \u800C\u4E0D\u662F\u8DEF\u7531\u952E\uFF0C\u6B64\u5916 headers \u4EA4\u6362\u5668\u548C direct \u4EA4\u6362\u5668\u5B8C\u5168\u4E00\u81F4\uFF0C\u4F46\u6027\u80FD\u5DEE\u5F88\u591A\uFF0C\u76EE\u524D\u51E0\u4E4E\u7528\u4E0D\u5230\u4E86\uFF0C\u6240\u4EE5\u76F4\u63A5\u770B\u53E6\u5916\u4E09\u79CD\u7C7B\u578B\uFF1A</p><ol><li>direct \u76F4\u8FDE</li></ol><p><img src="'+g+'" alt="img"></p><p>\u6D88\u606F\u4E2D\u7684\u8DEF\u7531\u952E\uFF08routing key\uFF09\u5982\u679C\u548C Binding \u4E2D\u7684 binding key \u4E00\u81F4\uFF0C \u4EA4\u6362\u5668\u5C31\u5C06\u6D88\u606F\u53D1\u5230\u5BF9\u5E94\u7684\u961F\u5217\u4E2D\u3002\u8DEF\u7531\u952E\u4E0E\u961F\u5217\u540D\u5B8C\u5168\u5339\u914D\uFF0C\u5982\u679C\u4E00\u4E2A\u961F\u5217\u7ED1\u5B9A\u5230\u4EA4\u6362\u673A\u8981\u6C42\u8DEF\u7531\u952E\u4E3A\u201Cdog\u201D\uFF0C\u5219\u53EA\u8F6C\u53D1 routing key \u6807\u8BB0\u4E3A\u201Cdog\u201D\u7684\u6D88\u606F\uFF0C\u4E0D\u4F1A\u8F6C\u53D1\u201Cdog.puppy\u201D\uFF0C\u4E5F\u4E0D\u4F1A\u8F6C\u53D1\u201Cdog.guard\u201D\u7B49\u7B49\u3002\u5B83\u662F\u5B8C\u5168\u5339\u914D\u3001\u5355\u64AD\u7684\u6A21\u5F0F</p><ol start="2"><li>fanout \u6247\u51FA</li></ol><p><img src="'+h+'" alt="img"></p><p>\u6BCF\u4E2A\u53D1\u5230 fanout \u7C7B\u578B\u4EA4\u6362\u5668\u7684\u6D88\u606F\u90FD\u4F1A\u5206\u5230\u6240\u6709\u7ED1\u5B9A\u7684\u961F\u5217\u4E0A\u53BB\u3002fanout \u4EA4\u6362\u5668\u4E0D\u5904\u7406\u8DEF\u7531\u952E\uFF0C\u53EA\u662F\u7B80\u5355\u7684\u5C06\u961F\u5217\u7ED1\u5B9A\u5230\u4EA4\u6362\u5668\u4E0A\uFF0C\u6BCF\u4E2A\u53D1\u9001\u5230\u4EA4\u6362\u5668\u7684\u6D88\u606F\u90FD\u4F1A\u88AB\u8F6C\u53D1\u5230\u4E0E\u8BE5\u4EA4\u6362\u5668\u7ED1\u5B9A\u7684\u6240\u6709\u961F\u5217\u4E0A\u3002\u5F88\u50CF\u5B50\u7F51\u5E7F\u64AD\uFF0C\u6BCF\u53F0\u5B50\u7F51\u5185\u7684\u4E3B\u673A\u90FD\u83B7\u5F97\u4E86\u4E00\u4EFD\u590D\u5236\u7684\u6D88\u606F\u3002fanout \u7C7B\u578B\u8F6C\u53D1\u6D88\u606F\u662F\u6700\u5FEB\u7684</p><ol start="3"><li>topic \u62D3\u6251</li></ol><p><img src="'+q+'" alt="img"></p><p>topic \u4EA4\u6362\u5668\u901A\u8FC7\u6A21\u5F0F\u5339\u914D\u5206\u914D\u6D88\u606F\u7684\u8DEF\u7531\u952E\u5C5E\u6027\uFF0C\u5C06\u8DEF\u7531\u952E\u548C\u67D0\u4E2A\u6A21\u5F0F\u8FDB\u884C\u5339\u914D\uFF0C\u6B64\u65F6\u961F\u5217\u9700\u8981\u7ED1\u5B9A\u5230\u4E00\u4E2A\u6A21\u5F0F\u4E0A\u3002\u5B83\u5C06\u8DEF\u7531\u952E\u548C\u7ED1\u5B9A\u952E\u7684\u5B57\u7B26\u4E32\u5207\u5206\u6210\u5355\u8BCD\uFF0C\u8FD9\u4E9B\u5355\u8BCD\u4E4B\u95F4\u7528\u70B9\u9694\u5F00\u3002\u5B83\u540C\u6837\u4E5F\u4F1A\u8BC6\u522B\u4E24\u4E2A\u901A\u914D\u7B26\uFF1A\u7B26\u53F7\u201C#\u201D\u548C\u7B26\u53F7\u201C*\u201D\u3002#\u5339\u914D0\u4E2A\u6216\u591A\u4E2A\u5355\u8BCD\uFF0C*\u5339\u914D\u4E0D\u591A\u4E0D\u5C11\u4E00\u4E2A\u5355\u8BCD</p><p>\u8FD9\u4E9B\u8DEF\u7531\u952E\u53EF\u4EE5\u5305\u542B\u5F88\u591A\u5355\u8BCD\uFF0C\u4F46\u8DEF\u7531\u952E\u603B\u957F\u5EA6\u4E0D\u80FD\u8D85\u8FC7255\u4E2A\u5B57\u8282</p><h4 id="virtual-host"><a class="header-anchor" href="#virtual-host" aria-hidden="true">#</a> virtual host</h4><p>\u53EF\u4EE5\u901A\u8FC7MySQL\u548CMySQL\u4E2D\u7684\u6570\u636E\u5E93\u6765\u7406\u89E3RabbitMQ\u548Cvirtual host\u7684\u5173\u7CFB</p><p>MySQL\u5927\u5BB6\u90FD\u4E0D\u964C\u751F\uFF0C\u7ECF\u5E38\u4F1A\u51FA\u73B0\u591A\u4E2A\u4E1A\u52A1\u7EBF\u6DF7\u7528\u4E00\u4E2AMySQL\u6570\u636E\u5E93\u7684\u60C5\u51B5\uFF0C\u5C31\u50CF\u4E0B\u56FE\u8FD9\u6837\uFF0C\u6BCF\u4E2A\u4E1A\u52A1\u7EBF\u90FD\u5728MySQL\u4E2D\u521B\u5EFA\u81EA\u5DF1\u7684\u6570\u636E\u5E93\uFF0C\u4F7F\u7528\u65F6\u5404\u81EA\u5F80\u5404\u81EA\u7684\u6570\u636E\u5E93\u4E2D\u5B58\u50A8\u6570\u636E\uFF0C\u5F7C\u6B64\u76F8\u4E92\u4E0D\u5E72\u6D89</p><p><img src="'+f+'" alt="img"></p><p>RabbitMQ\u548Cvirtual host\u7684\u5173\u7CFB\u4E5F\u5DEE\u4E0D\u591A\uFF0C\u53EF\u4EE5\u8BA9\u591A\u4E2A\u4E1A\u52A1\u7EBF\u540C\u65F6\u4F7F\u7528\u4E00\u4E2ARabbitMQ\uFF0C\u53EA\u8981\u4E3A\u4E1A\u52A1\u7EBF\u5404\u4E2A\u4E1A\u52A1\u7EBF\u7ED1\u5B9A\u4E0A\u4E0D\u540C\u7684virtual host\u5373\u53EF</p><p><img src="'+y+'" alt="img"></p><h5 id="\u521B\u5EFAvirtual-host\u5E76\u6307\u5B9A\u7528\u6237\u53EF\u4EE5\u4F7F\u7528\u5B83"><a class="header-anchor" href="#\u521B\u5EFAvirtual-host\u5E76\u6307\u5B9A\u7528\u6237\u53EF\u4EE5\u4F7F\u7528\u5B83" aria-hidden="true">#</a> \u521B\u5EFAvirtual host\u5E76\u6307\u5B9A\u7528\u6237\u53EF\u4EE5\u4F7F\u7528\u5B83</h5><p><img src="'+w+'" alt="img"></p><p><img src="'+_+'" alt="img"></p><p><img src="'+x+'" alt="img"></p><p><img src="'+C+'" alt="img"></p><h2 id="\u5B89\u88C5"><a class="header-anchor" href="#\u5B89\u88C5" aria-hidden="true">#</a> \u5B89\u88C5</h2><h3 id="\u5B98\u7F51\u4E0B\u8F7D"><a class="header-anchor" href="#\u5B98\u7F51\u4E0B\u8F7D" aria-hidden="true">#</a> \u5B98\u7F51\u4E0B\u8F7D</h3><blockquote><p>\u5B98\u7F51\u4E0B\u8F7D\u5730\u5740\uFF1Ahttps://www.rabbitmq.com/download.html</p></blockquote><p>\u56E0\u4E3Arabbitmq\u662F\u4F7F\u7528erlang\u8BED\u8A00\u5F00\u53D1\u7684\uFF0C\u6240\u6709\u9664\u4E86\u9700\u8981\u5B89\u88C5rabbitmq\u7684\u5B89\u88C5\u5305\u4E4B\u5916\uFF0C\u8FD8\u9700\u8981\u4E0B\u8F7Derlang\u7684\u4F9D\u8D56</p><p><img src="'+M+`" alt="image-20211209022116979"></p><h3 id="mac\u4E0B\u5B89\u88C5"><a class="header-anchor" href="#mac\u4E0B\u5B89\u88C5" aria-hidden="true">#</a> mac\u4E0B\u5B89\u88C5</h3><ol><li>\u66F4\u65B0brew</li></ol><p>\u4F7F\u7528 HomeBrew \u6765\u5B89\u88C5\uFF0C\u5B89\u88C5\u524D\u8981\u5148\u66F4\u65B0 brew</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>brew update
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="2"><li>\u5B89\u88C5rabbitmq</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">(</span>base<span class="token punctuation">)</span> aldencarter@aldencarter ~ % brew <span class="token function">install</span> <span class="token number">11</span>.rabbitmq
Running <span class="token variable"><span class="token variable">\`</span>brew update --preinstall<span class="token variable">\`</span></span><span class="token punctuation">..</span>.
<span class="token operator">==</span><span class="token operator">&gt;</span> Downloading https://mirrors.ustc.edu.cn/homebrew-bottles/wxwidgets-3.1.5.big_sur.bottle.tar.gz
<span class="token comment">######################################################################### 100.0%</span>
<span class="token operator">==</span><span class="token operator">&gt;</span> Downloading https://mirrors.ustc.edu.cn/homebrew-bottles/erlang-24.1.7.big_sur.bottle.tar.gz
<span class="token comment">######################################################################### 100.0%</span>
<span class="token operator">==</span><span class="token operator">&gt;</span> Downloading https://mirrors.ustc.edu.cn/homebrew-bottles/11.rabbitmq-3.9.11.all.bottle.tar.gz
<span class="token comment">######################################################################### 100.0%</span>
<span class="token operator">==</span><span class="token operator">&gt;</span> Installing dependencies <span class="token keyword">for</span> <span class="token number">11</span>.rabbitmq: wxwidgets and erlang
<span class="token operator">==</span><span class="token operator">&gt;</span> Installing <span class="token number">11</span>.rabbitmq dependency: wxwidgets
<span class="token operator">==</span><span class="token operator">&gt;</span> Pouring wxwidgets-3.1.5.big_sur.bottle.tar.gz
\u{1F37A}  /usr/local/Cellar/wxwidgets/3.1.5: <span class="token number">828</span> files, <span class="token number">24</span>.7MB
<span class="token operator">==</span><span class="token operator">&gt;</span> Installing <span class="token number">11</span>.rabbitmq dependency: erlang
<span class="token operator">==</span><span class="token operator">&gt;</span> Pouring erlang-24.1.7.big_sur.bottle.tar.gz
\u{1F37A}  /usr/local/Cellar/erlang/24.1.7: <span class="token number">7,145</span> files, <span class="token number">483</span>.5MB
<span class="token operator">==</span><span class="token operator">&gt;</span> Installing <span class="token number">11</span>.rabbitmq
<span class="token operator">==</span><span class="token operator">&gt;</span> Pouring <span class="token number">11</span>.rabbitmq-3.9.11.all.bottle.tar.gz
<span class="token operator">==</span><span class="token operator">&gt;</span> Caveats
Management Plugin enabled by default at http://localhost:15672

To restart <span class="token number">11</span>.rabbitmq after an upgrade:
  brew services restart <span class="token number">11</span>.rabbitmq
Or, <span class="token keyword">if</span> you don<span class="token string">&#39;t want/need a background service you can just run:
  CONF_ENV_FILE=&quot;/usr/local/etc/11.rabbitmq/11.rabbitmq-env.conf&quot; /usr/local/opt/11.rabbitmq/sbin/11.rabbitmq-server
==&gt; Summary
\u{1F37A}  /usr/local/Cellar/11.rabbitmq/3.9.11: 1,382 files, 29.8MB
==&gt; Running \`brew cleanup 11.rabbitmq\`...
Disable this behaviour by setting HOMEBREW_NO_INSTALL_CLEANUP.
Hide these hints with HOMEBREW_NO_ENV_HINTS (see \`man brew\`).
==&gt; Caveats
==&gt; 11.rabbitmq
Management Plugin enabled by default at http://localhost:15672

To restart 11.rabbitmq after an upgrade:
  brew services restart 11.rabbitmq
Or, if you don&#39;</span>t want/need a background <span class="token function">service</span> you can just run:
  <span class="token assign-left variable">CONF_ENV_FILE</span><span class="token operator">=</span><span class="token string">&quot;/usr/local/etc/rabbitmq/rabbitmq-env.conf&quot;</span> /usr/local/opt/11.rabbitmq/sbin/11.rabbitmq-server
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD9\u6837 RabbitMQ \u5C31\u5B89\u88C5\u597D\u4E86\uFF0C\u5B89\u88C5\u8FC7\u7A0B\u4E2D\u4F1A\u81EA\u52A8\u5176\u6240\u4F9D\u8D56\u7684 Erlang\uFF0C\u901A\u8FC7\u4E0A\u9762\u7684\u4E00\u4E9B\u8F93\u51FA\u4FE1\u606F\u6211\u4EEC\u53EF\u4EE5\u77E5\u9053\uFF1A</p><ul><li><p>erlang\u5B89\u88C5\u76EE\u5F55\uFF1A<code>/usr/local/Cellar/erlang/24.1.7</code></p></li><li><p>rabbitmq\u5B89\u88C5\u76EE\u5F55\uFF1A<code>/usr/local/Cellar/rabbitmq/3.9.11</code></p></li><li><p>To restart rabbitmq after an upgrade\uFF1A<code>brew services restart rabbitmq</code></p></li><li><p>\u6D4F\u89C8\u5668\u8BBF\u95EE\u8FDE\u63A5\uFF1Ahttp://localhost:15672</p></li></ul><ol start="3"><li>\u6D4B\u8BD5\u8FD0\u884C</li></ol><p>\u901A\u8FC7\u4E0A\u9762\u5B89\u88C5\u7684\u63D0\u793A\uFF0C\u6211\u4EEC\u53EF\u4EE5\u77E5\u9053\u5B83\u5B89\u88C5\u5728\u4E86<code>/usr/local/Cellar/rabbitmq/3.9.11</code>\uFF0C\u6240\u4EE5\u6211\u4EEC\u8FDB\u5165\u8FD9\u4E2A\u76EE\u5F55\uFF0C\u542F\u52A8rabbitmq</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">(</span>base<span class="token punctuation">)</span> aldencarter@aldencarter sbin % <span class="token builtin class-name">pwd</span>
/usr/local/Cellar/11.rabbitmq/3.9.11/sbin
<span class="token punctuation">(</span>base<span class="token punctuation">)</span> aldencarter@aldencarter sbin % ll
total <span class="token number">184</span>
drwxr-xr-x  <span class="token number">13</span> aldencarter  admin    <span class="token number">416</span> <span class="token number">12</span>  <span class="token number">9</span> <span class="token number">13</span>:59 ./
drwxr-xr-x  <span class="token number">36</span> aldencarter  admin   <span class="token number">1152</span> <span class="token number">12</span>  <span class="token number">9</span> <span class="token number">13</span>:59 <span class="token punctuation">..</span>/
-r-xr-xr-x   <span class="token number">1</span> aldencarter  admin    <span class="token number">678</span> <span class="token number">12</span>  <span class="token number">9</span> <span class="token number">13</span>:59 <span class="token number">11</span>.rabbitmq-defaults*
-r-xr-xr-x   <span class="token number">1</span> aldencarter  admin    <span class="token number">864</span> <span class="token number">12</span>  <span class="token number">2</span> <span class="token number">15</span>:12 <span class="token number">11</span>.rabbitmq-diagnostics*
-r-xr-xr-x   <span class="token number">1</span> aldencarter  admin   <span class="token number">6874</span> <span class="token number">12</span>  <span class="token number">9</span> <span class="token number">13</span>:59 <span class="token number">11</span>.rabbitmq-env*
-r-xr-xr-x   <span class="token number">1</span> aldencarter  admin    <span class="token number">860</span> <span class="token number">12</span>  <span class="token number">2</span> <span class="token number">15</span>:12 <span class="token number">11</span>.rabbitmq-plugins*
-r-xr-xr-x   <span class="token number">1</span> aldencarter  admin    <span class="token number">859</span> <span class="token number">12</span>  <span class="token number">2</span> <span class="token number">15</span>:12 <span class="token number">11</span>.rabbitmq-queues*
-r-xr-xr-x   <span class="token number">1</span> aldencarter  admin   <span class="token number">6002</span> <span class="token number">12</span>  <span class="token number">2</span> <span class="token number">15</span>:12 <span class="token number">11</span>.rabbitmq-server*
-r-xr-xr-x   <span class="token number">1</span> aldencarter  admin    <span class="token number">857</span> <span class="token number">12</span>  <span class="token number">2</span> <span class="token number">15</span>:12 <span class="token number">11</span>.rabbitmq-streams*
-r-xr-xr-x   <span class="token number">1</span> aldencarter  admin    <span class="token number">858</span> <span class="token number">12</span>  <span class="token number">2</span> <span class="token number">15</span>:12 <span class="token number">11</span>.rabbitmq-tanzu*
-r-xr-xr-x   <span class="token number">1</span> aldencarter  admin    <span class="token number">860</span> <span class="token number">12</span>  <span class="token number">2</span> <span class="token number">15</span>:12 <span class="token number">11</span>.rabbitmq-upgrade*
-r-xr-xr-x   <span class="token number">1</span> aldencarter  admin  <span class="token number">42225</span> <span class="token number">12</span>  <span class="token number">2</span> <span class="token number">15</span>:12 rabbitmqadmin*
-r-xr-xr-x   <span class="token number">1</span> aldencarter  admin    <span class="token number">855</span> <span class="token number">12</span>  <span class="token number">2</span> <span class="token number">15</span>:12 rabbitmqctl*
<span class="token punctuation">(</span>base<span class="token punctuation">)</span> aldencarter@aldencarter sbin % .11.rabbitmq-server*
zsh: no matches found: .11.rabbitmq-server*
<span class="token punctuation">(</span>base<span class="token punctuation">)</span> aldencarter@aldencarter sbin % ./11.rabbitmq-server*
<span class="token number">2021</span>-12-09 <span class="token number">14</span>:12:59.772865+08:00 <span class="token punctuation">[</span>info<span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token number">0.221</span>.<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> Feature flags: list of feature flags found:
<span class="token number">2021</span>-12-09 <span class="token number">14</span>:12:59.785462+08:00 <span class="token punctuation">[</span>info<span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token number">0.221</span>.<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> Feature flags:   <span class="token punctuation">[</span> <span class="token punctuation">]</span> implicit_default_bindings
<span class="token number">2021</span>-12-09 <span class="token number">14</span>:12:59.785489+08:00 <span class="token punctuation">[</span>info<span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token number">0.221</span>.<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> Feature flags:   <span class="token punctuation">[</span> <span class="token punctuation">]</span> maintenance_mode_status
<span class="token number">2021</span>-12-09 <span class="token number">14</span>:12:59.785502+08:00 <span class="token punctuation">[</span>info<span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token number">0.221</span>.<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> Feature flags:   <span class="token punctuation">[</span> <span class="token punctuation">]</span> quorum_queue
<span class="token number">2021</span>-12-09 <span class="token number">14</span>:12:59.785518+08:00 <span class="token punctuation">[</span>info<span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token number">0.221</span>.<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> Feature flags:   <span class="token punctuation">[</span> <span class="token punctuation">]</span> stream_queue
<span class="token number">2021</span>-12-09 <span class="token number">14</span>:12:59.785563+08:00 <span class="token punctuation">[</span>info<span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token number">0.221</span>.<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> Feature flags:   <span class="token punctuation">[</span> <span class="token punctuation">]</span> user_limits
<span class="token number">2021</span>-12-09 <span class="token number">14</span>:12:59.785574+08:00 <span class="token punctuation">[</span>info<span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token number">0.221</span>.<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> Feature flags:   <span class="token punctuation">[</span> <span class="token punctuation">]</span> virtual_host_metadata
<span class="token number">2021</span>-12-09 <span class="token number">14</span>:12:59.785586+08:00 <span class="token punctuation">[</span>info<span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token number">0.221</span>.<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> Feature flags: feature flag states written to disk: <span class="token function">yes</span>
<span class="token number">2021</span>-12-09 <span class="token number">14</span>:13:00.168756+08:00 <span class="token punctuation">[</span>noti<span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token number">0.44</span>.<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> Application syslog exited with reason: stopped
<span class="token number">2021</span>-12-09 <span class="token number">14</span>:13:00.168812+08:00 <span class="token punctuation">[</span>noti<span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token number">0.221</span>.<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> Logging: switching to configured handler<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span> following messages may not be visible <span class="token keyword">in</span> this log output

  <span class="token comment">###  ###      RabbitMQ 3.9.11</span>
  <span class="token comment">###  ##</span>
  <span class="token comment">###########  Copyright (c) 2007-2021 VMware, Inc. or its affiliates.</span>
  <span class="token comment">#######  ##</span>
  <span class="token comment">###########  Licensed under the MPL 2.0. Website: https://rabbitmq.com</span>

  Erlang:      <span class="token number">24.1</span>.7 <span class="token punctuation">[</span>jit<span class="token punctuation">]</span>
  TLS Library: OpenSSL - OpenSSL <span class="token number">1.1</span>.1l  <span class="token number">24</span> Aug <span class="token number">2021</span>

  Doc guides:  https://rabbitmq.com/documentation.html
  Support:     https://rabbitmq.com/contact.html
  Tutorials:   https://rabbitmq.com/getstarted.html
  Monitoring:  https://rabbitmq.com/monitoring.html

  Logs: /usr/local/var/log/11.rabbitmq/rabbit@localhost.log
        /usr/local/var/log/11.rabbitmq/rabbit@localhost_upgrade.log
        <span class="token operator">&lt;</span>stdout<span class="token operator">&gt;</span>

  Config file<span class="token punctuation">(</span>s<span class="token punctuation">)</span>: <span class="token punctuation">(</span>none<span class="token punctuation">)</span>

  Starting broker<span class="token punctuation">..</span>. completed with <span class="token number">7</span> plugins.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5982\u679C\u60F3\u8981\u7A0B\u5E8F\u5728\u540E\u53F0\u542F\u52A8\uFF0C\u53EF\u4EE5\u6DFB\u52A0<code>-detached</code>\u53C2\u6570</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>.11.rabbitmq-server* -detached
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u6B64\u65F6\u6211\u4EEC\u901A\u8FC7\u6D4F\u89C8\u5668\u8BBF\u95EE<code>http://localhost:15672/</code>\uFF0C\u8F93\u5165\u521D\u59CB\u8D26\u53F7guest\u548C\u521D\u59CB\u5BC6\u7801guest\uFF0C\u5C31\u53EF\u4EE5\u770B\u5230rabbitmq\u7684\u540E\u53F0\u7BA1\u7406\u754C\u9762</p><p><img src="`+S+`" alt="image-20211209142312115"></p><ol start="4"><li>\u67E5\u770B\u8FD0\u884C\u4FE1\u606F</li></ol><p>\u8BE5\u547D\u4EE4\u5C06\u8F93\u51FA\u670D\u52A1\u5668\u7684\u5F88\u591A\u4FE1\u606F\uFF0C\u6BD4\u5982 RabbitMQ \u548C Erlang \u7684\u7248\u672C\u3001OS \u540D\u79F0\u3001\u5185\u5B58\u7B49\u7B49</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">(</span>base<span class="token punctuation">)</span> aldencarter@aldencarter sbin % ./rabbitmqctl status 
Status of <span class="token function">node</span> rabbit@localhost <span class="token punctuation">..</span>.
Runtime

OS PID: <span class="token number">89583</span>
OS: macOS
Uptime <span class="token punctuation">(</span>seconds<span class="token punctuation">)</span>: <span class="token number">176</span>
Is under maintenance?: <span class="token boolean">false</span>
RabbitMQ version: <span class="token number">3.9</span>.11
Node name: rabbit@localhost
Erlang configuration: Erlang/OTP <span class="token number">24</span> <span class="token punctuation">[</span>erts-12.1.5<span class="token punctuation">]</span> <span class="token punctuation">[</span>source<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">64</span>-bit<span class="token punctuation">]</span> <span class="token punctuation">[</span>smp:16:16<span class="token punctuation">]</span> <span class="token punctuation">[</span>ds:16:16:10<span class="token punctuation">]</span> <span class="token punctuation">[</span>async-threads:1<span class="token punctuation">]</span> <span class="token punctuation">[</span>jit<span class="token punctuation">]</span> <span class="token punctuation">[</span>dtrace<span class="token punctuation">]</span>
Erlang processes: <span class="token number">453</span> used, <span class="token number">1048576</span> limit
Scheduler run queue: <span class="token number">1</span>
Cluster heartbeat <span class="token function">timeout</span> <span class="token punctuation">(</span>net_ticktime<span class="token punctuation">)</span>: <span class="token number">60</span>

Plugins

Enabled plugin file: /usr/local/etc/11.rabbitmq/enabled_plugins
Enabled plugins:

 * rabbitmq_stomp
 * rabbitmq_mqtt
 * rabbitmq_stream
 * rabbitmq_stream_common
 * rabbitmq_amqp1_0
 * rabbitmq_management
 * amqp_client
 * rabbitmq_web_dispatch
 * cowboy
 * cowlib
 * rabbitmq_management_agent

Data directory

Node data directory: /usr/local/var/lib/11.rabbitmq/mnesia/rabbit@localhost
Raft data directory: /usr/local/var/lib/11.rabbitmq/mnesia/rabbit@localhost/quorum/rabbit@localhost

Config files


Log file<span class="token punctuation">(</span>s<span class="token punctuation">)</span>

 * /usr/local/var/log/11.rabbitmq/rabbit@localhost.log
 * /usr/local/var/log/11.rabbitmq/rabbit@localhost_upgrade.log
 * <span class="token operator">&lt;</span>stdout<span class="token operator">&gt;</span>

Alarms

<span class="token punctuation">(</span>none<span class="token punctuation">)</span>

Memory

Total memory used: <span class="token number">0.1521</span> gb
Calculation strategy: rss
Memory high watermark setting: <span class="token number">0.4</span> of available memory, computed to: <span class="token number">13.7439</span> gb

reserved_unallocated: <span class="token number">0.0732</span> gb <span class="token punctuation">(</span><span class="token number">48.17</span> %<span class="token punctuation">)</span>
code: <span class="token number">0.0354</span> gb <span class="token punctuation">(</span><span class="token number">23.29</span> %<span class="token punctuation">)</span>
other_system: <span class="token number">0.0214</span> gb <span class="token punctuation">(</span><span class="token number">14.07</span> %<span class="token punctuation">)</span>
other_proc: <span class="token number">0.0195</span> gb <span class="token punctuation">(</span><span class="token number">12.83</span> %<span class="token punctuation">)</span>
other_ets: <span class="token number">0.0037</span> gb <span class="token punctuation">(</span><span class="token number">2.41</span> %<span class="token punctuation">)</span>
plugins: <span class="token number">0.0026</span> gb <span class="token punctuation">(</span><span class="token number">1.7</span> %<span class="token punctuation">)</span>
atom: <span class="token number">0.0014</span> gb <span class="token punctuation">(</span><span class="token number">0.94</span> %<span class="token punctuation">)</span>
metrics: <span class="token number">2</span>.0e-4 gb <span class="token punctuation">(</span><span class="token number">0.15</span> %<span class="token punctuation">)</span>
mgmt_db: <span class="token number">2</span>.0e-4 gb <span class="token punctuation">(</span><span class="token number">0.13</span> %<span class="token punctuation">)</span>
binary: <span class="token number">1</span>.0e-4 gb <span class="token punctuation">(</span><span class="token number">0.06</span> %<span class="token punctuation">)</span>
mnesia: <span class="token number">1</span>.0e-4 gb <span class="token punctuation">(</span><span class="token number">0.06</span> %<span class="token punctuation">)</span>
quorum_ets: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.02</span> %<span class="token punctuation">)</span>
msg_index: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.02</span> %<span class="token punctuation">)</span>
connection_other: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
stream_queue_procs: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
stream_queue_replica_reader_procs: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
allocated_unused: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
connection_channels: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
connection_readers: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
connection_writers: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
queue_procs: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
queue_slave_procs: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
quorum_queue_procs: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
stream_queue_coordinator_procs: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>

File Descriptors

Total: <span class="token number">2</span>, limit: <span class="token number">159</span>
Sockets: <span class="token number">0</span>, limit: <span class="token number">141</span>

Free Disk Space

Low <span class="token function">free</span> disk space watermark: <span class="token number">0.05</span> gb
Free disk space: <span class="token number">956.6264</span> gb

Totals

Connection count: <span class="token number">0</span>
Queue count: <span class="token number">0</span>
Virtual <span class="token function">host</span> count: <span class="token number">1</span>

Listeners

Interface: <span class="token punctuation">[</span>::<span class="token punctuation">]</span>, port: <span class="token number">15672</span>, protocol: http, purpose: HTTP API
Interface: <span class="token punctuation">[</span>::<span class="token punctuation">]</span>, port: <span class="token number">5552</span>, protocol: stream, purpose: stream
Interface: <span class="token punctuation">[</span>::<span class="token punctuation">]</span>, port: <span class="token number">1883</span>, protocol: mqtt, purpose: MQTT
Interface: <span class="token punctuation">[</span>::<span class="token punctuation">]</span>, port: <span class="token number">61613</span>, protocol: stomp, purpose: STOMP
Interface: <span class="token punctuation">[</span>::<span class="token punctuation">]</span>, port: <span class="token number">25672</span>, protocol: clustering, purpose: inter-node and CLI tool communication
Interface: <span class="token number">127.0</span>.0.1, port: <span class="token number">5672</span>, protocol: amqp, purpose: AMQP <span class="token number">0</span>-9-1 and AMQP <span class="token number">1.0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="5"><li>\u5173\u95EDrabbitmq\u8282\u70B9</li></ol><p>\u6211\u4EEC\u77E5\u9053 RabbitMQ \u662F\u7528 Erlang \u8BED\u8A00\u5199\u7684\uFF0C\u5728Erlang \u4E2D\u6709\u4E24\u4E2A\u6982\u5FF5\uFF1A\u8282\u70B9\u548C\u5E94\u7528\u7A0B\u5E8F\u3002\u8282\u70B9\u5C31\u662F Erlang \u865A\u62DF\u673A\u7684\u6BCF\u4E2A\u5B9E\u4F8B\uFF0C\u800C\u591A\u4E2A Erlang \u5E94\u7528\u7A0B\u5E8F\u53EF\u4EE5\u8FD0\u884C\u5728\u540C\u4E00\u4E2A\u8282\u70B9\u4E4B\u4E0A\u3002\u8282\u70B9\u4E4B\u95F4\u53EF\u4EE5\u8FDB\u884C\u672C\u5730\u901A\u4FE1\uFF08\u4E0D\u7BA1\u4ED6\u4EEC\u662F\u4E0D\u662F\u8FD0\u884C\u5728\u540C\u4E00\u53F0\u670D\u52A1\u5668\u4E4B\u4E0A\uFF09\u3002\u6BD4\u5982\u4E00\u4E2A\u8FD0\u884C\u5728\u8282\u70B9A\u4E0A\u7684\u5E94\u7528\u7A0B\u5E8F\u53EF\u4EE5\u8C03\u7528\u8282\u70B9B\u4E0A\u5E94\u7528\u7A0B\u5E8F\u7684\u65B9\u6CD5\uFF0C\u5C31\u597D\u50CF\u8C03\u7528\u672C\u5730\u51FD\u6570\u4E00\u6837\u3002\u5982\u679C\u5E94\u7528\u7A0B\u5E8F\u7531\u4E8E\u67D0\u4E9B\u539F\u56E0\u5954\u6E83\uFF0CErlang \u8282\u70B9\u4F1A\u81EA\u52A8\u5C1D\u8BD5\u91CD\u542F\u5E94\u7528\u7A0B\u5E8F\u3002 \u5982\u679C\u8981\u5173\u95ED\u6574\u4E2A RabbitMQ \u8282\u70B9\u53EF\u4EE5\u7528\u53C2\u6570 stop</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">(</span>base<span class="token punctuation">)</span> aldencarter@aldencarter sbin % rabbitmqctl stop
Stopping and halting <span class="token function">node</span> rabbit@localhost <span class="token punctuation">..</span>.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5B83\u4F1A\u548C\u672C\u5730\u8282\u70B9\u901A\u4FE1\u5E76\u6307\u793A\u5176\u5E72\u51C0\u7684\u5173\u95ED\uFF0C\u4E5F\u53EF\u4EE5\u6307\u5B9A\u5173\u95ED\u4E0D\u540C\u7684\u8282\u70B9\uFF0C\u5305\u62EC\u8FDC\u7A0B\u8282\u70B9\uFF0C\u53EA\u9700\u8981\u4F20\u5165\u53C2\u6570 -n \uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>rabbitmqctl -n rabbit@server.example.com stop
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,123),En=s("-n node \u9ED8\u8BA4 node \u540D\u79F0\u662F rabbit@server \uFF0C\u5982\u679C\u4F60\u7684\u4E3B\u673A\u540D\u662F "),Pn={href:"https://link.jianshu.com?t=http://server.example.com",target:"_blank",rel:"noopener noreferrer"},An=s("server.example.com"),Tn=s(" \uFF0C\u90A3\u4E48 node \u540D\u79F0\u5C31\u662F "),In={href:"https://link.jianshu.com?t=mailto:rabbit@server.example.com",target:"_blank",rel:"noopener noreferrer"},jn=s("rabbit@server.example.com"),Dn=s(" \u3002"),On=a(`<ol start="6"><li>\u5173\u95ED RabbitMQ \u5E94\u7528\u7A0B\u5E8F</li></ol><p>\u5982\u679C\u53EA\u60F3\u5173\u95ED\u5E94\u7528\u7A0B\u5E8F\uFF0C\u540C\u65F6\u4FDD\u6301 Erlang \u8282\u70B9\u8FD0\u884C\u5219\u53EF\u4EE5\u7528 stop_app\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>rabbitmqctl stop_app
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="7"><li>\u542F\u52A8rabbitmq\u5E94\u7528\u7A0B\u5E8F</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>rabbitmqctl start_app
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="8"><li>\u91CD\u7F6E RabbitMQ \u8282\u70B9</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>rabbitmqctl reset
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u8BE5\u547D\u4EE4\u5C06\u6E05\u9664\u6240\u6709\u7684\u961F\u5217</p><ol start="9"><li>\u67E5\u770B\u5DF2\u58F0\u660E\u7684\u961F\u5217</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>rabbitmqctl list_queues
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="10"><li>\u67E5\u770B\u4EA4\u6362\u5668</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>rabbitmqctl list_exchanges
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u8BE5\u547D\u4EE4\u8FD8\u53EF\u4EE5\u9644\u52A0\u53C2\u6570\uFF0C\u6BD4\u5982\u5217\u51FA\u4EA4\u6362\u5668\u7684\u540D\u79F0\u3001\u7C7B\u578B\u3001\u662F\u5426\u6301\u4E45\u5316\u3001\u662F\u5426\u81EA\u52A8\u5220\u9664\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>rabbitmqctl list_exchanges name <span class="token builtin class-name">type</span> durable auto_delete
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="11"><li>\u67E5\u770B\u7ED1\u5B9A</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>rabbitmqctl list_bindings
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="linux\u4E0B\u5B89\u88C5"><a class="header-anchor" href="#linux\u4E0B\u5B89\u88C5" aria-hidden="true">#</a> linux\u4E0B\u5B89\u88C5</h3><p>\u56E0\u4E3Arabbitmq\u4F9D\u8D56\u4E8Eerlang\u73AF\u5883\uFF0C\u6240\u4EE5\u6211\u4EEC\u9700\u8981\u5148\u5B89\u88C5erlang\uFF0C\u7136\u540E\u5728\u5B89\u88C5rabbitmq</p><blockquote><p>\u53C2\u7167\u7F51\u5740\uFF1Ahttps://segmentfault.com/a/1190000021539070</p></blockquote><h4 id="\u5B89\u88C5erlang\u73AF\u5883-\u9700\u8981\u6839\u636Erabbitmq\u7684\u7248\u672C\u5BF9\u5E94"><a class="header-anchor" href="#\u5B89\u88C5erlang\u73AF\u5883-\u9700\u8981\u6839\u636Erabbitmq\u7684\u7248\u672C\u5BF9\u5E94" aria-hidden="true">#</a> \u5B89\u88C5erlang\u73AF\u5883(\u9700\u8981\u6839\u636Erabbitmq\u7684\u7248\u672C\u5BF9\u5E94)</h4><blockquote><p>\u6211\u540E\u9762\u5B89\u88C5\u7684rabbitmq\u7248\u672C\u9700\u8981\u7684erlang\u7248\u672C\u6BD4\u8FD9\u8FD9\u9AD8\uFF0C\u76F4\u63A5\u4F7F\u7528yum\u5B89\u88C5\u5C31\u597D</p></blockquote><ol><li>\u5B89\u88C5GCC GCC-C++ Openssl\u7B49\u6A21\u5757,\u5B89\u88C5\u8FC7\u5C31\u4E0D\u9700\u8981\u5B89\u88C5\u4E86</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>yum -y <span class="token function">install</span> <span class="token function">make</span> gcc gcc-c++ kernel-devel m4 ncurses-devel openssl-devel
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="2"><li>\u5B89\u88C5ncurses</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>yum -y <span class="token function">install</span> ncurses-devel
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="3"><li>\u5B89\u88C5erlang\u73AF\u5883</li></ol><p>wget\u4E0B\u8F7D\u901F\u5EA6\u592A\u6162\u4E86\uFF0C\u5728\u672C\u5730\u7535\u8111\u4E0B\u8F7D\u5728\u4E0A\u4F20\u4E0A\u53BB\uFF0C<strong>\u4FEE\u6539\u4E3A\u56FD\u5185\u6E90\u4E5F\u65E0\u6548</strong></p><p><img src="`+Q+`" alt="image-20211209150119715"></p><p>\u4E0A\u4F20\u5230opt\u76EE\u5F55\u4E0B</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">(</span>base<span class="token punctuation">)</span> aldencarter@aldencarter sbin % <span class="token function">scp</span> ~/Downloads/otp_src_22.0.tar.gz root@172.16.187.9:/opt/
root@172.16.187.9&#39;s password: 
otp_src_18.2.1.tar.gz                                                                 <span class="token number">100</span>%   65MB <span class="token number">132</span>.2MB/s   00:00
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u89E3\u538B\u5E76\u8FDB\u5165\u76EE\u5F55</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">tar</span> xvfz otp_src_22.0.tar.gz
<span class="token builtin class-name">cd</span> otp_src_18.2.1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6267\u884C\u914D\u7F6E\u5E76\u5B89\u88C5</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">## \u6267\u884C\u914D\u7F6E</span>
./configure
<span class="token comment">## \u5B89\u88C5\uFF0C\u8FD8\u6574\u633A\u4E45</span>
<span class="token function">make</span> <span class="token function">install</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li>\u9A8C\u8BC1erlang\u73AF\u5883\u5B89\u88C5\u5B8C\u6210</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost <span class="token number">22</span><span class="token punctuation">]</span><span class="token comment">## erl -v</span>
Erlang/OTP <span class="token number">22</span> <span class="token punctuation">[</span>erts-10.4<span class="token punctuation">]</span> <span class="token punctuation">[</span>source<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">64</span>-bit<span class="token punctuation">]</span> <span class="token punctuation">[</span>smp:2:2<span class="token punctuation">]</span> <span class="token punctuation">[</span>ds:2:2:10<span class="token punctuation">]</span> <span class="token punctuation">[</span>async-threads:1<span class="token punctuation">]</span> <span class="token punctuation">[</span>hipe<span class="token punctuation">]</span>

Eshell V10.4  <span class="token punctuation">(</span>abort with ^G<span class="token punctuation">)</span>
<span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="\u4FEE\u6539yum\u6E90\u4E3A\u56FD\u5185\u955C\u50CF"><a class="header-anchor" href="#\u4FEE\u6539yum\u6E90\u4E3A\u56FD\u5185\u955C\u50CF" aria-hidden="true">#</a> \u4FEE\u6539yum\u6E90\u4E3A\u56FD\u5185\u955C\u50CF</h5><p>\u5982\u679C\u4E0A\u9762\u4E0B\u8F7D\u592A\u6162\u4E86\uFF0C\u53EF\u4EE5\u66F4\u6539\u4E3A\u56FD\u5185\u955C\u50CF</p><ol><li>\u5B89\u88C5wget</li></ol><p><code>yum install -y wget</code></p><ol start="2"><li>\u5B8C\u4E8B\u524D\u90FD\u505A\u5907\u4EFD</li></ol><p><code>mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup</code></p><ol start="3"><li>\u4E0B\u8F7D\u963F\u91CC\u4E91\u955C\u50CF\u6587\u4EF6</li></ol><p><code>wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo</code></p><ol start="4"><li>\u6E05\u7406\u7F13\u5B58</li></ol><p><code>yum clean all</code></p><ol start="5"><li>\u751F\u6210\u7F13\u5B58</li></ol><p><code>yum makecache</code></p><ol start="6"><li>\u66F4\u65B0\u6700\u65B0\u6E90\u8BBE\u7F6E</li></ol><p><code>yum update -y</code></p><h4 id="\u5B89\u88C5rabbitmq"><a class="header-anchor" href="#\u5B89\u88C5rabbitmq" aria-hidden="true">#</a> \u5B89\u88C5rabbitmq</h4><blockquote><p>\u5B98\u65B9\u7684\u901A\u8FC7rpm\u5B89\u88C5\u6559\u7A0B\uFF1Ahttps://www.rabbitmq.com/install-rpm.html</p></blockquote><ol><li>\u5B89\u88C5rabbitmq\u7684\u4F9D\u8D56\u5305</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost etc<span class="token punctuation">]</span><span class="token comment">## yum install socat logrotate -y ## \u6211\u5DF2\u7ECF\u5B89\u88C5\u8FC7\u4E86\uFF0C\u6240\u4EE5\u65E0\u9700\u5904\u7406</span>
\u5DF2\u52A0\u8F7D\u63D2\u4EF6\uFF1Afastestmirror
Loading mirror speeds from cached hostfile
 * base: mirror.hostlink.com.hk
 * centos-sclo-rh: mirror.hostlink.com.hk
 * centos-sclo-sclo: mirror.hostlink.com.hk
 * extras: mirror.hostlink.com.hk
 * updates: mirror.hostlink.com.hk
\u8F6F\u4EF6\u5305 socat-1.7.3.2-2.el7.x86_64 \u5DF2\u5B89\u88C5\u5E76\u4E14\u662F\u6700\u65B0\u7248\u672C
\u8F6F\u4EF6\u5305 logrotate-3.8.6-19.el7.x86_64 \u5DF2\u5B89\u88C5\u5E76\u4E14\u662F\u6700\u65B0\u7248\u672C
\u65E0\u987B\u4EFB\u4F55\u5904\u7406
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>\u4ECE\u5B98\u65B9\u4E0B\u8F7Drpm\u5305\u5E76\u4E0A\u4F20\u5230centos</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost opt<span class="token punctuation">]</span><span class="token comment">## ll | grep 11.rabbitmq</span>
-rw-r--r--   <span class="token number">1</span> root root    <span class="token number">14392152</span> <span class="token number">12</span>\u6708  <span class="token number">9</span> <span class="token number">16</span>:45 <span class="token number">11</span>.rabbitmq-server-3.9.11-1.suse.noarch.rpm
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5DF2\u7ECF\u4E0A\u4F20</p><ol start="3"><li>\u5B89\u88C5rabbitmq-server</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">## \u7248\u672C\u95EE\u9898</span>
<span class="token punctuation">[</span>root@localhost opt<span class="token punctuation">]</span><span class="token comment">## rpm -ivh 11.rabbitmq-server-3.9.11-1.suse.noarch.rpm</span>
\u8B66\u544A\uFF1A11.rabbitmq-server-3.9.11-1.suse.noarch.rpm: \u5934V4 RSA/SHA512 Signature, \u5BC6\u94A5 ID 6026dfca: NOKEY
\u9519\u8BEF\uFF1A\u4F9D\u8D56\u68C0\u6D4B\u5931\u8D25\uFF1A
	erlang <span class="token operator">&gt;=</span> <span class="token number">23.2</span> \u88AB <span class="token number">11</span>.rabbitmq-server-3.9.11-1.suse.noarch \u9700\u8981
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u771F\u9EBB\u70E6\uFF0C\u5220\u9664\u521A\u624D\u5B89\u88C5\u7684erlang\uFF0C\u76F4\u63A5\u4F7F\u7528yum\u5B89\u88C5\u6700\u65B0\u7684</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>yum <span class="token function">install</span> erlang
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="`+R+`" alt="image-20211209172317812"></p><p>\u5B89\u88C5rabbitmq</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost opt<span class="token punctuation">]</span><span class="token comment">## rpm -ivh 11.rabbitmq-server-3.9.11-1.suse.noarch.rpm</span>
\u8B66\u544A\uFF1A11.rabbitmq-server-3.9.11-1.suse.noarch.rpm: \u5934V4 RSA/SHA512 Signature, \u5BC6\u94A5 ID 6026dfca: NOKEY
\u51C6\u5907\u4E2D<span class="token punctuation">..</span>.                          <span class="token comment">################################## [100%]</span>
\u6B63\u5728\u5347\u7EA7/\u5B89\u88C5<span class="token punctuation">..</span>.
   <span class="token number">1</span>:11.rabbitmq-server-3.9.11-1.suse    <span class="token comment">################################## [100%]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li>\u542F\u52A8rabbitmq</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment">## systemctl start 11.rabbitmq-server</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="5"><li>\u67E5\u770Brabbitmq\u72B6\u6001</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment">## rabbitmqctl status</span>
Status of <span class="token function">node</span> rabbit@localhost <span class="token punctuation">..</span>.
Runtime

<span class="token comment">## \u8FDB\u7A0Bpid</span>
OS PID: <span class="token number">130734</span>
OS: Linux
Uptime <span class="token punctuation">(</span>seconds<span class="token punctuation">)</span>: <span class="token number">33</span>
Is under maintenance?: <span class="token boolean">false</span>
RabbitMQ version: <span class="token number">3.9</span>.11 <span class="token comment">## \u7248\u672C</span>
Node name: rabbit@localhost <span class="token comment">## \u8282\u70B9\u540D\u79F0\uFF0C\u5728erlang\u4E2D\u6709\u8282\u70B9\u548C\u5E94\u7528\u7684\u6982\u5FF5</span>

<span class="token comment">## erlang \u914D\u7F6E\u4FE1\u606F</span>

Erlang configuration: Erlang/OTP <span class="token number">23</span> <span class="token punctuation">[</span>erts-11.2.2.7<span class="token punctuation">]</span> <span class="token punctuation">[</span>source<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">64</span>-bit<span class="token punctuation">]</span> <span class="token punctuation">[</span>smp:2:2<span class="token punctuation">]</span> <span class="token punctuation">[</span>ds:2:2:10<span class="token punctuation">]</span> <span class="token punctuation">[</span>async-threads:1<span class="token punctuation">]</span> <span class="token punctuation">[</span>hipe<span class="token punctuation">]</span>
Erlang processes: <span class="token number">267</span> used, <span class="token number">1048576</span> limit
Scheduler run queue: <span class="token number">1</span>
Cluster heartbeat <span class="token function">timeout</span> <span class="token punctuation">(</span>net_ticktime<span class="token punctuation">)</span>: <span class="token number">60</span>

<span class="token comment">## 11.rabbitmq \u63D2\u4EF6</span>
Plugins

Enabled plugin file: /etc/11.rabbitmq/enabled_plugins
Enabled plugins:

<span class="token comment">## \u6570\u636E\u5B58\u50A8\u76EE\u5F55</span>
Data directory

Node data directory: /var/lib/11.rabbitmq/mnesia/rabbit@localhost
Raft data directory: /var/lib/11.rabbitmq/mnesia/rabbit@localhost/quorum/rabbit@localhost

<span class="token comment">## \u914D\u7F6E\u6587\u4EF6</span>
Config files


<span class="token comment">## \u65E5\u5FD7</span>
Log file<span class="token punctuation">(</span>s<span class="token punctuation">)</span>

 * /var/log/11.rabbitmq/rabbit@localhost.log
 * /var/log/11.rabbitmq/rabbit@localhost_upgrade.log
 * <span class="token operator">&lt;</span>stdout<span class="token operator">&gt;</span>

<span class="token comment">## \u8B66\u62A5</span>
Alarms

<span class="token punctuation">(</span>none<span class="token punctuation">)</span>

<span class="token comment">## \u5185\u5B58\u4FE1\u606F</span>
Memory

Total memory used: <span class="token number">0.0703</span> gb
Calculation strategy: rss
Memory high watermark setting: <span class="token number">0.4</span> of available memory, computed to: <span class="token number">0.4078</span> gb

code: <span class="token number">0.0242</span> gb <span class="token punctuation">(</span><span class="token number">34.16</span> %<span class="token punctuation">)</span>
other_proc: <span class="token number">0.0187</span> gb <span class="token punctuation">(</span><span class="token number">26.4</span> %<span class="token punctuation">)</span>
other_system: <span class="token number">0.0128</span> gb <span class="token punctuation">(</span><span class="token number">18.04</span> %<span class="token punctuation">)</span>
allocated_unused: <span class="token number">0.0103</span> gb <span class="token punctuation">(</span><span class="token number">14.49</span> %<span class="token punctuation">)</span>
other_ets: <span class="token number">0.003</span> gb <span class="token punctuation">(</span><span class="token number">4.2</span> %<span class="token punctuation">)</span>
atom: <span class="token number">0.0013</span> gb <span class="token punctuation">(</span><span class="token number">1.87</span> %<span class="token punctuation">)</span>
metrics: <span class="token number">0.0002</span> gb <span class="token punctuation">(</span><span class="token number">0.31</span> %<span class="token punctuation">)</span>
binary: <span class="token number">0.0002</span> gb <span class="token punctuation">(</span><span class="token number">0.27</span> %<span class="token punctuation">)</span>
mnesia: <span class="token number">0.0001</span> gb <span class="token punctuation">(</span><span class="token number">0.13</span> %<span class="token punctuation">)</span>
plugins: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.05</span> %<span class="token punctuation">)</span>
quorum_ets: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.04</span> %<span class="token punctuation">)</span>
msg_index: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.04</span> %<span class="token punctuation">)</span>
stream_queue_procs: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
stream_queue_replica_reader_procs: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
connection_channels: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
connection_other: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
connection_readers: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
connection_writers: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
mgmt_db: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
queue_procs: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
queue_slave_procs: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
quorum_queue_procs: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
reserved_unallocated: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
stream_queue_coordinator_procs: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>

File Descriptors

Total: <span class="token number">2</span>, limit: <span class="token number">32671</span>
Sockets: <span class="token number">0</span>, limit: <span class="token number">29401</span>

Free Disk Space

Low <span class="token function">free</span> disk space watermark: <span class="token number">0.05</span> gb
Free disk space: <span class="token number">41.1812</span> gb

Totals

Connection count: <span class="token number">0</span> <span class="token comment">## \u8FDE\u63A5\u6570\u91CF</span>
Queue count: <span class="token number">0</span> <span class="token comment">## \u961F\u5217\u6570\u91CF</span>
Virtual <span class="token function">host</span> count: <span class="token number">1</span> <span class="token comment">## \u4E3B\u673A\u6570\u91CF</span>

<span class="token comment">## \u76D1\u542C\u7AEF\u53E3</span>
Listeners

Interface: <span class="token punctuation">[</span>::<span class="token punctuation">]</span>, port: <span class="token number">25672</span>, protocol: clustering, purpose: inter-node and CLI tool communication <span class="token comment">## \u5E94\u8BE5\u662F\u901A\u4FE1\u7684\u7AEF\u53E3</span>
Interface: <span class="token punctuation">[</span>::<span class="token punctuation">]</span>, port: <span class="token number">5672</span>, protocol: amqp, purpose: AMQP <span class="token number">0</span>-9-1 and AMQP <span class="token number">1.0</span> <span class="token comment">## AMQP\u7AEF\u53E3</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="7"><li>\u5F00\u542Frabbitmq\u7684web\u7BA1\u7406\u754C\u9762</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment">## 11.rabbitmq-plugins enable rabbitmq_management</span>
Enabling plugins on <span class="token function">node</span> rabbit@localhost:
rabbitmq_management
The following plugins have been configured:
  rabbitmq_management
  rabbitmq_management_agent
  rabbitmq_web_dispatch
Applying plugin configuration to rabbit@localhost<span class="token punctuation">..</span>.
The following plugins have been enabled:
  rabbitmq_management
  rabbitmq_management_agent
  rabbitmq_web_dispatch

started <span class="token number">3</span> plugins.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7136\u540E\u6211\u4EEC\u5C31\u53EF\u4EE5\u901A\u8FC7curl\u8BBF\u95EE\u5230rabbitmq\u7684web\u754C\u9762\u4E86</p><p><img src="`+E+`" alt="image-20211209174027079"></p><ol start="7"><li>\u914D\u7F6E\u8FDC\u7A0B\u8BBF\u95EE\u65B9\u5F0F\u4E00</li></ol><p>\u51FA\u4E8E\u5B89\u5168\u7684\u8003\u8651\uFF0Cguest\u8FD9\u4E2A\u9ED8\u8BA4\u7684\u7528\u6237\u53EA\u80FD\u901A\u8FC7http://localhost:15672 \u6765\u767B\u5F55\uFF0C\u4E0D\u80FD\u4F7F\u7528IP\u5730\u5740\u767B\u5F55\uFF0C\u4E5F\u5C31\u662F\u4E0D\u80FD\u8FDC\u7A0B\u8BBF\u95EE\uFF0C\u5728\u8FD9\u91CC\u53EF\u4EE5\u65B0\u5EFA\u4E00\u4E2A\u8D26\u53F7\uFF0C\u8D4B\u4E88\u7BA1\u7406\u5458\u6743\u9650\uFF0C\u5B9E\u73B0\u8FDC\u7A0B\u8BBF\u95EE</p><p>\u9ED8\u8BA4rabbitmq\u5728\u542F\u52A8\u4E4B\u540E\u4F1A\u53BB\u8BFB\u53D6<code>/etc/rabbitmq/</code>\u76EE\u5F55\u4E0B\u7684\u540D\u4E3A<code>rabbitmq.config</code>\u7684\u914D\u7F6E\u6587\u4EF6</p><p>rabbitmq\u7684\u7CFB\u7EDF\u914D\u7F6E\u6587\u4EF6\u4E00\u822C\u662Frabbitmq.conf\uFF0C\u53EF\u4EE5\u767B\u5F55\u540E\u53F0\u67E5\u770B\u5B83\u7684\u8DEF\u5F84\uFF0C\u5982\u679C\u4F60\u662F\u6E90\u7801\u5B89\u88C5\uFF0C\u6700\u521D\u8FD9\u4E2A\u6587\u4EF6\u662F\u6CA1\u6709\u7684\uFF0C\u9700\u8981\u624B\u52A8\u521B\u5EFA</p><p>\u5982\u679C\u662Fapt\u5B89\u88C5\u4ED6\u7684\u4F4D\u7F6E\u5728/etc/rabbitmq/\u76EE\u5F55\u4E0B\uFF0C\u5B83\u89C4\u5B9A\u4E86rabbitmq\u7684\u4F17\u591A\u53C2\u6570\u8BBE\u5B9A</p><blockquote><p>\u5982\u679C\u4F60\u6CA1\u6709\u627E\u5230\u7684\u8BDD\u4E5F\u6CA1\u5173\u7CFB\uFF0C\u53BBgithub\u4E0A\u62F7\u8D1D\u4E00\u4EFD\u6A21\u7248\u914D\u7F6E\uFF0C\u624B\u52A8\u521B\u5EFA <code>/etc/rabbitmq/rabbitmq.config</code> \u914D\u7F6E\u6587\u4EF6\uFF0C\u7136\u540E\u5C06\u4F60\u62F7\u8D1D\u7684\u914D\u7F6E\u653E\u8FDB\u53BB\u4E5F\u662Fok\u7684</p><p>rabbitmq github addr\uFF1Ahttps://github.com/rabbitmq/rabbitmq-server/blob/v3.8.9/docs/</p></blockquote><blockquote><p>\u5B98\u65B9\uFF1A\u5F3A\u70C8\u4E0D\u5EFA\u8BAE\u5141\u8BB8\u9ED8\u8BA4\u7684\u7528\u6237\u53EF\u8FDC\u7A0B\u767B\u9646MQ\uFF0C\u7528\u8FC7RabbitMQ\u7684\u7A0B\u5E8F\u5458\u90FD\u77E5\u9053\u9ED8\u8BA4\u7528\u6237\u540D\u548C\u5BC6\u7801\u662F\u5565\uFF0C\u8FD9\u4F1A\u8BA9\u4F60\u7684\u7CFB\u7EDF\u7684\u5B89\u5168\u6027\u5927\u5927\u964D\u4F4E\uFF01</p><p>\u63A8\u8350\u7684\u505A\u6CD5\u662F\uFF1A\u5220\u9664\u9ED8\u8BA4\u7528\u6237\u3001\u4F7F\u7528\u65B0\u7684\u5B89\u5168\u51ED\u8BC1\u521B\u5EFA\u65B0\u7684\u7528\u6237</p></blockquote><p>\u6DFB\u52A0\u4EE5\u4E0B\u914D\u7F6E\u4FE1\u606F</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>
<span class="token punctuation">{</span>rabbit, <span class="token punctuation">[</span><span class="token punctuation">{</span>tcp_listeners, <span class="token punctuation">[</span><span class="token number">5672</span><span class="token punctuation">]</span><span class="token punctuation">}</span>, <span class="token punctuation">{</span>loopback_users, <span class="token punctuation">[</span><span class="token string">&quot;admin&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span>.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u65B0\u589E\u8FDC\u7A0B\u8BBF\u95EE\u7BA1\u7406\u8D26\u53F7\uFF1Aadmin</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost <span class="token number">11</span>.rabbitmq<span class="token punctuation">]</span><span class="token comment">## rabbitmqctl add_user admin 12345</span>
Adding user <span class="token string">&quot;admin&quot;</span> <span class="token punctuation">..</span>.
Done. Don<span class="token string">&#39;t forget to grant the user permissions to some virtual hosts! See &#39;</span>rabbitmqctl <span class="token builtin class-name">help</span> set_permissions&#39; to learn more.
<span class="token punctuation">[</span>root@localhost <span class="token number">11</span>.rabbitmq<span class="token punctuation">]</span><span class="token comment">## rabbitmqctl set_user_tags admin administrator</span>
Setting tags <span class="token keyword">for</span> user <span class="token string">&quot;admin&quot;</span> to <span class="token punctuation">[</span>administrator<span class="token punctuation">]</span> <span class="token punctuation">..</span>.
<span class="token punctuation">[</span>root@localhost <span class="token number">11</span>.rabbitmq<span class="token punctuation">]</span><span class="token comment">## rabbitmqctl set_permissions -p &quot;/&quot; admin &quot;.*&quot; &quot;.*&quot; &quot;.*&quot;</span>
Setting permissions <span class="token keyword">for</span> user <span class="token string">&quot;admin&quot;</span> <span class="token keyword">in</span> vhost <span class="token string">&quot;/&quot;</span> <span class="token punctuation">..</span>.
<span class="token punctuation">[</span>root@localhost <span class="token number">11</span>.rabbitmq<span class="token punctuation">]</span><span class="token comment">## rabbitmqctl list_users</span>
Listing <span class="token function">users</span> <span class="token punctuation">..</span>.
user	tags
admin	<span class="token punctuation">[</span>administrator<span class="token punctuation">]</span>
guest	<span class="token punctuation">[</span>administrator<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u5982\u679C\u4E0D\u80FD\u8BBF\u95EE\uFF0C\u8BB0\u5F97\u5173\u95ED\u9632\u706B\u5899</strong></p><p>\u901A\u8FC7\u6D4F\u89C8\u5668\u5DF2\u7ECF\u53EF\u4EE5\u8BBF\u95EE\u4E86\u3002</p><p><img src="`+P+'" alt="image-20211209184733523"></p><ol start="8"><li>\u914D\u7F6E\u8FDC\u7A0B\u8BBF\u95EE\u65B9\u5F0F\u4E8C</li></ol><blockquote><p>\u53BBgithub\u4E0A\u62F7\u8D1D\u4E00\u4EFD\u6A21\u7248\u914D\u7F6E\uFF0C\u624B\u52A8\u521B\u5EFA <code>/etc/rabbitmq/rabbitmq.config</code> \u914D\u7F6E\u6587\u4EF6\uFF0C\u7136\u540E\u5C06\u4F60\u62F7\u8D1D\u7684\u914D\u7F6E\u653E\u8FDB\u53BB\u4E5F\u662Fok\u7684</p><p>rabbitmq github addr\uFF1Ahttps://github.com/rabbitmq/rabbitmq-server/blob/v3.8.9/docs/</p></blockquote><p>\u7136\u540E\u5C06\u914D\u7F6E\u6587\u4EF6\u4E2D\u7684lookback_users\u8BBE\u7F6E\u4E3Anone</p><p><img src="'+A+'" alt="img"></p><p>\u7136\u540E\u901A\u8FC7service\u547D\u4EE4\u91CD\u542FMQ\uFF0C\u5728web\u9875\u9762\u5C1D\u8BD5\u767B\u9646\uFF0C\u63A5\u7740\u4F60\u4F1A\u6210\u529F\u767B\u9646\uFF0C\u7136\u540E\u6DFB\u52A0\u7528\u6237\uFF0C\u8FD9\u6837\u5C31\u53EF\u4EE5\u4F7F\u7528\u6DFB\u52A0\u7684\u8FD9\u4E2A\u7528\u6237\u8FDB\u884C\u767B\u5F55\u4E86</p><p><img src="'+T+`" alt="img"></p><ol start="9"><li>\u5982\u679C\u60F3\u8981\u5F00\u673A\u81EA\u542F\u52A8\uFF0C\u53EF\u4EE5\u8BBE\u7F6E</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">chkconfig</span> <span class="token number">11</span>.rabbitmq-server on <span class="token comment">## \u8BBE\u7F6Erabbitmq\u5F00\u673A\u542F\u52A8</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="docker\u4E0B\u5B89\u88C5"><a class="header-anchor" href="#docker\u4E0B\u5B89\u88C5" aria-hidden="true">#</a> docker\u4E0B\u5B89\u88C5</h3><p>\u8BBF\u95EErabbitmq\u5B98\u65B9\u7684\u5B89\u88C5\u9875\u9762\uFF1Ahttps://www.rabbitmq.com/download.html</p><p><img src="`+I+`" alt="image-20211209143545465"></p><ol><li>\u76F4\u63A5\u4F7F\u7528\u547D\u4EE4</li></ol><p><code>docker run -it --rm --name rabbitmq -p 5672:5672 -p 15672:15672 rabbitmq:3.8-management</code>\u5373\u53EF\uFF0Cdocker\u5982\u679C\u5728\u672C\u5730\u627E\u4E0D\u5230\u8FD9\u4E2A\u955C\u50CF\u4F1A\u81EA\u52A8\u53BB\u4ED3\u5E93\u627E\uFF0C\u627E\u5230\u5E76\u4E0B\u8F7D\u955C\u50CF\u542F\u52A8</p><p>\u6700\u597D\u5C31\u662F\u5728\u52A0\u4E00\u4E2A\u53C2\u6570-d\uFF0C\u8BA9\u5B83\u5728\u540E\u53F0\u8FD0\u884C\uFF0C\u4E0D\u8981\u5728\u524D\u53F0\u8FD0\u884C<code>docker run -d -it --rm --name rabbitmq -p 5672:5672 -p 15672:15672 rabbitmq:3.8-management</code></p><p>\u67E5\u770B\u8FD0\u884C\u72B6\u6001</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment">## docker ps</span>
CONTAINER ID   IMAGE                     COMMAND                  CREATED         STATUS         PORTS                                                                                                                                                 NAMES
f938fee3451f   <span class="token number">11</span>.rabbitmq:3.8-management   <span class="token string">&quot;docker-entrypoint.s\u2026&quot;</span>   <span class="token number">6</span> minutes ago   Up <span class="token number">6</span> minutes   <span class="token number">4369</span>/tcp, <span class="token number">5671</span>/tcp, <span class="token number">0.0</span>.0.0:5672-<span class="token operator">&gt;</span><span class="token number">5672</span>/tcp, :::5672-<span class="token operator">&gt;</span><span class="token number">5672</span>/tcp, <span class="token number">15671</span>/tcp, <span class="token number">15691</span>-15692/tcp, <span class="token number">25672</span>/tcp, <span class="token number">0.0</span>.0.0:15672-<span class="token operator">&gt;</span><span class="token number">15672</span>/tcp, :::15672-<span class="token operator">&gt;</span><span class="token number">15672</span>/tcp   <span class="token number">11</span>.rabbitmq
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>\u8FDB\u5165\u5BB9\u5668\u67E5\u770Brabbitmq\u72B6\u6001\u548C\u6267\u884C\u4E0A\u9762mac\u4E0B\u7684\u547D\u4EE4\u90FD\u662F\u53EF\u4EE5\u7684</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">## \u8FDB\u5165\u5BB9\u5668</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment">## docker ps</span>
CONTAINER ID   IMAGE                     COMMAND                  CREATED         STATUS         PORTS                                                                                                                                                 NAMES
f938fee3451f   <span class="token number">11</span>.rabbitmq:3.8-management   <span class="token string">&quot;docker-entrypoint.s\u2026&quot;</span>   <span class="token number">8</span> minutes ago   Up <span class="token number">8</span> minutes   <span class="token number">4369</span>/tcp, <span class="token number">5671</span>/tcp, <span class="token number">0.0</span>.0.0:5672-<span class="token operator">&gt;</span><span class="token number">5672</span>/tcp, :::5672-<span class="token operator">&gt;</span><span class="token number">5672</span>/tcp, <span class="token number">15671</span>/tcp, <span class="token number">15691</span>-15692/tcp, <span class="token number">25672</span>/tcp, <span class="token number">0.0</span>.0.0:15672-<span class="token operator">&gt;</span><span class="token number">15672</span>/tcp, :::15672-<span class="token operator">&gt;</span><span class="token number">15672</span>/tcp   <span class="token number">11</span>.rabbitmq
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment">## docker exec -it f938fee3451f /bin/bash</span>

<span class="token comment">## \u67E5\u770Brabbitmq\u72B6\u6001</span>
root@f938fee3451f:/<span class="token comment">## rabbitmqctl status</span>
Status of <span class="token function">node</span> rabbit@f938fee3451f <span class="token punctuation">..</span>.
Runtime

OS PID: <span class="token number">273</span>
OS: Linux
Uptime <span class="token punctuation">(</span>seconds<span class="token punctuation">)</span>: <span class="token number">544</span>
Is under maintenance?: <span class="token boolean">false</span>
RabbitMQ version: <span class="token number">3.8</span>.26
Node name: rabbit@f938fee3451f
Erlang configuration: Erlang/OTP <span class="token number">24</span> <span class="token punctuation">[</span>erts-12.1.5<span class="token punctuation">]</span> <span class="token punctuation">[</span>source<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">64</span>-bit<span class="token punctuation">]</span> <span class="token punctuation">[</span>smp:2:2<span class="token punctuation">]</span> <span class="token punctuation">[</span>ds:2:2:10<span class="token punctuation">]</span> <span class="token punctuation">[</span>async-threads:1<span class="token punctuation">]</span> <span class="token punctuation">[</span>jit<span class="token punctuation">]</span>
Erlang processes: <span class="token number">397</span> used, <span class="token number">1048576</span> limit
Scheduler run queue: <span class="token number">1</span>
Cluster heartbeat <span class="token function">timeout</span> <span class="token punctuation">(</span>net_ticktime<span class="token punctuation">)</span>: <span class="token number">60</span>

Plugins

Enabled plugin file: /etc/11.rabbitmq/enabled_plugins
Enabled plugins:

 * rabbitmq_prometheus
 * prometheus
 * rabbitmq_management
 * amqp_client
 * rabbitmq_web_dispatch
 * cowboy
 * cowlib
 * rabbitmq_management_agent

Data directory

Node data directory: /var/lib/11.rabbitmq/mnesia/rabbit@f938fee3451f
Raft data directory: /var/lib/11.rabbitmq/mnesia/rabbit@f938fee3451f/quorum/rabbit@f938fee3451f

Config files

 * /etc/11.rabbitmq/11.rabbitmq.conf

Log file<span class="token punctuation">(</span>s<span class="token punctuation">)</span>

 * <span class="token operator">&lt;</span>stdout<span class="token operator">&gt;</span>

Alarms

<span class="token punctuation">(</span>none<span class="token punctuation">)</span>

Memory

Total memory used: <span class="token number">0.1432</span> gb
Calculation strategy: rss
Memory high watermark setting: <span class="token number">0.4</span> of available memory, computed to: <span class="token number">0.4078</span> gb

reserved_unallocated: <span class="token number">0.0669</span> gb <span class="token punctuation">(</span><span class="token number">46.76</span> %<span class="token punctuation">)</span>
code: <span class="token number">0.0364</span> gb <span class="token punctuation">(</span><span class="token number">25.44</span> %<span class="token punctuation">)</span>
other_proc: <span class="token number">0.0265</span> gb <span class="token punctuation">(</span><span class="token number">18.48</span> %<span class="token punctuation">)</span>
other_system: <span class="token number">0.0249</span> gb <span class="token punctuation">(</span><span class="token number">17.39</span> %<span class="token punctuation">)</span>
other_ets: <span class="token number">0.0033</span> gb <span class="token punctuation">(</span><span class="token number">2.32</span> %<span class="token punctuation">)</span>
atom: <span class="token number">0.0014</span> gb <span class="token punctuation">(</span><span class="token number">1.0</span> %<span class="token punctuation">)</span>
plugins: <span class="token number">0.0011</span> gb <span class="token punctuation">(</span><span class="token number">0.78</span> %<span class="token punctuation">)</span>
metrics: <span class="token number">2</span>.0e-4 gb <span class="token punctuation">(</span><span class="token number">0.16</span> %<span class="token punctuation">)</span>
mgmt_db: <span class="token number">2</span>.0e-4 gb <span class="token punctuation">(</span><span class="token number">0.12</span> %<span class="token punctuation">)</span>
binary: <span class="token number">1</span>.0e-4 gb <span class="token punctuation">(</span><span class="token number">0.08</span> %<span class="token punctuation">)</span>
mnesia: <span class="token number">1</span>.0e-4 gb <span class="token punctuation">(</span><span class="token number">0.06</span> %<span class="token punctuation">)</span>
quorum_ets: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.03</span> %<span class="token punctuation">)</span>
msg_index: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.02</span> %<span class="token punctuation">)</span>
connection_other: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
allocated_unused: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
connection_channels: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
connection_readers: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
connection_writers: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
queue_procs: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
queue_slave_procs: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
quorum_queue_procs: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>

File Descriptors

Total: <span class="token number">2</span>, limit: <span class="token number">1048479</span>
Sockets: <span class="token number">0</span>, limit: <span class="token number">943629</span>

Free Disk Space

Low <span class="token function">free</span> disk space watermark: <span class="token number">0.05</span> gb
Free disk space: <span class="token number">42.9601</span> gb

Totals

Connection count: <span class="token number">0</span>
Queue count: <span class="token number">0</span>
Virtual <span class="token function">host</span> count: <span class="token number">1</span>

Listeners

Interface: <span class="token punctuation">[</span>::<span class="token punctuation">]</span>, port: <span class="token number">15672</span>, protocol: http, purpose: HTTP API
Interface: <span class="token punctuation">[</span>::<span class="token punctuation">]</span>, port: <span class="token number">15692</span>, protocol: http/prometheus, purpose: Prometheus exporter API over HTTP
Interface: <span class="token punctuation">[</span>::<span class="token punctuation">]</span>, port: <span class="token number">25672</span>, protocol: clustering, purpose: inter-node and CLI tool communication
Interface: <span class="token punctuation">[</span>::<span class="token punctuation">]</span>, port: <span class="token number">5672</span>, protocol: amqp, purpose: AMQP <span class="token number">0</span>-9-1 and AMQP <span class="token number">1.0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u5728docker\u73AF\u5883\u4E2D\u914D\u7F6Erabbitmq\u65F6\uFF0C\u9700\u8981\u914D\u7F6Ehostname</strong></p><p>rabbitmq\u7684\u6570\u636E\u5E93\u540D\u79F0\u89C4\u5219\u662F\uFF0CNODENAME@hostname\uFF0Cdocker\u6BCF\u6B21\u4ECEdocker image\u542F\u52A8\u5BB9\u5668\u7684\u65F6\u5019\u4F1A\u81EA\u52A8\u751F\u6210hostname\uFF0C\u8FD9\u6837\u4E00\u6765\uFF0C\u4F60\u4FDD\u5B58\u5728\u4E3B\u673A\u4E0A\u7684\u6570\u636E\u5E93\u5C31\u4F1A\u6CA1\u7528\u4E86\uFF0C\u5305\u62EC\u4E4B\u524D\u521B\u5EFA\u7684\u7528\u6237\u4E5F\u4F1A\u6CA1\u6709\u4E86</p><p>\u6240\u4EE5\u5728\u521B\u5EFA\u5BB9\u5668\u7684\u65F6\u5019\u5FC5\u987B\u6307\u5B9A<code>--hostname=rabbitmqhostone</code>\uFF0C\u8FD9\u6837docker\u73AF\u5883\u542F\u52A8\u540Erabbitmq\u5C31\u4F1A\u4E00\u76F4\u8BFB\u53D6\u56FA\u5B9A\u76EE\u5F55\u4E2D\u7684\u6570\u636E\u4E86</p><h2 id="rabbitmq\u914D\u7F6E"><a class="header-anchor" href="#rabbitmq\u914D\u7F6E" aria-hidden="true">#</a> rabbitmq\u914D\u7F6E</h2><h3 id="authentication-\u8BA4\u8BC1"><a class="header-anchor" href="#authentication-\u8BA4\u8BC1" aria-hidden="true">#</a> Authentication\uFF08\u8BA4\u8BC1\uFF09</h3><p>RabbitMQ\u542F\u52A8\u4E4B\u540E\uFF0C\u6211\u4EEC\u60F3\u4F7F\u7528\u5B83\u7684\u524D\u63D0\u662F\u7528username\u3001password\u8FDE\u63A5\u4E0A\u5B83\u3002\u8FD9\u91CC\u6240\u8BF4\u7684username\u548Cpassowrd\u5176\u5B9E\u5C31\u662F\u4E00\u4E2A\u88AB\u6388\u4E88\u4E00\u5B9A\u6743\u9650\u7684\u7528\u6237</p><p>\u7528\u6237\u8FDE\u63A5\u4E0ARabbitMQ\u5373\u53EF\u521B\u5EFAvirtual host\u4F7F\u7528MQ\u3002\u5728\u8BF4\u4EC0\u4E48\u662Fvirtual host\u4E4B\u524D\uFF0C\u5148\u8BF4\u4E0BRabbitMQ\u9ED8\u8BA4\u6709\u7684\u88AB\u6388\u6743\u7684\u7528\u6237\uFF1A<code>username=guest\u3001password=guest\u3001virtualhost=/</code></p><p>\u4F46\u662F\u8FD9\u4E2A\u7528\u6237\u88AB\u9650\u5236\u4E86\u53EA\u80FD\u5728RabbitMQ\u6240\u5728\u673A\u5668\u7684\u672C\u5730\u624D\u80FD\u767B\u9646MQ\uFF08\u4E0D\u5141\u8BB8\u4F60\u4F7F\u7528\u8BE5\u7528\u6237\u901A\u8FC7ip+port\u8FDC\u7A0B\u767B\u5F55RabbitMQ\uFF09</p><blockquote><p>\u4F60\u4F7F\u7528\u7279\u5B9A\u7684\u7528\u6237\u53BB\u8FDE\u63A5MQ\u7684\u8FC7\u7A0B\u5373\u4E3AAuthentication</p></blockquote><h3 id="rabbitmq\u7BA1\u7406\u547D\u4EE4\u884C"><a class="header-anchor" href="#rabbitmq\u7BA1\u7406\u547D\u4EE4\u884C" aria-hidden="true">#</a> rabbitmq\u7BA1\u7406\u547D\u4EE4\u884C</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">## \u670D\u52A1\u542F\u52A8\u76F8\u5173</span>
systemctl start<span class="token operator">|</span>restart<span class="token operator">|</span>status <span class="token number">11</span>.rabbitmq-server

<span class="token comment">## \u7BA1\u7406\u547D\u4EE4\u884C\uFF0C\u7528\u6765\u5728\u4E0D\u4F7F\u7528web\u7BA1\u7406\u754C\u9762\u60C5\u51B5\u4E0B\u547D\u4EE4\u64CD\u4F5Crabbitmq</span>
rabbitmqctl <span class="token builtin class-name">help</span> <span class="token comment">## \u53EF\u4EE5\u67E5\u770B\u66F4\u591A\u7684\u547D\u4EE4</span>

<span class="token comment">## \u63D2\u4EF6\u7BA1\u7406\u547D\u4EE4</span>
<span class="token number">11</span>.rabbitmq-plugins <span class="token builtin class-name">enable</span><span class="token operator">|</span>list<span class="token operator">|</span>disable
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="web\u7BA1\u7406\u754C\u9762\u4ECB\u7ECD"><a class="header-anchor" href="#web\u7BA1\u7406\u754C\u9762\u4ECB\u7ECD" aria-hidden="true">#</a> web\u7BA1\u7406\u754C\u9762\u4ECB\u7ECD</h3><h4 id="overview\u6982\u89C8"><a class="header-anchor" href="#overview\u6982\u89C8" aria-hidden="true">#</a> overview\u6982\u89C8</h4><p>\u57FA\u672C\u8BF4\u660E\uFF1A</p><ul><li>overview \u6982\u89C8</li><li>connection \u8FDE\u63A5</li><li>channel \u901A\u9053</li><li>exchange \u4EA4\u6362\u673A</li><li>queue \u961F\u5217</li><li>admin \u7BA1\u7406</li></ul><ol><li>overview</li></ol><p><img src="`+j+'" alt="image-20211209192804695"></p><ul><li>5672 AMQP \u534F\u8BAE\u7AEF\u53E3</li><li>15672 http\u7AEF\u53E3</li></ul><ol start="2"><li>connections</li></ol><p><img src="'+D+'" alt="image-20211209202255979"></p><p>\u5F53\u524Drabbitmq\u7684\u8FDE\u63A5\u60C5\u51B5\uFF0C\u5C31\u662F\u90A3\u4E9B\u5BA2\u6237\u7AEF\u4E0Erabbitmq\u8FDE\u63A5</p><ul><li>\u53EF\u4EE5\u901A\u8FC7\u641C\u7D22\u8FC7\u6EE4</li><li>\u4E5F\u53EF\u4EE5\u901A\u8FC7\u6B63\u5219\u8868\u8FBE\u5F0F\u7684\u65B9\u5F0F\u8FC7\u6EE4</li><li>\u8FD8\u53EF\u4EE5\u6267\u884C\u5206\u9875\u64CD\u4F5C</li></ul><ol start="3"><li>channel</li></ol><p><img src="'+O+'" alt="image-20211209202415125"></p><p>\u6D88\u606F\u961F\u5217\u901A\u8FC7\u901A\u9053\u4F20\u9012\u6D88\u606F</p><ul><li>\u53EF\u4EE5\u901A\u8FC7\u641C\u7D22\u8FC7\u6EE4</li><li>\u4E5F\u53EF\u4EE5\u901A\u8FC7\u6B63\u5219\u8868\u8FBE\u5F0F\u7684\u65B9\u5F0F\u8FC7\u6EE4</li><li>\u8FD8\u53EF\u4EE5\u6267\u884C\u5206\u9875\u64CD\u4F5C</li></ul><ol start="4"><li>exchange</li></ol><p><img src="'+N+'" alt="image-20211209202533279"></p><p>\u4EA4\u6362\u673A\uFF0C\u4E5F\u53EF\u4EE5\u53EB\u505A\u8DEF\u7531\uFF0C\u9ED8\u8BA4\u5B89\u88C5\u6210\u529F\u4E4B\u540E\u5185\u7F6E\u4E867\u79CD\u8DEF\u7531</p><blockquote><p>Features\uFF1A</p><ul><li>D \u8868\u793Adurable\uFF0C\u8010\u7528\u7684\uFF0C\u4EE3\u8868\u76F4\u8FDE\u7684\u6D88\u606F\u662F\u5B58\u5728\u78C1\u76D8\u4E2D\uFF0C\u4E0D\u4F1A\u968F\u7740rabbitmq\u7684\u5173\u95ED\u3001\u91CD\u542F\u7B49\u800C\u6D88\u5931</li><li>I \u8868\u793Ainternal\uFF0C\u5185\u90E8\u7684\uFF0C</li></ul></blockquote><ul><li>AMQP default \u8868\u793AAMQP\u9ED8\u8BA4\u8DEF\u7531\u4E3Adirect</li><li>amq.direct \u76F4\u8FDE</li><li>amq.fanout \u6247\u51FA\u5E7F\u64AD</li><li>amq.headers</li><li>amq.match</li><li>amq.topic</li></ul><p><strong>Add a new exchange</strong>\uFF1A\u53EF\u4EE5\u81EA\u5DF1\u6DFB\u52A0\u4EA4\u6362\u673A</p><ol start="5"><li>queue</li></ol><p><img src="'+F+'" alt="image-20211209203436351"></p><p>\u961F\u5217\uFF0C\u662F\u8981\u7ED1\u5B9A\u4EA4\u6362\u673A\u7684\uFF0C\u53EF\u4EE5\u81EA\u5DF1\u6DFB\u52A0\u961F\u5217</p><ol start="6"><li>admin</li></ol><p><img src="'+L+'" alt="image-20211209203606571"></p><p>\u7528\u6765\u5BF9\u7528\u6237\u8FDB\u884C\u7BA1\u7406\uFF0C\u6211\u4EEC\u53EF\u4EE5\u521B\u5EFA\u65B0\u7684\u7528\u6237</p><p>\u65B0\u521B\u5EFA\u7684\u7528\u6237\u662F\u6CA1\u6709\u4EFB\u4F55\u6743\u9650\u7684\uFF0C\u6211\u4EEC\u53EF\u4EE5\u8BBE\u7F6ETags\u8BBE\u7F6E\u6743\u9650</p><h2 id="rabbitmq\u7684\u7B2C\u4E00\u4E2A\u7A0B\u5E8F"><a class="header-anchor" href="#rabbitmq\u7684\u7B2C\u4E00\u4E2A\u7A0B\u5E8F" aria-hidden="true">#</a> rabbitmq\u7684\u7B2C\u4E00\u4E2A\u7A0B\u5E8F</h2><h3 id="rabbitmq\u534F\u8BAE\u56DE\u987E"><a class="header-anchor" href="#rabbitmq\u534F\u8BAE\u56DE\u987E" aria-hidden="true">#</a> rabbitmq\u534F\u8BAE\u56DE\u987E</h3><p><img src="'+B+'" alt="image-20211209204912151"></p><ul><li>\u865A\u62DF\u4E3B\u673A\u7C7B\u4F3C\u4E8Emysql\u4E2D\u5E93\u7684\u6982\u5FF5</li><li>\u4E00\u4E2A\u9879\u76EE\u6216\u8005\u4E00\u4E2A\u4E1A\u52A1\u53EA\u80FD\u8BBF\u95EE\u4E00\u4E2A\u865A\u62DF\u4E3B\u673A</li><li>\u4E00\u4E2A\u865A\u62DF\u4E3B\u673A\u7ED1\u5B9A\u4E00\u4E2A\u7279\u5B9A\u7684\u7528\u6237</li></ul><p><strong>\u6240\u4EE5\uFF0C\u5728\u771F\u6B63\u4F7F\u7528rabbitmq\u7684\u65F6\u5019\uFF0C\u5FC5\u987B\u5F97\u5728\u5B83\u7684\u7BA1\u7406\u754C\u9762\u4E2D\uFF0C\u5148\u521B\u5EFA\u7528\u6237\uFF0C\u518D\u521B\u5EFA\u865A\u62DF\u4E3B\u673A\uFF0C\u7136\u540E\u5C06\u7528\u6237\u548C\u865A\u62DF\u4E3B\u673A\u8FDB\u884C\u7ED1\u5B9A</strong></p><ul><li>\u751F\u4EA7\u8005\u53EF\u4EE5\u5C06\u6D88\u606F\u53D1\u9001\u7ED9exchange\uFF0C\u6216\u8005\u76F4\u63A5\u53D1\u9001\u7ED9queue</li></ul><h3 id="rabbitmq\u652F\u6301\u7684\u6D88\u606F\u6A21\u578B"><a class="header-anchor" href="#rabbitmq\u652F\u6301\u7684\u6D88\u606F\u6A21\u578B" aria-hidden="true">#</a> rabbitmq\u652F\u6301\u7684\u6D88\u606F\u6A21\u578B</h3><blockquote><p>\u5B98\u65B9\u6D88\u606F\u6A21\u578B\uFF1Ahttps://www.rabbitmq.com/getstarted.html</p></blockquote><p><img src="'+H+`" alt="image-20211209210931455"></p><h3 id="\u5F15\u5165\u4F9D\u8D56"><a class="header-anchor" href="#\u5F15\u5165\u4F9D\u8D56" aria-hidden="true">#</a> \u5F15\u5165\u4F9D\u8D56</h3><p>\u521B\u5EFAmaven\u9879\u76EE\uFF0C\u5F15\u5165\u4F9D\u8D56</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!--\u5F15\u5165amqp\u7684\u76F8\u5173\u4F9D\u8D56\uFF0C\u5728\u4F7F\u7528java\u53BB\u64CD\u4F5Camqp\u53EA\u9700\u8981\u8FD9\u4E00\u4E2A\u4F9D\u8D56\u5C31\u597D\u4E86--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.rabbitmq<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>s
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>amqp-client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.13.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--\u987A\u4FBF\u5F15\u5165junit\uFF0C\u65B9\u4FBF\u6D4B\u8BD5--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>junit<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.12<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u7B2C\u4E00\u79CD\u6A21\u578B"><a class="header-anchor" href="#\u7B2C\u4E00\u79CD\u6A21\u578B" aria-hidden="true">#</a> \u7B2C\u4E00\u79CD\u6A21\u578B</h3><p>(\u76F4\u8FDE)</p><h4 id="\u914D\u7F6Erabbitmq"><a class="header-anchor" href="#\u914D\u7F6Erabbitmq" aria-hidden="true">#</a> \u914D\u7F6Erabbitmq</h4><p><img src="`+U+'" alt="img"></p><ol><li>\u521B\u5EFA\u4E00\u4E2A\u865A\u62DF\u4E3B\u673A(\u5C31\u50CF\u521B\u5EFA\u4E00\u4E2A\u6570\u636E\u5E93)</li></ol><p>\u865A\u62DF\u4E3B\u673A\u5FC5\u987B\u4EE5<code>/</code>\u5F00\u5934\uFF0C\u5F53\u524D\u7684\u865A\u62DF\u4E3B\u673A\u8FD8\u4E0D\u5141\u8BB8\u4EFB\u4F55\u7528\u6237\u8BBF\u95EE\uFF0C\u4EC5\u5141\u8BB8guest</p><p><img src="'+K+'" alt="image-20211209212152137"></p><ol start="2"><li>\u521B\u5EFA\u4E00\u4E2A\u7528\u6237</li></ol><p>\u521B\u5EFAems\u7528\u6237\uFF0C\u5148\u8D4B\u4E88admin\u6743\u9650</p><p><img src="'+V+'" alt="image-20211209212421513"></p><ol start="3"><li>\u7ED1\u5B9A\u6211\u4EEC\u521A\u624D\u521B\u5EFA\u7684\u865A\u62DF\u4E3B\u673A/ems</li></ol><p>\u70B9\u51FB\u7528\u6237\u540D\uFF0C\u7136\u540E\u5728<code>set permission</code>\u6807\u7B7E\u4E2D\u8BBE\u7F6E\u865A\u62DF\u4E3B\u673A\u4E3A<code>/ems</code>\uFF0C\u4E0B\u9762\u662F\u4E00\u4E9B\u914D\u7F6E\u7684\u6743\u9650\uFF0C\u53EF\u914D\u7F6E\u3001\u53EF\u5199\u3001\u53EF\u8BFB</p><p><img src="'+z+'" alt="image-20211209212826170"></p><ol start="4"><li>\u8FD9\u6837\u8BBE\u7F6E\u4E4B\u540E\u5C31\u53EF\u4EE5\u4E86\u770B\u5230ems\u5DF2\u7ECF\u548C/ems\u865A\u62DF\u4E3B\u673A\u7ED1\u5B9A\u5230\u4E00\u8D77\u4E86</li></ol><p><img src="'+W+`" alt="image-20211209212948402"></p><h4 id="\u7F16\u7801"><a class="header-anchor" href="#\u7F16\u7801" aria-hidden="true">#</a> \u7F16\u7801</h4><h5 id="\u751F\u4EA7\u8005"><a class="header-anchor" href="#\u751F\u4EA7\u8005" aria-hidden="true">#</a> \u751F\u4EA7\u8005</h5><p>\u5728\u5F15\u5165\u4F9D\u8D56\u5E76\u914D\u7F6Erabbitmq\u4E4B\u540E\uFF0C\u6211\u4EEC\u5C31\u53EF\u4EE5\u7F16\u5199\u6D4B\u8BD5\u4EE3\u7801\u751F\u6210\u6D88\u606F</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Producer</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * \u751F\u4EA7\u6D88\u606F
     */</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testSendMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">TimeoutException</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u521B\u5EFA\u8FDE\u63A5mq\u7684\u8FDE\u63A5\u5DE5\u5382\u5BF9\u8C61</span>
        <span class="token keyword">final</span> <span class="token class-name">ConnectionFactory</span> connectionFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConnectionFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u8BBE\u7F6E\u8FDE\u63A5mq\u7684\u4E3B\u673A</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setHost</span><span class="token punctuation">(</span><span class="token string">&quot;172.16.187.9&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u8BBE\u7F6E\u7AEF\u53E3\u53F7</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">5672</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u8BBE\u7F6E\u8FDE\u63A5\u7684\u865A\u62DF\u4E3B\u673A</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setVirtualHost</span><span class="token punctuation">(</span><span class="token string">&quot;/ems&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u8BBE\u7F6E\u7528\u6237\u540D\u548C\u5BC6\u7801</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">&quot;ems&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;123456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u83B7\u53D6\u8FDE\u63A5\u5BF9\u8C61</span>
        <span class="token keyword">final</span> <span class="token class-name">Connection</span> connection <span class="token operator">=</span> connectionFactory<span class="token punctuation">.</span><span class="token function">newConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u83B7\u53D6\u8FDE\u63A5\u4E2D\u7684\u901A\u9053\u5BF9\u8C61</span>
        <span class="token keyword">final</span> <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u901A\u9053\u7ED1\u5B9A\u5BF9\u5E94\u7684\u6D88\u606F\u961F\u5217</span>
        <span class="token comment">// \u961F\u5217\u53EF\u4EE5\u5728web\u7BA1\u7406\u754C\u9762\u53BB\u521B\u5EFA\uFF0C\u4E5F\u53EF\u4EE5\u901A\u8FC7\u4EE3\u7801\u53BB\u521B\u5EFA</span>
        <span class="token doc-comment comment">/**
         * \u53C2\u65701\uFF1A\u961F\u5217\u7684\u540D\u79F0\uFF0C\u5982\u679C\u961F\u5217\u4E0D\u5B58\u5728\uFF0C\u5C31\u4F1A\u81EA\u52A8\u521B\u5EFA
         * \u53C2\u65702\uFF1A\u7528\u6765\u5B9A\u4E49\u961F\u5217\u7684\u7279\u6027\u662F\u5426\u8981\u6301\u4E45\u5316\uFF0Ctrue\u8868\u793A\u6301\u4E45\u5316
         * \u53C2\u65703\uFF1Aexclusive \u662F\u5426\u72EC\u5360\u961F\u5217\uFF0C\u4EE3\u8868\u5F53\u524D\u961F\u5217\u53EA\u5141\u8BB8\u5F53\u524D\u8FD9\u4E2A\u8FDE\u63A5\u53EF\u7528\uFF0C\u5176\u4ED6\u7684\u8FDE\u63A5\u4E0D\u53EF\u7528 true \u72EC\u5360\u961F\u5217
         * \u53C2\u65704\uFF1AautoDelete \u662F\u5426\u5728\u6D88\u8D39\u5B8C\u6210\u4E4B\u540E\u81EA\u52A8\u5220\u9664\u961F\u5217\uFF0Ctrue \u81EA\u52A8\u5220\u9664
         * \u53C2\u65705\uFF1A\u989D\u5916\u9644\u52A0\u53C2\u6570
         */</span>
        channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u53D1\u5E03\u6D88\u606F</span>
        <span class="token doc-comment comment">/**
         * \u53C2\u65701\uFF1A\u4EA4\u6362\u673A\u540D\u79F0\uFF0C\u7B80\u5355\u6A21\u5F0F\u76F4\u63A5\u8FDE\u63A5\u5230\u961F\u5217\uFF0C\u8D4B\u503C\u4E3A&quot;&quot;
         * \u53C2\u65702\uFF1A\u961F\u5217\u540D\u79F0
         * \u53C2\u65703\uFF1A\u4F20\u9012\u6D88\u606F\u7684\u989D\u5916\u8BBE\u7F6E
         * \u53C2\u65704\uFF1A\u6D88\u606F\u7684\u5177\u4F53\u5185\u5BB9
         */</span>
        channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot;hello rabbitmq&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        channel<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u53D1\u9001\u6210\u529F</p><p><img src="`+J+'" alt="image-20211209215445344"></p><p>\u67E5\u770Brabbitmq\u7BA1\u7406\u754C\u9762</p><p><img src="'+G+`" alt="image-20211209215624198"></p><h5 id="\u6D88\u8D39\u8005"><a class="header-anchor" href="#\u6D88\u8D39\u8005" aria-hidden="true">#</a> \u6D88\u8D39\u8005</h5><blockquote><p>\u5728Junit\u6D4B\u8BD5\u6A21\u5F0F\u4E2D\u662F\u5355\u7EBF\u7A0B\u7684\u6A21\u5F0F\uFF0C\u6240\u4EE5\u6CA1\u6709\u529E\u6CD5\u8BA9\u6D88\u8D39\u4E00\u76F4\u76D1\u542C\uFF0C\u6240\u4EE5\u6362\u6210main\u51FD\u6570</p><p>\u4E0D\u50CF\u751F\u4EA7\u8005\uFF0C\u751F\u4EA7\u8005\u751F\u4EA7\u5B8C\u6D88\u606F\u4E4B\u540E\u5C31\u5B8C\u4E8B\u4E86\uFF0C\u6D88\u8D39\u8005\u662F\u8981\u4E00\u76F4\u53BB\u76D1\u542C\u7684</p></blockquote><p>\u6D88\u8D39\u8005\u6D4B\u8BD5\u4EE3\u7801</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * \u6D88\u8D39\u6D88\u606F
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Consumer</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">TimeoutException</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u521B\u5EFA\u8FDE\u63A5mq\u7684\u8FDE\u63A5\u5DE5\u5382\u5BF9\u8C61</span>
        <span class="token keyword">final</span> <span class="token class-name">ConnectionFactory</span> connectionFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConnectionFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u8BBE\u7F6E\u8FDE\u63A5mq\u7684\u4E3B\u673A</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setHost</span><span class="token punctuation">(</span><span class="token string">&quot;172.16.187.9&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u8BBE\u7F6E\u7AEF\u53E3\u53F7</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">5672</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u8BBE\u7F6E\u8FDE\u63A5\u7684\u865A\u62DF\u4E3B\u673A</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setVirtualHost</span><span class="token punctuation">(</span><span class="token string">&quot;/ems&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u8BBE\u7F6E\u7528\u6237\u540D\u548C\u5BC6\u7801</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">&quot;ems&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;123456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u83B7\u53D6\u8FDE\u63A5\u5BF9\u8C61</span>
        <span class="token keyword">final</span> <span class="token class-name">Connection</span> connection <span class="token operator">=</span> connectionFactory<span class="token punctuation">.</span><span class="token function">newConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u83B7\u53D6\u8FDE\u63A5\u4E2D\u7684\u901A\u9053\u5BF9\u8C61</span>
        <span class="token keyword">final</span> <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u901A\u9053\u7ED1\u5B9A\u5BF9\u5E94\u7684\u6D88\u606F\u961F\u5217</span>
        <span class="token comment">// \u961F\u5217\u53EF\u4EE5\u5728web\u7BA1\u7406\u754C\u9762\u53BB\u521B\u5EFA\uFF0C\u4E5F\u53EF\u4EE5\u901A\u8FC7\u4EE3\u7801\u53BB\u521B\u5EFA</span>
        <span class="token doc-comment comment">/**
         * \u53C2\u65701\uFF1A\u961F\u5217\u7684\u540D\u79F0\uFF0C\u5982\u679C\u961F\u5217\u4E0D\u5B58\u5728\uFF0C\u5C31\u4F1A\u81EA\u52A8\u521B\u5EFA
         * \u53C2\u65702\uFF1A\u7528\u6765\u5B9A\u4E49\u961F\u5217\u7684\u7279\u6027\u662F\u5426\u8981\u6301\u4E45\u5316\uFF0Ctrue\u8868\u793A\u6301\u4E45\u5316
         * \u53C2\u65703\uFF1Aexclusive \u662F\u5426\u72EC\u5360\u961F\u5217\uFF0C\u4EE3\u8868\u5F53\u524D\u961F\u5217\u53EA\u5141\u8BB8\u5F53\u524D\u8FD9\u4E2A\u8FDE\u63A5\u53EF\u7528\uFF0C\u5176\u4ED6\u7684\u8FDE\u63A5\u4E0D\u53EF\u7528 true \u72EC\u5360\u961F\u5217
         * \u53C2\u65704\uFF1AautoDelete \u662F\u5426\u5728\u6D88\u8D39\u5B8C\u6210\u4E4B\u540E\u81EA\u52A8\u5220\u9664\u961F\u5217\uFF0Ctrue \u81EA\u52A8\u5220\u9664
         * \u53C2\u65705\uFF1A\u989D\u5916\u9644\u52A0\u53C2\u6570
         */</span>
        channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u6D88\u8D39\u6D88\u606F</span>
        <span class="token doc-comment comment">/**
         * \u53C2\u65701\uFF1A\u6D88\u8D39\u90A3\u4E2A\u961F\u5217\u7684\u6D88\u606F\uFF0C\u961F\u5217\u7684\u540D\u79F0
         * \u53C2\u65702\uFF1A\u5F00\u542F\u6D88\u606F\u7684\u81EA\u52A8\u786E\u8BA4\u673A\u5236
         * \u53C2\u65703\uFF1A\u6D88\u8D39\u6D88\u606F\u7684\u56DE\u8C03\u63A5\u53E3
         */</span>
        channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token doc-comment comment">/**
             * <span class="token keyword">@param</span> <span class="token parameter">consumerTag</span> \u6D88\u606F\u4F20\u9012\u8FC7\u7A0B\u4E2D\u7684\u4FE1\u5C01\uFF0C\u4F20\u9012\u7684\u4E00\u4E9B\u5C5E\u6027
             * <span class="token keyword">@param</span> <span class="token parameter">envelope</span>
             * <span class="token keyword">@param</span> <span class="token parameter">properties</span>
             * <span class="token keyword">@param</span> <span class="token parameter">body</span> \u6D88\u606F\u961F\u5217\u4E2D\u53D6\u51FA\u7684\u6D88\u606F
             * <span class="token keyword">@throws</span> <span class="token reference"><span class="token class-name">IOException</span></span>
             */</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> <span class="token class-name">AMQP<span class="token punctuation">.</span>BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;new String(body)=&quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;, date=&quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u5982\u679C\u4E0D\u5173\u95ED\u5C31\u4F1A\u4E00\u76F4\u76D1\u542C\u961F\u5217</span>
        <span class="token comment">//channel.close();</span>
        <span class="token comment">//connection.close();</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6267\u884C\u7ED3\u679C</p><blockquote><p>\u5982\u679C\u4F7F\u7528Junit\u6216\u8005\u5728\u6D88\u8D39\u5B8C\u4E4B\u540E\u76F4\u63A5\u5173\u95ED\u662F\u4E0D\u4F1A\u7B49\u5F85\u56DE\u8C03\u6D88\u606F\u51FD\u6570\u6267\u884C\u5C31\u9000\u51FA\u4E86</p><p>\u6240\u4EE5\u4E0D\u5EFA\u8BAE\u5173\u95ED\u901A\u9053\u548C\u8FDE\u63A5</p></blockquote><p><img src="`+Y+`" alt="image-20211209222548013"></p><blockquote><p>\u70B9\u5BF9\u70B9\u7684\u6D88\u606F\u6A21\u5F0F\u9002\u7528\u4E8E\u767B\u5F55\u3001\u6CE8\u518C\u7B49\u8FD9\u4E9B\u5355\u70B9\u7684\u6A21\u5F0F\u4E2D\uFF0C\u6BD4\u5982\u5F53\u6211\u4EEC\u4F7F\u7528\u624B\u673A\u53F7\u6216\u8005\u90AE\u7BB1\u767B\u5F55/\u6CE8\u518C\u65F6\u53D1\u9001\u7684\u9A8C\u8BC1\u7801</p></blockquote><h4 id="\u8FDE\u63A5\u5DE5\u5177\u7C7B\u7684\u5C01\u88C5"><a class="header-anchor" href="#\u8FDE\u63A5\u5DE5\u5177\u7C7B\u7684\u5C01\u88C5" aria-hidden="true">#</a> \u8FDE\u63A5\u5DE5\u5177\u7C7B\u7684\u5C01\u88C5</h4><p>\u5728\u4E8Erabbitmq\u901A\u4FE1\u7684\u8FC7\u7A0B\u4E2D\uFF0C\u83B7\u53D6\u8FDE\u63A5\u5BF9\u8C61\u7684\u8FC7\u7A0B\u662F\u5B58\u5728\u5927\u91CF\u7684\u5197\u4F59\u7684\uFF0C\u5C31\u50CF\u83B7\u53D6MySQL\u6570\u636E\u5E93\u8FDE\u63A5\u4E00\u6837\uFF0C\u6240\u4EE5\u53EF\u4EE5\u5C31\u53EF\u4EE5\u5C01\u88C5\u6210\u5DE5\u5177\u7C7B</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RabbitMQUtils</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * \u8FDE\u63A5\u5DE5\u5382\u5C5E\u4E8E\u91CD\u91CF\u7EA7\u8D44\u6E90
     * \u5BF9\u4E8E\u91CD\u91CF\u7EA7\u8D44\u6E90\u6765\u8BF4\uFF0C\u4E0D\u80FD\u8BF4\u6CA1\u62FF\u4E00\u6B21\u8FDE\u63A5\u5C31\u521B\u5EFA\u4E00\u6B21\u5DE5\u5382\uFF0C\u4EE3\u4EF7\u6709\u70B9\u5927\uFF0C\u6240\u4EE5\u6211\u4EEC\u66F4\u5E0C\u671B\u5728\u521B\u5EFA\u7684\u65F6\u5019\u53EA\u521B\u5EFA\u4E00\u6B21
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">ConnectionFactory</span> connectionFactory<span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u7C7B\u52A0\u8F7D\u7684\u65F6\u5019\u6267\u884C\uFF0C\u53EA\u6267\u884C\u4E00\u6B21</span>
        connectionFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConnectionFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u5982\u679C\u5BF9\u4E8E\u9879\u76EE\u5F53\u524D\u7684rabbitmq\u4FE1\u606F\u662F\u4E0D\u53D8\u7684\uFF08\u4E00\u822C\u662F\u4E0D\u53D8\u7684\uFF0C\u4E00\u65E6\u786E\u5B9A\u4E0B\u6765\u5C31\u5F88\u5C11\u53D8\u5316\uFF09\uFF0C\u53EF\u4EE5\u628A\u5C5E\u6027\u7684\u8D4B\u503C\u4E5F\u653E\u5728\u8FD9\u91CC</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setHost</span><span class="token punctuation">(</span><span class="token string">&quot;172.16.187.9&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setPort</span><span class="token punctuation">(</span><span class="token number">5672</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setVirtualHost</span><span class="token punctuation">(</span><span class="token string">&quot;/ems&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token string">&quot;ems&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        connectionFactory<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token string">&quot;123456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u5B9A\u4E49\u63D0\u4F9B\u8FDE\u63A5\u5BF9\u8C61\u7684\u65B9\u6CD5
     *
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Connection</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>

            <span class="token keyword">return</span> connectionFactory<span class="token punctuation">.</span><span class="token function">newConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u5173\u95ED\u901A\u9053\u548C\u5173\u95ED\u8FDE\u63A5\u7684\u65B9\u6CD5
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">closeConnectionAndChannel</span><span class="token punctuation">(</span><span class="token class-name">Channel</span> channel<span class="token punctuation">,</span> <span class="token class-name">Connection</span> connection<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>channel <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                channel<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>connection <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="api\u53C2\u6570\u7EC6\u8282"><a class="header-anchor" href="#api\u53C2\u6570\u7EC6\u8282" aria-hidden="true">#</a> API\u53C2\u6570\u7EC6\u8282</h4><p>\u901A\u8FC7\u7B2C\u4E00\u79CD\u6A21\u578B\uFF0C\u4E86\u89E3API\u76F8\u5173\u7684\u7EC6\u8282</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * \u53C2\u65701\uFF1A\u961F\u5217\u7684\u540D\u79F0\uFF0C\u5982\u679C\u961F\u5217\u4E0D\u5B58\u5728\uFF0C\u5C31\u4F1A\u81EA\u52A8\u521B\u5EFA
 * \u53C2\u65702\uFF1A\u7528\u6765\u5B9A\u4E49\u961F\u5217\u7684\u7279\u6027\u662F\u5426\u8981\u6301\u4E45\u5316\uFF0Ctrue\u8868\u793A\u6301\u4E45\u5316\uFF0C\u8BBE\u7F6E\u4E3Afalse\u65F6\uFF0C\u5F53rabbitmq\u91CD\u65B0\u542F\u52A8\u7684\u65F6\u5019\uFF0C\u90FD\u4F1A\u6D88\u5931\uFF0C\u662F\u961F\u5217\u7684\u6301\u4E45\u5316\uFF0C\u4E0D\u662F\u6D88\u606F\u7684\u6301\u4E45\u5316\uFF0C\u8981\u505A\u6D88\u606F\u7684\u6301\u4E45\u5316\u5C31\u8981\u5728\u53D1\u9001\u6D88\u606F\u7684\u65F6\u5019\u660E\u786E\u544A\u8BC9rabbitmq\u8981\u6301\u4E45\u5316
 * \u53C2\u65703\uFF1Aexclusive \u662F\u5426\u72EC\u5360\u961F\u5217\uFF0C\u4EE3\u8868\u5F53\u524D\u961F\u5217\u53EA\u5141\u8BB8\u5F53\u524D\u8FD9\u4E2A\u8FDE\u63A5\u53EF\u7528\uFF0C\u5176\u4ED6\u7684\u8FDE\u63A5\u4E0D\u53EF\u7528 true \u72EC\u5360\u961F\u5217
 * \u53C2\u65704\uFF1AautoDelete \u662F\u5426\u5728\u6D88\u8D39\u5B8C\u6210\u4E4B\u540E(\u6D88\u8D39\u8005\u5F7B\u5E95\u65AD\u5F00\u8FDE\u63A5\u4E4B\u540E)\u81EA\u52A8\u5220\u9664\u961F\u5217\uFF0Ctrue \u81EA\u52A8\u5220\u9664
 * \u53C2\u65705\uFF1A\u989D\u5916\u9644\u52A0\u53C2\u6570
 */</span>
channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * \u53C2\u65701\uFF1A\u4EA4\u6362\u673A\u540D\u79F0\uFF0C\u7B80\u5355\u6A21\u5F0F\u76F4\u63A5\u8FDE\u63A5\u5230\u961F\u5217\uFF0C\u8D4B\u503C\u4E3A&quot;&quot;
 * \u53C2\u65702\uFF1A\u961F\u5217\u540D\u79F0
 * \u53C2\u65703\uFF1A\u4F20\u9012\u6D88\u606F\u7684\u989D\u5916\u8BBE\u7F6E
 *  - MessageProperties.PERSISTENT_TEXT_PLAIN \u544A\u8BC9rabbitmq\u5C06\u6D88\u606F\u6301\u4E45\u5316
 * \u53C2\u65704\uFF1A\u6D88\u606F\u7684\u5177\u4F53\u5185\u5BB9
 */</span>
channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token class-name">MessageProperties</span><span class="token punctuation">.</span>PERSISTENT_TEXT_PLAIN<span class="token punctuation">,</span> <span class="token string">&quot;hello rabbitmq&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u7B2C\u4E8C\u79CD\u6A21\u578B"><a class="header-anchor" href="#\u7B2C\u4E8C\u79CD\u6A21\u578B" aria-hidden="true">#</a> \u7B2C\u4E8C\u79CD\u6A21\u578B</h3><p>(work queue)</p><p>work queue\uFF0C\u4E5F\u88AB\u79F0\u4E3A\uFF08task queues\uFF09\u4EFB\u52A1\u6A21\u578B\uFF0C\u5F53\u6D88\u606F\u5904\u7406\u6BD4\u8F83\u8017\u65F6\u7684\u65F6\u5019\uFF0C\u53EF\u80FD\u4F1A\u4EA7\u751F\u6D88\u606F\u7684\u901F\u5EA6\u8FDC\u8FDC\u5927\u4E8E\u6D88\u606F\u7684\u6D88\u8D39\u901F\u5EA6\uFF0C\u957F\u6B64\u4EE5\u5F80\uFF0C\u6D88\u606F\u5C31\u4F1A\u5806\u79EF\u8D8A\u6765\u8D8A\u591A\uFF0C\u65E0\u6CD5\u53CA\u65F6\u5904\u7406\u3002\u6B64\u65F6\u5C31\u53EF\u4EE5\u4F7F\u7528work\u6A21\u578B\uFF1A\u8BA9\u591A\u4E2A\u6D88\u606F\u8005\u7ED1\u5B9A\u5230\u4E00\u4E2A\u961F\u5217\uFF0C\u5171\u540C\u6D88\u8D39\u961F\u5217\u4E2D\u7684\u6D88\u606F\u3002\u961F\u5217\u4E2D\u7684\u6D88\u606F\u4E00\u65E6\u6D88\u8D39\uFF0C\u5C31\u4F1A\u6D88\u5931\uFF0C\u56E0\u6B64\u4EFB\u52A1\u4E0D\u4F1A\u91CD\u590D\u6267\u884C</p><p><img src="`+X+`" alt="img"></p><p>\u89D2\u8272\uFF1A</p><ul><li>P \u751F\u4EA7\u8005 \u4EFB\u52A1\u7684\u53D1\u5E03\u8005</li><li>C1 \u6D88\u8D39\u8005\uFF0C\u9886\u53D6\u4EFB\u52A1\u5E76\u5B8C\u6210\u4EFB\u52A1\uFF0C\u5047\u8BBE\u5B8C\u6210\u901F\u5EA6\u8F83\u6162</li><li>C2 \u6D88\u8D39\u8005\uFF0C\u9886\u53D6\u4EFB\u52A1\u5E76\u5B8C\u6210\u4EFB\u52A1\uFF0C\u5047\u8BBE\u5B8C\u6210\u901F\u5EA6\u8F83\u6162</li></ul><h4 id="\u5F00\u53D1\u751F\u4EA7\u8005"><a class="header-anchor" href="#\u5F00\u53D1\u751F\u4EA7\u8005" aria-hidden="true">#</a> \u5F00\u53D1\u751F\u4EA7\u8005</h4><p>\u8FDE\u63A5\u7528\u7684\u5DE5\u5177\u7C7B\u8FD8\u662F\u4F7F\u7528\u7B2C\u4E00\u79CD\u6A21\u5F0F\u4E2D\u5C01\u88C5\u7684\u5DE5\u5177\u7C7B\u578B</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * \u751F\u4EA7\u6D88\u606F
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Producer</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * \u751F\u4EA7\u6D88\u606F
     */</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testSendMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>

        <span class="token comment">// \u83B7\u53D6\u8FDE\u63A5\u5BF9\u8C61</span>
        <span class="token keyword">final</span> <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u83B7\u53D6\u8FDE\u63A5\u4E2D\u7684\u901A\u9053\u5BF9\u8C61</span>
        <span class="token keyword">assert</span> connection <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u901A\u9053\u7ED1\u5B9A\u5BF9\u5E94\u7684\u6D88\u606F\u961F\u5217</span>
        channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;work&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// \u53D1\u5E03\u6D88\u606F</span>
            channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;work&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token string">&quot; hello work rabbitmq&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">closeConnectionAndChannel</span><span class="token punctuation">(</span>channel<span class="token punctuation">,</span> connection<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u5F00\u53D1\u6D88\u8D39\u8005-1"><a class="header-anchor" href="#\u5F00\u53D1\u6D88\u8D39\u8005-1" aria-hidden="true">#</a> \u5F00\u53D1\u6D88\u8D39\u8005-1</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * \u6D88\u8D39\u6D88\u606F
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Consumer1</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>

        <span class="token comment">// \u83B7\u53D6\u8FDE\u63A5\u5BF9\u8C61</span>
        <span class="token keyword">final</span> <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u83B7\u53D6\u8FDE\u63A5\u4E2D\u7684\u901A\u9053\u5BF9\u8C61</span>
        <span class="token keyword">assert</span> connection <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u901A\u9053\u7ED1\u5B9A\u5BF9\u5E94\u7684\u6D88\u606F\u961F\u5217</span>
        channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;work&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u6D88\u8D39\u6D88\u606F</span>
        channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span><span class="token string">&quot;work&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> <span class="token class-name">AMQP<span class="token punctuation">.</span>BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u6D88\u8D39\u8005-1 &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;, date=&quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u5F00\u53D1\u6D88\u8D39\u8005-2"><a class="header-anchor" href="#\u5F00\u53D1\u6D88\u8D39\u8005-2" aria-hidden="true">#</a> \u5F00\u53D1\u6D88\u8D39\u8005-2</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * \u6D88\u8D39\u6D88\u606F
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Consumer2</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>

        <span class="token comment">// \u83B7\u53D6\u8FDE\u63A5\u5BF9\u8C61</span>
        <span class="token keyword">final</span> <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u83B7\u53D6\u8FDE\u63A5\u4E2D\u7684\u901A\u9053\u5BF9\u8C61</span>
        <span class="token keyword">assert</span> connection <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u901A\u9053\u7ED1\u5B9A\u5BF9\u5E94\u7684\u6D88\u606F\u961F\u5217</span>
        channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;work&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u6D88\u8D39\u6D88\u606F</span>
        channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span><span class="token string">&quot;work&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> <span class="token class-name">AMQP<span class="token punctuation">.</span>BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u6D88\u8D39\u8005-2 &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;, date=&quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u6D4B\u8BD5\u7ED3\u679C"><a class="header-anchor" href="#\u6D4B\u8BD5\u7ED3\u679C" aria-hidden="true">#</a> \u6D4B\u8BD5\u7ED3\u679C</h4><p><img src="`+Z+'" alt="image-20211209235035269"></p><p><img src="'+$+'" alt="image-20211209235022376"></p><blockquote><p>\u603B\u7ED3\uFF1A\u5728\u9ED8\u8BA4\u7684\u60C5\u51B5\u4E0B\uFF0Crabbitmq\u5C06\u6309\u987A\u5E8F\u5C06\u6BCF\u4E2A\u6D88\u606F\u53D1\u9001\u7ED9\u4E0B\u4E00\u4E2A\u4F7F\u7528\u8005\u3002\u5E73\u5747\u800C\u8A00\uFF0C\u6BCF\u4E2A\u6D88\u8D39\u8005\u90FD\u4F1A\u6536\u5230\u76F8\u540C\u6570\u91CF\u7684\u6D88\u606F\u3002\u8FD9\u79CD\u5206\u53D1\u6D88\u606F\u7684\u65B9\u5F0F\u79F0\u4E3A\u5FAA\u73AF</p><p>\u5E73\u5747\u5206\u914D\u4F1A\u51FA\u73B0\u7684\u95EE\u9898\uFF1A\u6709\u7684\u6D88\u8D39\u8005\u5904\u7406\u5F97\u5FEB\uFF0C\u6709\u7684\u6D88\u8D39\u8005\u5904\u7406\u5F97\u6162\uFF0C\u90A3\u4E48\u5C31\u4F1A\u5BFC\u81F4\u5904\u7406\u6162\u7684\u6D88\u8D39\u8005\u6D88\u606F\u5806\u79EF\uFF0C\u800C\u5904\u7406\u5F97\u5FEB\u7684\u6D88\u8D39\u8005\u5DF2\u7ECF\u7A7A\u95F2\u4E86\uFF0C\u6211\u4EEC\u66F4\u5E0C\u671B\u5728\u5206\u914D\u6D88\u606F\u7684\u65F6\u5019\u80FD\u591F<strong>\u80FD\u8005\u591A\u52B3</strong></p></blockquote><h4 id="\u6D88\u606F\u81EA\u52A8\u786E\u8BA4\u673A\u5236"><a class="header-anchor" href="#\u6D88\u606F\u81EA\u52A8\u786E\u8BA4\u673A\u5236" aria-hidden="true">#</a> \u6D88\u606F\u81EA\u52A8\u786E\u8BA4\u673A\u5236</h4><blockquote><p>Doing a task can take a few seconds. You may wonder what happens if one of the consumers starts a long task and dies with it only partly done. With our current code once RabbitMQ delivers message to the consumer it immediately marks it for deletion. In this case, if you kill a worker we will lose the message it was just processing. We&#39;ll also lose all the messages that were dispatched to this particular worker but were not yet handled.</p><p>But we don&#39;t want to lose any tasks. If a worker dies, we&#39;d like the task to be delivered to another worker.</p><p>\u7FFB\u8BD1\uFF1A</p><p>\u5B8C\u6210\u4E00\u9879\u4EFB\u52A1\u53EF\u80FD\u9700\u8981\u51E0\u79D2\u949F\u3002\u60A8\u53EF\u80FD\u60F3\u77E5\u9053\u5982\u679C\u5176\u4E2D\u4E00\u4E2A\u6D88\u8D39\u8005\u5F00\u59CB\u4E86\u4E00\u9879\u957F\u671F\u4EFB\u52A1\u5E76\u4E14\u53EA\u5B8C\u6210\u4E86\u90E8\u5206\u4EFB\u52A1\u800C\u6B7B\u4EA1\uFF0C\u4F1A\u53D1\u751F\u4EC0\u4E48\u3002\u4F7F\u7528\u6211\u4EEC\u5F53\u524D\u7684\u4EE3\u7801\uFF0C\u4E00\u65E6 RabbitMQ \u5C06\u6D88\u606F\u4F20\u9012\u7ED9\u6D88\u8D39\u8005\uFF0C\u5B83\u5C31\u4F1A\u7ACB\u5373\u5C06\u5176\u6807\u8BB0\u4E3A\u5220\u9664\u3002\u5728\u8FD9\u79CD\u60C5\u51B5\u4E0B\uFF0C\u5982\u679C\u4F60\u6740\u6B7B\u4E00\u4E2A\u5DE5\u4EBA\uFF0C\u6211\u4EEC\u5C06\u4E22\u5931\u5B83\u521A\u521A\u5904\u7406\u7684\u6D88\u606F\u3002\u6211\u4EEC\u8FD8\u5C06\u4E22\u5931\u6240\u6709\u5DF2\u5206\u6D3E\u7ED9\u8BE5\u7279\u5B9A\u5DE5\u4F5C\u4EBA\u5458\u4F46\u5C1A\u672A\u5904\u7406\u7684\u6D88\u606F\u3002</p><p>\u4F46\u6211\u4EEC\u4E0D\u60F3\u4E22\u5931\u4EFB\u4F55\u4EFB\u52A1\u3002\u5982\u679C\u4E00\u4E2A\u5DE5\u4EBA\u6B7B\u4E86\uFF0C\u6211\u4EEC\u5E0C\u671B\u5C06\u4EFB\u52A1\u4EA4\u7ED9\u53E6\u4E00\u4E2A\u5DE5\u4EBA\u3002</p><p><img src="'+nn+`" alt="image-20211210001128181"></p><ul><li>\u56E0\u4E3A\u81EA\u52A8\u786E\u8BA4\u673A\u5236\uFF0C\u5F53\u4EFB\u52A1\u4E00\u65E6\u5206\u914D\u51FA\u53BB\uFF0C\u6D88\u8D39\u8005\u5C31\u53CD\u9988\u7ED9\u961F\u5217\u8BF4\u5DF2\u7ECF\u6D88\u8D39\u4E86\uFF0C\u90A3\u4E48\u961F\u5217\u5C31\u4F1A\u7ACB\u5373\u5220\u9664</li></ul></blockquote><p>\u4E3A\u4E86\u4FDD\u8BC1\u80FD\u591F\u80FD\u8005\u591A\u52B3\uFF0C\u6211\u4EEC\u9700\u8981\uFF1A</p><ol><li>\u8BBE\u7F6E\u5F53\u524D\u901A\u9053\u53EA\u80FD\u5B58\u50A8\u4E00\u4E2A\u6D88\u606F</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// \u544A\u8BC9\u5F53\u524D\u7684\u961F\u5217\u6BCF\u6B21\u53EA\u80FD\u53D1\u9001\u4E00\u4E2A\u6D88\u606F\u7ED9\u6D88\u8D39\u8005\uFF0C\u6BCF\u6B21\u53EA\u80FD\u6D88\u8D39\u4E00\u4E2A\u6D88\u606F</span>
channel<span class="token punctuation">.</span><span class="token function">basicQos</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>\u5173\u95ED\u81EA\u52A8\u786E\u8BA4</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * \u53C2\u65701\uFF1A\u6D88\u8D39\u90A3\u4E2A\u961F\u5217\u7684\u6D88\u606F\uFF0C\u961F\u5217\u7684\u540D\u79F0
 * \u53C2\u65702\uFF1A\u5F00\u542F\u6D88\u606F\u7684\u81EA\u52A8\u786E\u8BA4\u673A\u5236\uFF0C\u8BBE\u7F6E\u4E3Afalse\uFF0C\u4E0D\u4F1A\u81EA\u52A8\u53BB\u786E\u8BA4\u6D88\u606F\uFF0C\u4E5F\u5C31\u662F\u8BF4\u5373\u4F7F\u88AB\u6D88\u8D39\u4E86\uFF0C\u4F46\u662F\u5728\u961F\u5217\u4E2D\u4E5F\u662F\u6807\u8BB0\u4E3A\u672A\u88AB\u6D88\u8D39\u7684
 * \u53C2\u65703\uFF1A\u6D88\u8D39\u6D88\u606F\u7684\u56DE\u8C03\u63A5\u53E3
 */</span>
channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span><span class="token string">&quot;work&quot;</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Override</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> <span class="token class-name">AMQP<span class="token punctuation">.</span>BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u6D88\u8D39\u8005-1 &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;, date=&quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// \u624B\u52A8\u786E\u8BA4</span>
    <span class="token doc-comment comment">/**
      * \u53C2\u65701\uFF1A\u786E\u8BA4\u7684\u662F\u961F\u5217\u4E2D\u7684\u90A3\u4E2A\u5177\u4F53\u7684\u6D88\u606F
      * \u53C2\u65702\uFF1A\u662F\u5426\u5F00\u542F\u591A\u4E2A\u6D88\u606F\u540C\u65F6\u786E\u8BA4
      */</span>
    channel<span class="token punctuation">.</span><span class="token function">basicAck</span><span class="token punctuation">(</span>envelope<span class="token punctuation">.</span><span class="token function">getDeliveryTag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>\u5904\u7406\u5B8C\u6210\u624B\u52A8\u786E\u8BA4</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// \u624B\u52A8\u786E\u8BA4</span>
<span class="token doc-comment comment">/**
 * \u53C2\u65701\uFF1A\u786E\u8BA4\u7684\u662F\u961F\u5217\u4E2D\u7684\u90A3\u4E2A\u5177\u4F53\u7684\u6D88\u606F
 * \u53C2\u65702\uFF1A\u662F\u5426\u5F00\u542F\u591A\u4E2A\u6D88\u606F\u540C\u65F6\u786E\u8BA4
 */</span>
channel<span class="token punctuation">.</span><span class="token function">basicAck</span><span class="token punctuation">(</span>envelope<span class="token punctuation">.</span><span class="token function">getDeliveryTag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u7B2C\u4E09\u79CD\u6A21\u578B"><a class="header-anchor" href="#\u7B2C\u4E09\u79CD\u6A21\u578B" aria-hidden="true">#</a> \u7B2C\u4E09\u79CD\u6A21\u578B</h3><p>(fanout)</p><blockquote><p>fanout\u4E5F\u79F0\u4E3A\u5E7F\u64AD\uFF0C\u53D1\u5E03-\u8BA2\u9605\u6A21\u5F0F\uFF0C\u6240\u6709\u8BA2\u9605\u4E86\u7684\u6D88\u8D39\u8005\u90FD\u80FD\u63A5\u6536\u5E76\u5904\u7406\u8FD9\u4E2A\u6D88\u606F</p></blockquote><p><img src="`+sn+`" alt="img"></p><p>\u5728\u5E7F\u64AD\u6A21\u5F0F\u4E0B\uFF0C\u6D88\u606F\u53D1\u9001\u6D41\u7A0B\u662F\u8FD9\u6837\u7684\uFF1A</p><ul><li>\u53EF\u4EE5\u6709\u591A\u4E2A\u6D88\u606F</li><li>\u6BCF\u4E2A\u6D88\u8D39\u8005\u6709\u81EA\u5DF1\u7684queue\uFF08\u961F\u5217\uFF09\uFF0C\u4E3A\u4E86\u4E0D\u6D88\u8017\u8D44\u6E90\uFF0C\u6211\u4EEC\u521B\u5EFA\u4E34\u65F6\u961F\u5217\uFF0C\u5F53\u6D88\u8D39\u8005\u786E\u8BA4\u5904\u7406\u5B8C\u6210\uFF0C\u961F\u5217\u5C31\u4F1A\u81EA\u52A8\u9500\u6BC1</li><li>\u6BCF\u4E2A\u961F\u5217\u90FD\u8981\u7ED1\u5B9A\u5230exchange\uFF08\u4EA4\u6362\u673A\uFF09</li><li>\u751F\u4EA7\u8005\u53D1\u9001\u7684\u6D88\u606F\uFF0C\u53EA\u80FD\u53D1\u9001\u7ED9\u4EA4\u6362\u673A\uFF0C\u4EA4\u6362\u673A\u6765\u51B3\u5B9A\u8981\u53D1\u7ED9\u54EA\u4E2A\u961F\u5217\uFF0C\u751F\u4EA7\u8005\u65E0\u6CD5\u51B3\u5B9A</li><li>\u4EA4\u6362\u673A\u628A\u6D88\u606F\u53D1\u9001\u7ED9\u7ED1\u5B9A\u8FC7\u7684\u6240\u6709\u961F\u5217</li><li>\u961F\u5217\u7684\u6D88\u8D39\u8005\u90FD\u80FD\u62FF\u5230\u6D88\u606F\uFF0C\u5B9E\u73B0\u4E00\u6761\u6D88\u606F\u88AB\u591A\u4E2A\u6D88\u8D39\u8005\u6D88\u8D39</li></ul><h4 id="\u5F00\u53D1\u751F\u4EA7\u8005-1"><a class="header-anchor" href="#\u5F00\u53D1\u751F\u4EA7\u8005-1" aria-hidden="true">#</a> \u5F00\u53D1\u751F\u4EA7\u8005</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * \u751F\u4EA7\u6D88\u606F
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Producer</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * \u751F\u4EA7\u6D88\u606F
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>

        <span class="token comment">// \u83B7\u53D6\u8FDE\u63A5\u5BF9\u8C61</span>
        <span class="token keyword">final</span> <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u83B7\u53D6\u8FDE\u63A5\u4E2D\u7684\u901A\u9053\u5BF9\u8C61</span>
        <span class="token keyword">assert</span> connection <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u5C06\u901A\u9053\u58F0\u660E\u6307\u5B9A\u4EA4\u6362\u673A</span>
        <span class="token doc-comment comment">/**
         * \u53C2\u65701\uFF1A\u4EA4\u6362\u673A\u7684\u540D\u79F0 rabbitmq\u4E2D\u5982\u679C\u4E0D\u5B58\u5728\u8FD9\u4E2A\u540D\u79F0\u7684\u4EA4\u6362\u673A\u4F1A\u521B\u5EFA \u53EF\u4EE5\u968F\u610F\u6307\u5B9A\uFF0C\u548C\u4E1A\u52A1\u540D\u79F0\u4E00\u6837\u5C31\u597D\uFF0C\u6BD4\u5982\uFF1Alogs \u65E5\u5FD7\uFF1Bregister \u6CE8\u518C\uFF1Blogin \u767B\u5F55
         * \u53C2\u65702\uFF1A\u4EA4\u6362\u673A\u7684\u7C7B\u578B fanout\u8868\u793A\u5E7F\u64AD\u7C7B\u578B
         */</span>
        channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;logs&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;fanout&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u53D1\u9001\u6D88\u606F</span>
        <span class="token doc-comment comment">/**
         * \u53C2\u65701\uFF1A\u4EA4\u6362\u673A
         * \u53C2\u65702\uFF1A\u6D88\u606F\u961F\u5217\uFF0C\u7F6E\u7A7A\uFF0C\u8BA9\u4EA4\u6362\u673A\u53BB\u9009\u62E9
         */</span>
        channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span><span class="token string">&quot;logs&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot;fanout type message&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">closeConnectionAndChannel</span><span class="token punctuation">(</span>channel<span class="token punctuation">,</span> connection<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E3B\u8981\u5728<code>channel.exchangeDeclare(&quot;logs&quot;, &quot;fanout&quot;);</code>\u914D\u7F6E\u4EA4\u6362\u673A\u5E76\u4E14\u8BBE\u7F6E\u6D88\u606F\u7C7B\u578B\u4E3Afanout</p><h4 id="\u5F00\u53D1\u6D88\u8D39\u8005-1-1"><a class="header-anchor" href="#\u5F00\u53D1\u6D88\u8D39\u8005-1-1" aria-hidden="true">#</a> \u5F00\u53D1\u6D88\u8D39\u8005-1</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * \u6D88\u8D39\u6D88\u606F
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Consumer1</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>

        <span class="token comment">// \u83B7\u53D6\u8FDE\u63A5\u5BF9\u8C61</span>
        <span class="token keyword">final</span> <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u83B7\u53D6\u8FDE\u63A5\u4E2D\u7684\u901A\u9053\u5BF9\u8C61</span>
        <span class="token keyword">assert</span> connection <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u901A\u9053\u7ED1\u5B9A\u4EA4\u6362\u673A</span>
        <span class="token doc-comment comment">/**
         * \u53C2\u65701\uFF1A\u4EA4\u6362\u673A\u540D\u79F0
         * \u53C2\u65702\uFF1A\u6D88\u606F\u7C7B\u578B\uFF0C\u5E7F\u64AD\u6A21\u5F0F\u4E0B\u662Ffanout
         */</span>
        channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;logs&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;fanout&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u521B\u5EFA\u4E34\u65F6\u961F\u5217</span>
        <span class="token doc-comment comment">/**
         * \u4F1A\u8FD4\u56DE\u4E00\u4E2A\u968F\u673A\u540D\u79F0\u7684\u961F\u5217
         */</span>
        <span class="token keyword">final</span> <span class="token class-name">String</span> queueName <span class="token operator">=</span> channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u7ED1\u5B9A\u4EA4\u6362\u673A\u548C\u961F\u5217</span>
        <span class="token doc-comment comment">/**
         * \u53C2\u65701\uFF1A\u961F\u5217\u540D\u79F0
         * \u53C2\u65702\uFF1A\u4EA4\u6362\u673A\u540D\u79F0
         * \u53C2\u65703\uFF1A\u8DEF\u7531\u7684\u540D\u5B57\uFF0C\u5728fanout \u5E7F\u64AD\u4E2D\u662F\u8BA2\u9605\u4E86\u7684\u6D88\u8D39\u8005\u90FD\u4F1A\u63A5\u6536\u5230\u8FD9\u4E2A\u6D88\u606F\uFF0C\u4E0D\u9700\u8981\u8DEF\u7531
         */</span>
        channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>queueName<span class="token punctuation">,</span> <span class="token string">&quot;logs&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u6D88\u8D39\u6D88\u606F</span>
        <span class="token doc-comment comment">/**
         * \u53C2\u65701\uFF1A\u6D88\u8D39\u90A3\u4E2A\u961F\u5217\u7684\u6D88\u606F\uFF0C\u961F\u5217\u7684\u540D\u79F0
         * \u53C2\u65702\uFF1A\u5F00\u542F\u6D88\u606F\u7684\u81EA\u52A8\u786E\u8BA4\u673A\u5236\uFF0C\u8BBE\u7F6E\u4E3Afalse\uFF0C\u4E0D\u4F1A\u81EA\u52A8\u53BB\u786E\u8BA4\u6D88\u606F\uFF0C\u4E5F\u5C31\u662F\u8BF4\u5373\u4F7F\u88AB\u6D88\u8D39\u4E86\uFF0C\u4F46\u662F\u5728\u961F\u5217\u4E2D\u4E5F\u662F\u6807\u8BB0\u4E3A\u672A\u88AB\u6D88\u8D39\u7684
         * \u53C2\u65703\uFF1A\u6D88\u8D39\u6D88\u606F\u7684\u56DE\u8C03\u63A5\u53E3
         */</span>
        channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span>queueName<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> <span class="token class-name">AMQP<span class="token punctuation">.</span>BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u6D88\u8D39\u8005-1 &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;, date=&quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E09\u4E2A\u64CD\u4F5C\uFF1A</p><ul><li>\u901A\u9053\u7ED1\u5B9A\u4EA4\u6362\u673A</li><li>\u521B\u5EFA\u4E34\u65F6\u961F\u5217</li><li>\u7ED1\u5B9A\u4EA4\u6362\u673A\u548C\u961F\u5217</li></ul><h4 id="\u5F00\u53D1\u6D88\u8D39\u8005-2-1"><a class="header-anchor" href="#\u5F00\u53D1\u6D88\u8D39\u8005-2-1" aria-hidden="true">#</a> \u5F00\u53D1\u6D88\u8D39\u8005-2</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * \u6D88\u8D39\u6D88\u606F
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Consumer1</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>

        <span class="token comment">// \u83B7\u53D6\u8FDE\u63A5\u5BF9\u8C61</span>
        <span class="token keyword">final</span> <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u83B7\u53D6\u8FDE\u63A5\u4E2D\u7684\u901A\u9053\u5BF9\u8C61</span>
        <span class="token keyword">assert</span> connection <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u901A\u9053\u7ED1\u5B9A\u4EA4\u6362\u673A</span>
        <span class="token doc-comment comment">/**
         * \u53C2\u65701\uFF1A\u4EA4\u6362\u673A\u540D\u79F0
         * \u53C2\u65702\uFF1A\u6D88\u606F\u7C7B\u578B\uFF0C\u5E7F\u64AD\u6A21\u5F0F\u4E0B\u662Ffanout
         */</span>
        channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;logs&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;fanout&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u521B\u5EFA\u4E34\u65F6\u961F\u5217</span>
        <span class="token doc-comment comment">/**
         * \u4F1A\u8FD4\u56DE\u4E00\u4E2A\u968F\u673A\u540D\u79F0\u7684\u961F\u5217
         */</span>
        <span class="token keyword">final</span> <span class="token class-name">String</span> queueName <span class="token operator">=</span> channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u7ED1\u5B9A\u4EA4\u6362\u673A\u548C\u961F\u5217</span>
        <span class="token doc-comment comment">/**
         * \u53C2\u65701\uFF1A\u961F\u5217\u540D\u79F0
         * \u53C2\u65702\uFF1A\u4EA4\u6362\u673A\u540D\u79F0
         * \u53C2\u65703\uFF1A\u8DEF\u7531\u7684\u540D\u5B57\uFF0C\u5728fanout \u5E7F\u64AD\u4E2D\u662F\u8BA2\u9605\u4E86\u7684\u6D88\u8D39\u8005\u90FD\u4F1A\u63A5\u6536\u5230\u8FD9\u4E2A\u6D88\u606F\uFF0C\u4E0D\u9700\u8981\u8DEF\u7531
         */</span>
        channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>queueName<span class="token punctuation">,</span> <span class="token string">&quot;logs&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u6D88\u8D39\u6D88\u606F</span>
        <span class="token doc-comment comment">/**
         * \u53C2\u65701\uFF1A\u6D88\u8D39\u90A3\u4E2A\u961F\u5217\u7684\u6D88\u606F\uFF0C\u961F\u5217\u7684\u540D\u79F0
         * \u53C2\u65702\uFF1A\u5F00\u542F\u6D88\u606F\u7684\u81EA\u52A8\u786E\u8BA4\u673A\u5236\uFF0C\u8BBE\u7F6E\u4E3Afalse\uFF0C\u4E0D\u4F1A\u81EA\u52A8\u53BB\u786E\u8BA4\u6D88\u606F\uFF0C\u4E5F\u5C31\u662F\u8BF4\u5373\u4F7F\u88AB\u6D88\u8D39\u4E86\uFF0C\u4F46\u662F\u5728\u961F\u5217\u4E2D\u4E5F\u662F\u6807\u8BB0\u4E3A\u672A\u88AB\u6D88\u8D39\u7684
         * \u53C2\u65703\uFF1A\u6D88\u8D39\u6D88\u606F\u7684\u56DE\u8C03\u63A5\u53E3
         */</span>
        channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span>queueName<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> <span class="token class-name">AMQP<span class="token punctuation">.</span>BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u6D88\u8D39\u8005-1 &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;, date=&quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E09\u4E2A\u64CD\u4F5C\uFF1A</p><ul><li>\u901A\u9053\u7ED1\u5B9A\u4EA4\u6362\u673A</li><li>\u521B\u5EFA\u4E34\u65F6\u961F\u5217</li><li>\u7ED1\u5B9A\u4EA4\u6362\u673A\u548C\u961F\u5217</li></ul><h4 id="\u5F00\u53D1\u6D88\u8D39\u8005-3"><a class="header-anchor" href="#\u5F00\u53D1\u6D88\u8D39\u8005-3" aria-hidden="true">#</a> \u5F00\u53D1\u6D88\u8D39\u8005-3</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * \u6D88\u8D39\u6D88\u606F
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Consumer1</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>

        <span class="token comment">// \u83B7\u53D6\u8FDE\u63A5\u5BF9\u8C61</span>
        <span class="token keyword">final</span> <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u83B7\u53D6\u8FDE\u63A5\u4E2D\u7684\u901A\u9053\u5BF9\u8C61</span>
        <span class="token keyword">assert</span> connection <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u901A\u9053\u7ED1\u5B9A\u4EA4\u6362\u673A</span>
        <span class="token doc-comment comment">/**
         * \u53C2\u65701\uFF1A\u4EA4\u6362\u673A\u540D\u79F0
         * \u53C2\u65702\uFF1A\u6D88\u606F\u7C7B\u578B\uFF0C\u5E7F\u64AD\u6A21\u5F0F\u4E0B\u662Ffanout
         */</span>
        channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;logs&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;fanout&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u521B\u5EFA\u4E34\u65F6\u961F\u5217</span>
        <span class="token doc-comment comment">/**
         * \u4F1A\u8FD4\u56DE\u4E00\u4E2A\u968F\u673A\u540D\u79F0\u7684\u961F\u5217
         */</span>
        <span class="token keyword">final</span> <span class="token class-name">String</span> queueName <span class="token operator">=</span> channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u7ED1\u5B9A\u4EA4\u6362\u673A\u548C\u961F\u5217</span>
        <span class="token doc-comment comment">/**
         * \u53C2\u65701\uFF1A\u961F\u5217\u540D\u79F0
         * \u53C2\u65702\uFF1A\u4EA4\u6362\u673A\u540D\u79F0
         * \u53C2\u65703\uFF1A\u8DEF\u7531\u7684\u540D\u5B57\uFF0C\u5728fanout \u5E7F\u64AD\u4E2D\u662F\u8BA2\u9605\u4E86\u7684\u6D88\u8D39\u8005\u90FD\u4F1A\u63A5\u6536\u5230\u8FD9\u4E2A\u6D88\u606F\uFF0C\u4E0D\u9700\u8981\u8DEF\u7531
         */</span>
        channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>queueName<span class="token punctuation">,</span> <span class="token string">&quot;logs&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u6D88\u8D39\u6D88\u606F</span>
        <span class="token doc-comment comment">/**
         * \u53C2\u65701\uFF1A\u6D88\u8D39\u90A3\u4E2A\u961F\u5217\u7684\u6D88\u606F\uFF0C\u961F\u5217\u7684\u540D\u79F0
         * \u53C2\u65702\uFF1A\u5F00\u542F\u6D88\u606F\u7684\u81EA\u52A8\u786E\u8BA4\u673A\u5236\uFF0C\u8BBE\u7F6E\u4E3Afalse\uFF0C\u4E0D\u4F1A\u81EA\u52A8\u53BB\u786E\u8BA4\u6D88\u606F\uFF0C\u4E5F\u5C31\u662F\u8BF4\u5373\u4F7F\u88AB\u6D88\u8D39\u4E86\uFF0C\u4F46\u662F\u5728\u961F\u5217\u4E2D\u4E5F\u662F\u6807\u8BB0\u4E3A\u672A\u88AB\u6D88\u8D39\u7684
         * \u53C2\u65703\uFF1A\u6D88\u8D39\u6D88\u606F\u7684\u56DE\u8C03\u63A5\u53E3
         */</span>
        channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span>queueName<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> <span class="token class-name">AMQP<span class="token punctuation">.</span>BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u6D88\u8D39\u8005-1 &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;, date=&quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E09\u4E2A\u64CD\u4F5C\uFF1A</p><ul><li>\u901A\u9053\u7ED1\u5B9A\u4EA4\u6362\u673A</li><li>\u521B\u5EFA\u4E34\u65F6\u961F\u5217</li><li>\u7ED1\u5B9A\u4EA4\u6362\u673A\u548C\u961F\u5217</li></ul><h4 id="\u6D4B\u8BD5\u7ED3\u679C-1"><a class="header-anchor" href="#\u6D4B\u8BD5\u7ED3\u679C-1" aria-hidden="true">#</a> \u6D4B\u8BD5\u7ED3\u679C</h4><p>\u8BA2\u9605\u4E86logs\u7684\u6D88\u8D39\u8005\u90FD\u80FD\u63A5\u6536\u5230Provider\u53D1\u9001\u7684\u6D88\u606F</p><p><img src="`+an+'" alt="image-20211210021510413"></p><h3 id="\u7B2C\u56DB\u79CD\u6A21\u578B"><a class="header-anchor" href="#\u7B2C\u56DB\u79CD\u6A21\u578B" aria-hidden="true">#</a> \u7B2C\u56DB\u79CD\u6A21\u578B</h3><p>(routing)</p><h4 id="routing\u4E4B\u8BA2\u9605\u6A21\u578B-direct"><a class="header-anchor" href="#routing\u4E4B\u8BA2\u9605\u6A21\u578B-direct" aria-hidden="true">#</a> routing\u4E4B\u8BA2\u9605\u6A21\u578B-direct</h4><blockquote><p>\u5728fanout\u6A21\u5F0F\u4E2D\uFF0C\u4E00\u6761\u6D88\u606F\u4F1A\u88AB\u6240\u6709\u7684\u8BA2\u9605\u7684\u961F\u5217\u90FD\u6D88\u8D39\uFF0C\u4F46\u662F\u5728\u67D0\u4E9B\u573A\u666F\u4E0B\uFF0C\u6211\u4EEC\u5E0C\u671B\u4E0D\u540C\u7684\u6D88\u606F\u88AB\u4E0D\u540C\u7684\u961F\u5217\u6D88\u8D39\uFF0C\u8FD9\u65F6\u5C31\u8981\u7528\u5230direct\u7C7B\u578B\u7684exchange</p><p>\u662F\u5E7F\u64AD\u6A21\u5F0F\u7684\u53D8\u5F62</p></blockquote><p>\u5728direct\u6A21\u578B\u4E0B\uFF1A</p><ul><li>\u961F\u5217\u4E0E\u4EA4\u6362\u673A\u7684\u7ED1\u5B9A\uFF0C\u4E0D\u80FD\u662F\u4EFB\u610F\u7ED1\u5B9A\u7684\uFF0C\u800C\u662F\u8981\u6307\u5B9A\u4E00\u4E2AroutingKey\uFF08\u8DEF\u7531key\uFF09</li><li>\u6D88\u606F\u7684\u8FD4\u9001\u65B9\u5728\u5411exchange\u53D1\u9001\u6D88\u606F\u65F6\uFF0C\u4E5F\u5FC5\u987B\u6307\u5B9A\u6D88\u606F\u7684routingKey</li><li>exchange\u4E0D\u518D\u628A\u6D88\u606F\u4EA4\u7ED9\u6BCF\u4E00\u4E2A\u7ED1\u5B9A\u7684\u961F\u5217\uFF0C\u800C\u662F\u6839\u636E\u6D88\u606FroutingKey\u8FDB\u884C\u5224\u65AD\uFF0C\u53EA\u6709\u961F\u5217routingKey\u4E0E\u6D88\u606F\u7684routingKey\u5B8C\u5168\u4E00\u81F4\uFF0C\u624D\u4F1A\u63A5\u6536\u5230\u6D88\u606F</li></ul><p>\u6211\u5E0C\u671B\u5728\u628A\u6240\u6709\u7684\u65E5\u5FD7\u5411\u63A7\u5236\u53F0\u6253\u5370\u7684\u540C\u65F6\uFF08C2\uFF09\uFF0C\u5C06\u9519\u8BEF\u7684\u65E5\u5FD7\u4FDD\u5B58\u5230\u6587\u4EF6\uFF08C1\uFF09\u4E2D</p><p>\u6D41\u7A0B\uFF1A</p><p><img src="'+en+`" alt="img"></p><p>\u56FE\u89E3\uFF1A</p><ul><li>P \u751F\u4EA7\u8005\uFF0C\u5411exchange\u53D1\u9001\u6D88\u606F\uFF0C\u53D1\u9001\u6D88\u606F\u7684\u65F6\u5019\uFF0C \u4F1A\u6307\u5B9A\u4E00\u4E2Arouting key</li><li>X exchange \u4EA4\u6362\u673A\uFF0C\u63A5\u6536\u751F\u4EA7\u8005\u7684\u6D88\u606F\uFF0C\u7136\u540E\u628A\u6D88\u606F\u9012\u4EA4\u7ED9\u4E0Erouting key\u5B8C\u5168\u5339\u914D\u7684\u961F\u5217</li><li>C1 \u6D88\u8D39\u8005\uFF0C\u5176\u6240\u5728\u961F\u5217\u6307\u5B9A\u4E86\u9700\u8981routing key\u4E3A error\u7684\u6D88\u606F</li><li>C2 \u6D88\u8D39\u8005\uFF0C\u5176\u6240\u5728\u961F\u5217\u6307\u5B9A\u4E86\u9700\u8981routing key\u4E3Ainfo\u3001error\u3001warning\u7684\u6D88\u606F</li></ul><h5 id="\u5F00\u53D1\u751F\u4EA7\u8005-2"><a class="header-anchor" href="#\u5F00\u53D1\u751F\u4EA7\u8005-2" aria-hidden="true">#</a> \u5F00\u53D1\u751F\u4EA7\u8005</h5><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Producer</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u83B7\u53D6\u8FDE\u63A5\u5BF9\u8C61</span>
        <span class="token keyword">final</span> <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u83B7\u53D6\u901A\u9053\u5BF9\u8C61</span>
        <span class="token keyword">assert</span> connection <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u901A\u8FC7\u901A\u9053\u58F0\u660E\u4EA4\u6362\u673A</span>
        <span class="token doc-comment comment">/**
         * \u53C2\u65701 \u4EA4\u6362\u673A\u540D\u79F0
         * \u53C2\u65702 \u6D88\u606F\u7C7B\u578B direct \u8DEF\u7531\u6A21\u5F0F
         */</span>
        channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;logs_direct&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;direct&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u53D1\u9001\u6D88\u606F</span>
        <span class="token comment">// \u53D1\u9001\u4E4B\u524D\u5B9A\u4E49routing key</span>
        <span class="token class-name">String</span> routingKey <span class="token operator">=</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">;</span>
        channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span><span class="token string">&quot;logs_direct&quot;</span><span class="token punctuation">,</span> routingKey<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&quot;\u8FD9\u662Fdirect\u6A21\u578B\u53D1\u5E03\u7684\u57FA\u4E8Erouter_key: [&quot;</span> <span class="token operator">+</span> routingKey <span class="token operator">+</span> <span class="token string">&quot;] \u53D1\u9001\u7684\u6D88\u606F&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u5173\u95ED\u8D44\u6E90</span>
        <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">closeConnectionAndChannel</span><span class="token punctuation">(</span>channel<span class="token punctuation">,</span> connection<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="\u5F00\u53D1\u6D88\u8D39\u8005-1-2"><a class="header-anchor" href="#\u5F00\u53D1\u6D88\u8D39\u8005-1-2" aria-hidden="true">#</a> \u5F00\u53D1\u6D88\u8D39\u8005-1</h5><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Consumer1</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">final</span> <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">assert</span> connection <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u901A\u9053\u58F0\u660E\u4EA4\u6362\u673A\u4EE5\u53CA\u4EA4\u6362\u673A\u7684\u7C7B\u578B</span>
        channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;logs_direct&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;direct&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u83B7\u53D6\u521B\u5EFA\u4E00\u4E2A\u4E34\u65F6\u961F\u5217</span>
        <span class="token keyword">final</span> <span class="token class-name">String</span> queueName <span class="token operator">=</span> channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u57FA\u4E8Erouting key\u7ED1\u5B9A\u961F\u5217\u548C\u4EA4\u6362\u673A error \u53EA\u63A5\u6536\u4E3Aerror\u7684\u6D88\u606F\u8FDB\u884C\u6D88\u8D39</span>
        channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>queueName<span class="token punctuation">,</span> <span class="token string">&quot;logs_direct&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u83B7\u53D6\u6D88\u8D39\u7684\u6D88\u606F</span>
        channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span>queueName<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> <span class="token class-name">AMQP<span class="token punctuation">.</span>BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u6D88\u8D39\u8005-1: &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="\u5F00\u53D1\u6D88\u8D39\u8005-2-2"><a class="header-anchor" href="#\u5F00\u53D1\u6D88\u8D39\u8005-2-2" aria-hidden="true">#</a> \u5F00\u53D1\u6D88\u8D39\u8005-2</h5><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Consumer2</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">final</span> <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">assert</span> connection <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u58F0\u660E\u4EA4\u6362\u673A\u4EE5\u53CA\u4EA4\u6362\u673A\u7684\u7C7B\u578B</span>
        channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;logs_direct&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;direct&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u521B\u5EFA\u4E00\u4E2A\u4E34\u65F6\u7684\u961F\u5217</span>
        <span class="token keyword">final</span> <span class="token class-name">String</span> queueName <span class="token operator">=</span> channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u7ED1\u5B9A\u961F\u5217\u548C\u4EA4\u6362\u673A\uFF0C\u63A5\u6536info error warning\u7684\u6D88\u606F\u7C7B\u578B\u6D88\u8D39</span>
        channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>queueName<span class="token punctuation">,</span> <span class="token string">&quot;logs_direct&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;info&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>queueName<span class="token punctuation">,</span> <span class="token string">&quot;logs_direct&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>queueName<span class="token punctuation">,</span> <span class="token string">&quot;logs_direct&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;warning&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u6D88\u8D39\u6D88\u606F</span>
        channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span>queueName<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> <span class="token class-name">AMQP<span class="token punctuation">.</span>BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u6D88\u8D39\u8005-2: &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="\u6D4B\u8BD5\u7ED3\u679C-2"><a class="header-anchor" href="#\u6D4B\u8BD5\u7ED3\u679C-2" aria-hidden="true">#</a> \u6D4B\u8BD5\u7ED3\u679C</h5><p>\u6211\u4EEC\u5148\u542F\u52A8\u6D88\u8D39\u8005\uFF0C\u7136\u540E\u4E0D\u65AD\u6539\u53D8routingKey\u7684\u503C\uFF0C\u4E0D\u540C\u7684\u6D88\u8D39\u8005\u6839\u636EroutingKey\u63A5\u6536\u5230\u4E0D\u540C\u7684\u6D88\u606F</p><ul><li>\u53D1\u9001info\u7C7B\u578B\u7684\u4FE1\u606F\uFF0C\u53EA\u6709Consumer\u80FD\u63A5\u6536\u5230</li><li>\u53D1\u9001error\u7C7B\u578B\u7684\u4FE1\u606F\uFF0C\u4E24\u4E2A\u90FD\u80FD\u6536\u5230\u4FE1\u606F</li></ul><p><img src="`+tn+'" alt="image-20211210031346694"></p><p><img src="'+pn+'" alt="image-20211210031356002"></p><h4 id="routing\u4E4B\u8BA2\u9605\u6A21\u578B-topic"><a class="header-anchor" href="#routing\u4E4B\u8BA2\u9605\u6A21\u578B-topic" aria-hidden="true">#</a> routing\u4E4B\u8BA2\u9605\u6A21\u578B-topic</h4><p>topic\u7C7B\u578B\u7684exchange\u4E0Edirect\u76F8\u6BD4\uFF0C\u90FD\u662F\u53EF\u4EE5\u6839\u636EroutingKey\u628A\u6D88\u606F\u8DEF\u7531\u5230\u4E0D\u540C\u7684\u961F\u5217\u4E2D\uFF0C\u53EA\u4E0D\u8FC7topic\u7C7B\u578Bexchange\u53EF\u4EE5\u8BA9\u961F\u5217\u5728\u7ED1\u5B9AroutingKey\u7684\u65F6\u5019\u4F7F\u7528\u901A\u914D\u7B26\uFF0C\u8FD9\u79CD\u6A21\u578BroutingKey\u4E00\u822C\u90FD\u662F\u4E00\u4E2A\u6216\u8005\u591A\u4E2A\u5355\u8BCD\u7EC4\u6210\uFF0C\u591A\u4E2A\u5355\u8BCD\u4E4B\u95F4\u4EE5&quot;.&quot;\u5206\u5272\uFF0C\u4F8B\u5982\uFF1A<code>item.insert</code></p><p><img src="'+on+`" alt="img"></p><div class="language-markdown ext-md line-numbers-mode"><pre class="language-markdown"><code><span class="token title important"><span class="token punctuation">##</span> \u901A\u914D\u7B26</span>
	<span class="token list punctuation">*</span> (star) can substitute for exactly one word.		\u5339\u914D\u4E0D\u591A\u4E0D\u5C11\u6070\u597D1\u4E2A\u8BCD
	<span class="token title important"><span class="token punctuation">##</span> (hash) can substitute for zero or more words.	\u5339\u914D\u4E00\u4E2A\u6216\u8005\u591A\u4E2A\u8BCD</span>

<span class="token title important"><span class="token punctuation">##</span> \u5982\uFF1A</span>
	audit.#	\u5339\u914Daudit.irs.corporate\u6216\u8005audit.irs\u7B49
	audit.*	\u53EA\u80FD\u5339\u914Daudit.irs
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="\u5F00\u53D1\u751F\u4EA7\u8005-3"><a class="header-anchor" href="#\u5F00\u53D1\u751F\u4EA7\u8005-3" aria-hidden="true">#</a> \u5F00\u53D1\u751F\u4EA7\u8005</h5><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Producer</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u83B7\u53D6\u8FDE\u63A5\u5BF9\u8C61</span>
        <span class="token keyword">final</span> <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">assert</span> connection <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u58F0\u660E\u4EA4\u6362\u673A\u4EE5\u53CA\u4EA4\u6362\u673A\u7C7B\u578B</span>
        channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;topics&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;topic&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u53D1\u5E03\u6D88\u606F</span>
        <span class="token class-name">String</span> routingKey <span class="token operator">=</span> <span class="token string">&quot;user.save&quot;</span><span class="token punctuation">;</span>
        channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span><span class="token string">&quot;topics&quot;</span><span class="token punctuation">,</span> routingKey<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">&quot;\u8FD9\u662Fdirect\u6A21\u578B\u53D1\u5E03\u7684\u57FA\u4E8Erouter_key: [&quot;</span> <span class="token operator">+</span> routingKey <span class="token operator">+</span> <span class="token string">&quot;] \u53D1\u9001\u7684\u6D88\u606F&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">closeConnectionAndChannel</span><span class="token punctuation">(</span>channel<span class="token punctuation">,</span> connection<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="\u5F00\u53D1\u6D88\u8D39\u8005-1-3"><a class="header-anchor" href="#\u5F00\u53D1\u6D88\u8D39\u8005-1-3" aria-hidden="true">#</a> \u5F00\u53D1\u6D88\u8D39\u8005-1</h5><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Consumer1</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u83B7\u53D6\u8FDE\u63A5</span>
        <span class="token keyword">final</span> <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">assert</span> connection <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u58F0\u660E\u4EA4\u6362\u673A\u4EE5\u53CA\u4EA4\u6362\u673A\u7C7B\u578B</span>
        channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;topics&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;topic&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u521B\u5EFA\u4E00\u4E2A\u4E34\u65F6\u961F\u5217</span>
        <span class="token keyword">final</span> <span class="token class-name">String</span> queue <span class="token operator">=</span> channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u7ED1\u5B9A\u961F\u5217\u548C\u4EA4\u6362\u673A \u52A8\u6001\u901A\u914D\u7B26 routing key user.* \u8868\u793A\u5FC5\u987B\u6709\u4E24\u4E2A\u5355\u8BCD\uFF0C\u540E\u9762\u7684\u5355\u8BCD\u4EFB\u610F</span>
        channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span> <span class="token string">&quot;topics&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;user.*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u6D88\u8D39\u6D88\u606F</span>
        channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> <span class="token class-name">AMQP<span class="token punctuation">.</span>BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u6D88\u8D39\u8005-1: &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="\u5F00\u53D1\u6D88\u8D39\u8005-2-3"><a class="header-anchor" href="#\u5F00\u53D1\u6D88\u8D39\u8005-2-3" aria-hidden="true">#</a> \u5F00\u53D1\u6D88\u8D39\u8005-2</h5><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Consumer2</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u83B7\u53D6\u8FDE\u63A5</span>
        <span class="token keyword">final</span> <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token class-name">RabbitMQUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">assert</span> connection <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token class-name">Channel</span> channel <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">createChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u58F0\u660E\u4EA4\u6362\u673A\u4EE5\u53CA\u4EA4\u6362\u673A\u7C7B\u578B</span>
        channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;topics&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;topic&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u521B\u5EFA\u4E00\u4E2A\u4E34\u65F6\u961F\u5217</span>
        <span class="token keyword">final</span> <span class="token class-name">String</span> queue <span class="token operator">=</span> channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u7ED1\u5B9A\u961F\u5217\u548C\u4EA4\u6362\u673A \u52A8\u6001\u901A\u914D\u7B26 routing key user.## \u540E\u9762\u7684\u5355\u8BCD\u4EFB\u610F\uFF0C\u5305\u62EC .</span>
        channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span> <span class="token string">&quot;topics&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;user.#&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// \u6D88\u8D39\u6D88\u606F</span>
        channel<span class="token punctuation">.</span><span class="token function">basicConsume</span><span class="token punctuation">(</span>queue<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DefaultConsumer</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleDelivery</span><span class="token punctuation">(</span><span class="token class-name">String</span> consumerTag<span class="token punctuation">,</span> <span class="token class-name">Envelope</span> envelope<span class="token punctuation">,</span> <span class="token class-name">AMQP<span class="token punctuation">.</span>BasicProperties</span> properties<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> body<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u6D88\u8D39\u8005-2: &quot;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="\u6D4B\u8BD5\u7ED3\u679C-3"><a class="header-anchor" href="#\u6D4B\u8BD5\u7ED3\u679C-3" aria-hidden="true">#</a> \u6D4B\u8BD5\u7ED3\u679C</h5><p>\u5F53\u53D1\u9001\u7684routingKey\u662Fuser.save\u7684\u65F6\u5019\uFF0C\u4E24\u4E2A\u90FD\u80FD\u63A5\u6536\u5230</p><p><img src="`+cn+'" alt="image-20211210040511106"></p><p>\u5F53\u53D1\u9001\u7684routingKey\u662Fuser.add.01\u7684\u65F6\u5019\uFF0C\u53EA\u6709Consumer2\u80FD\u63A5\u6536\u5230</p><p><img src="'+ln+`" alt="image-20211210040615409"></p><p>\u5F53\u7136\uFF0C\u901A\u914D\u7B26\u8FD8\u6709\u66F4\u591A\u7684\u7EC4\u5408\u65B9\u5F0F\uFF0C\u6BD4\u5982\uFF1A<code>*.user.#</code>\u3001<code>user.*.#</code>\u7B49\u7B49</p><h2 id="springboot\u4E2D\u4F7F\u7528rabbitmq"><a class="header-anchor" href="#springboot\u4E2D\u4F7F\u7528rabbitmq" aria-hidden="true">#</a> springboot\u4E2D\u4F7F\u7528rabbitmq</h2><h3 id="\u642D\u5EFA\u521D\u59CB\u73AF\u5883"><a class="header-anchor" href="#\u642D\u5EFA\u521D\u59CB\u73AF\u5883" aria-hidden="true">#</a> \u642D\u5EFA\u521D\u59CB\u73AF\u5883</h3><h4 id="\u5F15\u5165\u4F9D\u8D56-1"><a class="header-anchor" href="#\u5F15\u5165\u4F9D\u8D56-1" aria-hidden="true">#</a> \u5F15\u5165\u4F9D\u8D56</h4><p>\u5F15\u5165web\u548Crabbitmq\u7684\u4F9D\u8D56\uFF0C\u53EF\u4EE5\u5728\u6784\u5EFA\u754C\u9762\u52FE\u9009\uFF0C\u6216\u8005\u5728\u521B\u5EFA\u4E4B\u540E\u5728pom\u6587\u4EF6\u4E2D\u5F15\u5165</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!--11.rabbitmq--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-amqp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--web--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u914D\u7F6E\u914D\u7F6E\u6587\u4EF6"><a class="header-anchor" href="#\u914D\u7F6E\u914D\u7F6E\u6587\u4EF6" aria-hidden="true">#</a> \u914D\u7F6E\u914D\u7F6E\u6587\u4EF6</h4><p>\u5728\u5F15\u5165\u4F9D\u8D56\u4E4B\u540E\uFF0C\u65E2\u7136springboot\u652F\u6301\u901A\u8FC7\u542F\u52A8\u5668\u6765\u914D\u7F6Erabbitmq\uFF0C\u90A3\u4E48\u5F53\u524Dspringboot\u7684\u81EA\u52A8\u914D\u7F6E\u5305\u4E0B\u5C31\u5E94\u8BE5\u6709\u81EA\u52A8\u914D\u7F6E\u7C7B\u548C\u5C5E\u6027\u7C7B</p><ol><li>RabbitProperties\u8868\u793A\u6211\u4EEC\u5728\u5F53\u524D\u7684\u914D\u7F6E\u6587\u4EF6\u4E2D\u53EF\u914D\u7F6E\u90A3\u4E9B\u53C2\u6570</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;spring.rabbitmq&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RabbitProperties</span> <span class="token punctuation">{</span>
  <span class="token doc-comment comment">/**
  * RabbitMQ host. Ignored if an address is set.
  */</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> host <span class="token operator">=</span> <span class="token string">&quot;localhost&quot;</span><span class="token punctuation">;</span>

  <span class="token doc-comment comment">/**
  * RabbitMQ port. Ignored if an address is set. Default to 5672, or 5671 if SSL is
  * enabled.
  */</span>
  <span class="token keyword">private</span> <span class="token class-name">Integer</span> port<span class="token punctuation">;</span>

  <span class="token doc-comment comment">/**
  * Login user to authenticate to the broker.
  */</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> username <span class="token operator">=</span> <span class="token string">&quot;guest&quot;</span><span class="token punctuation">;</span>

  <span class="token doc-comment comment">/**
  * Login to authenticate against the broker.
  */</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> password <span class="token operator">=</span> <span class="token string">&quot;guest&quot;</span><span class="token punctuation">;</span>

  <span class="token doc-comment comment">/**
  * SSL configuration.
  */</span>
  <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Ssl</span> ssl <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Ssl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token doc-comment comment">/**
  * Virtual host to use when connecting to the broker.
  */</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> virtualHost<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u901A\u8FC7\u4E0A\u9762\u7684\u914D\u7F6E\u6587\u4EF6\uFF0C\u6211\u4EEC\u80FD\u77E5\u9053\uFF1A</p><ul><li>@ConfigurationProperties(prefix = &quot;spring.rabbitmq&quot;) \u914D\u7F6Erabbitmq\u53C2\u6570\u7684\u524D\u7F00\u662F<code>spring.rabbitmq</code></li><li>\u53EF\u4EE5\u914D\u7F6Ehost\u3001port\u3001virtual host\u3001username\u3001password\u7B49</li></ul><ol start="2"><li>RabbitAutoConfiguration \u8868\u660E\u4E86rabbitmq\u662F\u600E\u4E48\u81EA\u52A8\u914D\u7F6E\u5230springboot\u9879\u76EE\u4E2D\u7684\uFF0C\u4E0D\u662F\u73B0\u5728\u7684\u91CD\u70B9</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span><span class="token punctuation">(</span>proxyBeanMethods <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnClass</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">RabbitTemplate</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">Channel</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@EnableConfigurationProperties</span><span class="token punctuation">(</span><span class="token class-name">RabbitProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Import</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token class-name">RabbitAnnotationDrivenConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">RabbitStreamConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RabbitAutoConfiguration</span> <span class="token punctuation">{</span>
  <span class="token comment">// .....</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6240\u4EE5\u6211\u4EEC\u7684\u914D\u7F6E\u6587\u4EF6\u4E3A\uFF1A</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> springboot<span class="token punctuation">-</span>11.rabbitmq<span class="token punctuation">-</span>demo<span class="token punctuation">-</span><span class="token number">01</span> <span class="token comment">## \u7ED9\u5F53\u524Dspringboot\u53D6\u4E00\u4E2A\u540D\u5B57</span>
  <span class="token key atrule">rabbitmq</span><span class="token punctuation">:</span> <span class="token comment">## \u914D\u7F6Erabbitmq</span>
    <span class="token key atrule">host</span><span class="token punctuation">:</span> 172.16.187.9 <span class="token comment">## \u9ED8\u8BA4\u662Flocalhost</span>
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">5672</span> <span class="token comment">## \u9ED8\u8BA4\u662F5672</span>
    <span class="token key atrule">virtual-host</span><span class="token punctuation">:</span> /ems
    <span class="token key atrule">username</span><span class="token punctuation">:</span> ems <span class="token comment">## \u9ED8\u8BA4\u662Fguest</span>
    <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token number">123456</span> <span class="token comment">## \u9ED8\u8BA4\u662Fguest</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>springboot\u4E3A\u6211\u4EEC\u63D0\u4F9B\u4E86<code>RabbitTemplate</code>\uFF0C\u7528\u6765\u7B80\u5316rabbitmq\u64CD\u4F5C\uFF0C\u5728<code>RabbitAutoConfiguration.RabbitTemplateConfiguration</code>\u4E2D\u81EA\u52A8\u5F15\u5165\u4E86<code>RabbitTemplate</code></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token annotation punctuation">@ConditionalOnSingleCandidate</span><span class="token punctuation">(</span><span class="token class-name">ConnectionFactory</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnMissingBean</span><span class="token punctuation">(</span><span class="token class-name">RabbitOperations</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">RabbitTemplate</span> <span class="token function">rabbitTemplate</span><span class="token punctuation">(</span><span class="token class-name">RabbitTemplateConfigurer</span> configurer<span class="token punctuation">,</span> <span class="token class-name">ConnectionFactory</span> connectionFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">RabbitTemplate</span> template <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RabbitTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  configurer<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span>template<span class="token punctuation">,</span> connectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> template<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u7B2C\u4E00\u79CDhello-world\u6A21\u578B"><a class="header-anchor" href="#\u7B2C\u4E00\u79CDhello-world\u6A21\u578B" aria-hidden="true">#</a> \u7B2C\u4E00\u79CDhello world\u6A21\u578B</h3><blockquote><p>\u961F\u5217\u5E76\u4E0D\u4F1A\u968F\u7740\u751F\u4EA7\u8005\u53D1\u9001\u6D88\u606F\u800C\u521B\u5EFA\uFF0C\u53EA\u6709\u6709\u6D88\u8D39\u8005\u624D\u4F1A\u662F\u6709\u610F\u4E49\u7684\u961F\u5217\uFF0C\u6240\u4EE5\u53EA\u6709\u6709\u4E86\u6D88\u8D39\u8005\u624D\u6709\u961F\u5217</p></blockquote><h4 id="\u5F00\u53D1\u751F\u4EA7\u8005-4"><a class="header-anchor" href="#\u5F00\u53D1\u751F\u4EA7\u8005-4" aria-hidden="true">#</a> \u5F00\u53D1\u751F\u4EA7\u8005</h4><p>\u5728test\u6D4B\u8BD5\u76EE\u5F55\u4E0B\u521B\u5EFA</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootTest</span><span class="token punctuation">(</span>classes <span class="token operator">=</span> <span class="token class-name">SpringbootRabbitmqDemo01Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token comment">// \u6307\u5B9A\u6D4B\u8BD5\u7C7B\uFF0C\u5F53\u6211\u4EEC\u8FD0\u884C\u5F53\u524D\u6D4B\u8BD5\u7C7B\u4E2D\u7684\u65B9\u6CD5\u7684\u65F6\u5019\u56DE\u542F\u52A8springboot\u9879\u76EE</span>
<span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token comment">//\u542F\u52A8springboot\u5DE5\u5382</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Producer</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">RabbitTemplate</span> rabbitTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token doc-comment comment">/**
         * \u53C2\u65701 \u961F\u5217\u540D\u79F0
         * \u53C2\u65702 \u6D88\u606F
         */</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hello world&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u5F00\u53D1\u6D88\u8D39\u8005"><a class="header-anchor" href="#\u5F00\u53D1\u6D88\u8D39\u8005" aria-hidden="true">#</a> \u5F00\u53D1\u6D88\u8D39\u8005</h4><p>\u5728java\u76EE\u5F55\u4E0B\u521B\u5EFA</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token doc-comment comment">/**
 * \u6D88\u8D39\u8005\u76D1\u542C
 *  queuesToDeclare\u6CA1\u6709\u961F\u5217\u5C31\u521B\u5EFA\u4E00\u4E2A\u961F\u5217
 *       * @Queue(&quot;hello&quot;) \u8868\u793A\u961F\u5217\u540D\u79F0\u4E3Ahello\uFF0C\u521B\u5EFA\u51FA\u6765\u7684\u961F\u5217\u9ED8\u8BA4\u662F\u6301\u4E45\u5316\u7684\u3001\u975E\u72EC\u5360\u7684\u3001\u4E0D\u662F\u81EA\u52A8\u5220\u9664\u7684\uFF0C\u53EF\u4EE5\u6DFB\u52A0\u53C2\u6570\u4FEE\u6539
 */</span>
<span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>queuesToDeclare <span class="token operator">=</span> <span class="token annotation punctuation">@Queue</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Consumer</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * \u53EF\u4EE5\u5B9A\u4E49\u4E00\u4E2A\u4EFB\u610F\u7684\u65B9\u6CD5\u6765\u83B7\u53D6\u76D1\u542C\u961F\u5217\u4E2D\u7684\u6D88\u606F
     *      * @RabbitHandler \u4EE3\u8868\u76D1\u542C\u961F\u5217\u4E2D\u7684\u6D88\u606F\u7684\u56DE\u8C03\u65B9\u6CD5
     *
     * <span class="token keyword">@param</span> <span class="token parameter">message</span> \u63A5\u6536\u7684\u6D88\u606F
     */</span>
    <span class="token annotation punctuation">@RabbitHandler</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receive</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;message = &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5176\u4E2D\uFF1A</p><ul><li><code>@RabbitListener(queuesToDeclare = @Queue(&quot;hello&quot;))</code>\u8868\u793A\u76D1\u542C\u961F\u5217\u4E2D\u7684\u6D88\u606F\uFF0C\u5982\u679C\u60F3\u8981\u5728\u4E00\u4E2A\u7EC4\u4EF6\u4E2D\u76D1\u542C\u591A\u4E2A\u4E0D\u540C\u7684\u961F\u5217\uFF0C\u8FD8\u53EF\u4EE5\u5C06\u8FD9\u4E2A\u6CE8\u89E3\u52A0\u5728\u65B9\u6CD5\u4E0A\uFF0C\u6B64\u65F6\u65B9\u6CD5\u4E0A\u5C31\u53EF\u4EE5\u4E0D\u540C\u6DFB\u52A0<code>@RabbitHandler</code>\u4E86 <ul><li><code>@Queue</code>\u53EF\u4EE5\u914D\u7F6E\u662F\u5426\u6301\u4E45\u5316\u3001\u662F\u5426\u72EC\u5360\u961F\u5217\u3001\u662F\u5426\u81EA\u52A8\u5220\u9664\u7B49</li></ul></li><li><code>@RabbitHandler</code>\u4EE3\u8868\u76D1\u542C\u961F\u5217\u4E2D\u7684\u6D88\u606F\u7684\u56DE\u8C03\u65B9\u6CD5</li></ul><p>Queue\u7C7B\u6E90\u7801\u4E2D\u53EF\u4EE5\u914D\u7F6E\u548C\u961F\u5217\u76F8\u5173\u7684\u7C7B\u578B</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * A queue definition used within the bindings attribute of a <span class="token punctuation">{</span><span class="token keyword">@code</span> <span class="token code-section"><span class="token code language-java"><span class="token class-name">QueueBinding</span></span></span><span class="token punctuation">}</span>.
 *
 * <span class="token keyword">@author</span> Gary Russell
 * <span class="token keyword">@since</span> 1.5
 *
 */</span>
<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">Queue</span> <span class="token punctuation">{</span>

	<span class="token doc-comment comment">/**
	 * <span class="token keyword">@return</span> the queue name or &quot;&quot; for a generated queue name (default).
	 */</span>
	<span class="token annotation punctuation">@AliasFor</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span>
	<span class="token class-name">String</span> <span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>

	<span class="token doc-comment comment">/**
	 * <span class="token keyword">@return</span> the queue name or &quot;&quot; for a generated queue name (default).
	 * <span class="token keyword">@since</span> 2.0
	 */</span>
	<span class="token annotation punctuation">@AliasFor</span><span class="token punctuation">(</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span>
	<span class="token class-name">String</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>

	<span class="token doc-comment comment">/**
	 * Specifies if this queue should be durable.
	 * By default if queue name is provided it is durable.
	 * <span class="token keyword">@return</span> true if the queue is to be declared as durable.
	 * <span class="token keyword">@see</span> <span class="token reference"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">Queue</span><span class="token punctuation">#</span><span class="token function">isDurable</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
	 */</span>
	<span class="token class-name">String</span> <span class="token function">durable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>

	<span class="token doc-comment comment">/**
	 * Specifies if this queue should be exclusive.
	 * By default if queue name is provided it is not exclusive.
	 * <span class="token keyword">@return</span> true if the queue is to be declared as exclusive.
	 * <span class="token keyword">@see</span> <span class="token reference"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">Queue</span><span class="token punctuation">#</span><span class="token function">isExclusive</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
	 */</span>
	<span class="token class-name">String</span> <span class="token function">exclusive</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>

	<span class="token doc-comment comment">/**
	 * Specifies if this queue should be auto deleted when not used.
	 * By default if queue name is provided it is not auto-deleted.
	 * <span class="token keyword">@return</span> true if the queue is to be declared as auto-delete.
	 * <span class="token keyword">@see</span> <span class="token reference"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">Queue</span><span class="token punctuation">#</span><span class="token function">isAutoDelete</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
	 */</span>
	<span class="token class-name">String</span> <span class="token function">autoDelete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>

	<span class="token doc-comment comment">/**
	 * <span class="token keyword">@return</span> true if the declaration exceptions should be ignored.
	 * <span class="token keyword">@since</span> 1.6
	 */</span>
	<span class="token class-name">String</span> <span class="token function">ignoreDeclarationExceptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">&quot;false&quot;</span><span class="token punctuation">;</span>

	<span class="token doc-comment comment">/**
	 * <span class="token keyword">@return</span> the arguments to apply when declaring this queue.
	 * <span class="token keyword">@since</span> 1.6
	 */</span>
	<span class="token class-name">Argument</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">arguments</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

	<span class="token doc-comment comment">/**
	 * <span class="token keyword">@return</span> true if the admin(s), if present, should declare this component.
	 * <span class="token keyword">@since</span> 2.1
	 */</span>
	<span class="token class-name">String</span> <span class="token function">declare</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">;</span>

	<span class="token doc-comment comment">/**
	 * Return a list of admin bean names that should declare this component.
	 * By default all admins will declare it
	 * <span class="token keyword">@return</span> the bean names
	 * <span class="token keyword">@since</span> 2.1
	 */</span>
	<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">admins</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u6D4B\u8BD5\u7ED3\u679C-4"><a class="header-anchor" href="#\u6D4B\u8BD5\u7ED3\u679C-4" aria-hidden="true">#</a> \u6D4B\u8BD5\u7ED3\u679C</h4><p>\u8FD0\u884CProducer\u6D4B\u8BD5\u65B9\u6CD5\uFF0CConsumer\u6210\u529F\u63A5\u6536\u5230\u53D1\u51FA\u7684\u6D88\u606F</p><p><img src="`+un+`" alt="image-20211210151410743"></p><h3 id="\u7B2C\u4E8C\u79CDwork\u6A21\u578B"><a class="header-anchor" href="#\u7B2C\u4E8C\u79CDwork\u6A21\u578B" aria-hidden="true">#</a> \u7B2C\u4E8C\u79CDwork\u6A21\u578B</h3><h4 id="\u5F00\u53D1\u751F\u4EA7\u8005-5"><a class="header-anchor" href="#\u5F00\u53D1\u751F\u4EA7\u8005-5" aria-hidden="true">#</a> \u5F00\u53D1\u751F\u4EA7\u8005</h4><p>\u5728\u7B2C\u4E00\u79CD\u7684Producer\u7C7B\u4E2D\u6DFB\u52A0\u751F\u4EA7work\u7C7B\u578B\u6D88\u606F\u7684\u6D4B\u8BD5\u65B9\u6CD5</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
* work\u6A21\u5F0F
*/</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testWork</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token string">&quot;work&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;work\u6A21\u578B&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u5F00\u53D1\u6D88\u8D39\u8005-4"><a class="header-anchor" href="#\u5F00\u53D1\u6D88\u8D39\u8005-4" aria-hidden="true">#</a> \u5F00\u53D1\u6D88\u8D39\u8005</h4><p>\u5728mian/java\u7684\u5305\u4E2D\u521B\u5EFAwork.Consumer\uFF0C\u56E0\u4E3A\u6B64\u65F6\u8981\u6CE8\u5165\u5230spring\u5BB9\u5668\u7684Consumer\u6709\u4E24\u4E2A\uFF0C\u4F1A\u91CD\u540D\uFF0C\u6240\u4EE5\u5BF9\u4E24\u4E2A\u91CD\u547D\u540D</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;workConsumer&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Consumer</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>queuesToDeclare <span class="token operator">=</span> <span class="token annotation punctuation">@Queue</span><span class="token punctuation">(</span><span class="token string">&quot;work&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receiveWork1</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;work-1 message : &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>queuesToDeclare <span class="token operator">=</span> <span class="token annotation punctuation">@Queue</span><span class="token punctuation">(</span><span class="token string">&quot;work&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receiveWork2</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;work-2 message : &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><code>@RabbitListener(queuesToDeclare = @Queue(&quot;hello&quot;))</code>\u8868\u793A\u76D1\u542C\u961F\u5217\u4E2D\u7684\u6D88\u606F\uFF0C\u5982\u679C\u60F3\u8981\u5728\u4E00\u4E2A\u7EC4\u4EF6\u4E2D\u76D1\u542C\u591A\u4E2A\u4E0D\u540C\u7684\u961F\u5217\uFF0C\u8FD8\u53EF\u4EE5\u5C06\u8FD9\u4E2A\u6CE8\u89E3\u52A0\u5728\u65B9\u6CD5\u4E0A\uFF0C\u6B64\u65F6\u65B9\u6CD5\u4E0A\u5C31\u53EF\u4EE5\u4E0D\u540C\u6DFB\u52A0<code>@RabbitHandler</code>\u4E86</p></blockquote><h4 id="\u6D4B\u8BD5\u7ED3\u679C-5"><a class="header-anchor" href="#\u6D4B\u8BD5\u7ED3\u679C-5" aria-hidden="true">#</a> \u6D4B\u8BD5\u7ED3\u679C</h4><p>\u542F\u52A8testWork\u65B9\u6CD5\uFF0Cwork\u6A21\u5F0F\u5E73\u5747\u5206\u914D\u6D88\u606F\u5230\u4E86\u4E24\u4E2A\u6D88\u8D39\u8005\u4E0A</p><p><img src="`+rn+`" alt="image-20211210153342265"></p><blockquote><p>\u8BF4\u660E\uFF1A\u9ED8\u8BA4\u5728spring amqp\u5B9E\u73B0work\u8FD9\u79CD\u65B9\u5F0F\u5C31\u662F\u516C\u5E73\u5206\u914D\u8C03\u5EA6\u7684\uFF0C\u5982\u679C\u5B9E\u73B0\u80FD\u8005\u591A\u52B3\u9700\u8981\u989D\u5916\u914D\u7F6E</p></blockquote><h3 id="\u7B2C\u4E09\u79CDfanout\u6A21\u578B"><a class="header-anchor" href="#\u7B2C\u4E09\u79CDfanout\u6A21\u578B" aria-hidden="true">#</a> \u7B2C\u4E09\u79CDfanout\u6A21\u578B</h3><h4 id="\u5F00\u53D1\u751F\u4EA7\u8005-6"><a class="header-anchor" href="#\u5F00\u53D1\u751F\u4EA7\u8005-6" aria-hidden="true">#</a> \u5F00\u53D1\u751F\u4EA7\u8005</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
* fanout\u6A21\u5F0F
*/</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testFanout</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token string">&quot;logs&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;fanout\u6A21\u578B\u53D1\u9001\u7684\u6D88\u606F&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u5F00\u53D1\u6D88\u8D39\u8005-5"><a class="header-anchor" href="#\u5F00\u53D1\u6D88\u8D39\u8005-5" aria-hidden="true">#</a> \u5F00\u53D1\u6D88\u8D39\u8005</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;fanoutConsumer&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Consumer</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>bindings <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@QueueBinding</span><span class="token punctuation">(</span>
                    value <span class="token operator">=</span> <span class="token annotation punctuation">@Queue</span><span class="token punctuation">,</span><span class="token comment">// \u5982\u679C\u4E0D\u8BBE\u5B9A\u540D\u5B57\u5C31\u4F1A\u521B\u5EFA\u4E34\u65F6\u961F\u5217</span>
                    exchange <span class="token operator">=</span> <span class="token annotation punctuation">@Exchange</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;logs&quot;</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token class-name">ExchangeTypes</span><span class="token punctuation">.</span>FANOUT<span class="token punctuation">)</span> <span class="token comment">// \u6307\u5B9A\u7ED1\u5B9A\u7684\u4EA4\u6362\u673A\uFF0Clogs \u4EA4\u6362\u673A\u540D\u79F0\uFF1Bfanout \u4EA4\u6362\u673A\u6D88\u606F\u7C7B\u578B</span>
            <span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receive1</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;fanout-1 message = &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>bindings <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@QueueBinding</span><span class="token punctuation">(</span>
                    value <span class="token operator">=</span> <span class="token annotation punctuation">@Queue</span><span class="token punctuation">,</span><span class="token comment">// \u5982\u679C\u4E0D\u8BBE\u5B9A\u540D\u5B57\u5C31\u4F1A\u521B\u5EFA\u4E34\u65F6\u961F\u5217</span>
                    exchange <span class="token operator">=</span> <span class="token annotation punctuation">@Exchange</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;logs&quot;</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token string">&quot;fanout&quot;</span><span class="token punctuation">)</span> <span class="token comment">// \u6307\u5B9A\u7ED1\u5B9A\u7684\u4EA4\u6362\u673A\uFF0Clogs \u4EA4\u6362\u673A\u540D\u79F0\uFF1Bfanout \u4EA4\u6362\u673A\u6D88\u606F\u7C7B\u578B</span>
            <span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receive2</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;fanout-2 message = &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u6D4B\u8BD5\u7ED3\u679C-6"><a class="header-anchor" href="#\u6D4B\u8BD5\u7ED3\u679C-6" aria-hidden="true">#</a> \u6D4B\u8BD5\u7ED3\u679C</h4><blockquote><p>\u6D4B\u8BD5\u7684\u65F6\u5019\u51FA\u73B0\u6CA1\u6709\u62A5\u9519\u7206\u7EA2\uFF0C\u4F46\u662F\u4E00\u76F4\u63A5\u6536\u4E0D\u5230\u6D88\u606F\u7684\u60C5\u51B5\uFF0C\u800C\u7EC8\u7AEF\u4F1A\u51FA\u73B0ERROR \u5B57\u6BB5\uFF0C\u662F\u4E4B\u524D\u6D4B\u8BD5\u4E0D\u662Fspringboot\u9879\u76EE\u7684rabbitmq\u5B58\u50A8\u7684queue\u5339\u914D\u51FA\u73B0\u9519\u8BEF\uFF0C\u6240\u4EE5\u628Arabbitmq\u7684queue\u5220\u9664</p></blockquote><p>\u542F\u52A8testFanout\uFF0C\u53EA\u8981\u662F\u8FDE\u63A5\u5230\u4EA4\u6362\u673Alogs\u7684\u90FD\u80FD\u63A5\u6536\u5230\u6D88\u606F</p><p><img src="`+dn+`" alt="image-20211210160539736"></p><h3 id="\u7B2C\u56DB\u79CDrouting\u6A21\u578B"><a class="header-anchor" href="#\u7B2C\u56DB\u79CDrouting\u6A21\u578B" aria-hidden="true">#</a> \u7B2C\u56DB\u79CDrouting\u6A21\u578B</h3><h4 id="\u5F00\u53D1\u751F\u4EA7\u8005-7"><a class="header-anchor" href="#\u5F00\u53D1\u751F\u4EA7\u8005-7" aria-hidden="true">#</a> \u5F00\u53D1\u751F\u4EA7\u8005</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
* routing\u6A21\u578B
*/</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testRouting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token string">&quot;directs&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;\u53D1\u9001info\u7684key\u662F\u8DEF\u7531\u4FE1\u606F&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u5F00\u53D1\u6D88\u8D39\u8005-6"><a class="header-anchor" href="#\u5F00\u53D1\u6D88\u8D39\u8005-6" aria-hidden="true">#</a> \u5F00\u53D1\u6D88\u8D39\u8005</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;routingConsumer&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Consumer</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>bindings <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@QueueBinding</span><span class="token punctuation">(</span>
                    value <span class="token operator">=</span> <span class="token annotation punctuation">@Queue</span><span class="token punctuation">,</span><span class="token comment">// \u521B\u5EFA\u4E34\u65F6\u961F\u5217</span>
                    exchange <span class="token operator">=</span> <span class="token annotation punctuation">@Exchange</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;directs&quot;</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token class-name">ExchangeTypes</span><span class="token punctuation">.</span>DIRECT<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">// \u6307\u5B9A\u4EA4\u6362\u673A\u540D\u79F0\u548C\u7C7B\u578B</span>
                    key <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;info&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;warn&quot;</span><span class="token punctuation">}</span> <span class="token comment">// \u63A5\u6536info\u3001error\u3001warn\u7C7B\u578B\u7684\u6D88\u606F</span>
            <span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receive1</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;routing-1 message : &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>bindings <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@QueueBinding</span><span class="token punctuation">(</span>
                    value <span class="token operator">=</span> <span class="token annotation punctuation">@Queue</span><span class="token punctuation">,</span><span class="token comment">// \u521B\u5EFA\u4E34\u65F6\u961F\u5217</span>
                    exchange <span class="token operator">=</span> <span class="token annotation punctuation">@Exchange</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;directs&quot;</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token class-name">ExchangeTypes</span><span class="token punctuation">.</span>DIRECT<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment">// \u6307\u5B9A\u4EA4\u6362\u673A\u540D\u79F0\u548C\u7C7B\u578B</span>
                    key <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;error&quot;</span><span class="token punctuation">}</span> <span class="token comment">// \u53EA\u63A5\u6536error\u76F8\u5173\u7684\u4FE1\u606F</span>
            <span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receive2</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;routing-2 message : &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u6D4B\u8BD5\u7ED3\u679C-7"><a class="header-anchor" href="#\u6D4B\u8BD5\u7ED3\u679C-7" aria-hidden="true">#</a> \u6D4B\u8BD5\u7ED3\u679C</h4><p>\u542F\u52A8testRouting\u65B9\u6CD5\uFF0C\u5982\u679C\u53D1\u9001\u7684\u662Finfo\u7C7B\u578B\u7684\u6D88\u606F\uFF0C\u53EA\u6709receive1\u80FD\u63A5\u6536\u5230\uFF0C\u5982\u679C\u53D1\u9001error\u7684\u6D88\u606F\uFF0C\u5219\u4E24\u4E2A\u6D88\u8D39\u8005\u90FD\u80FD\u63A5\u6536\u5230</p><p><img src="`+kn+`" alt="image-20211210162635116"></p><h3 id="\u7B2C\u4E94\u79CDtopic\u6A21\u578B"><a class="header-anchor" href="#\u7B2C\u4E94\u79CDtopic\u6A21\u578B" aria-hidden="true">#</a> \u7B2C\u4E94\u79CDtopic\u6A21\u578B</h3><h4 id="\u5F00\u53D1\u6D88\u8D39\u8005-7"><a class="header-anchor" href="#\u5F00\u53D1\u6D88\u8D39\u8005-7" aria-hidden="true">#</a> \u5F00\u53D1\u6D88\u8D39\u8005</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
* topic\u6A21\u578B
*/</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testTopic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token string">&quot;topics&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;user.save&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;\u53D1\u9001user.save \u8DEF\u7531\u4FE1\u606F&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u5F00\u53D1\u6D88\u8D39\u8005-8"><a class="header-anchor" href="#\u5F00\u53D1\u6D88\u8D39\u8005-8" aria-hidden="true">#</a> \u5F00\u53D1\u6D88\u8D39\u8005</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;topicConsumer&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Consumer</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>bindings <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@QueueBinding</span><span class="token punctuation">(</span>
                    value <span class="token operator">=</span> <span class="token annotation punctuation">@Queue</span><span class="token punctuation">,</span>
                    exchange <span class="token operator">=</span> <span class="token annotation punctuation">@Exchange</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;topics&quot;</span><span class="token punctuation">,</span>type <span class="token operator">=</span> <span class="token class-name">ExchangeTypes</span><span class="token punctuation">.</span>TOPIC<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    key <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;user.save&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;user.*&quot;</span><span class="token punctuation">}</span>
            <span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receive1</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;topic-1 message : &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>bindings <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@QueueBinding</span><span class="token punctuation">(</span>
                    value <span class="token operator">=</span> <span class="token annotation punctuation">@Queue</span><span class="token punctuation">,</span>
                    exchange <span class="token operator">=</span> <span class="token annotation punctuation">@Exchange</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;topics&quot;</span><span class="token punctuation">,</span>type <span class="token operator">=</span> <span class="token class-name">ExchangeTypes</span><span class="token punctuation">.</span>TOPIC<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    key <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;order.#&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;product.#&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;user.*&quot;</span><span class="token punctuation">}</span>
            <span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receive2</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;topic-2 message : &quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u6D4B\u8BD5\u7ED3\u679C-8"><a class="header-anchor" href="#\u6D4B\u8BD5\u7ED3\u679C-8" aria-hidden="true">#</a> \u6D4B\u8BD5\u7ED3\u679C</h4><p>\u5982\u679C\u6211\u4EEC\u53D1\u9001\u7684\u6D88\u606F\u7C7B\u578B\u662F<code>user.save</code>\u90A3\u4E48\u4E24\u4E2A\u6D88\u8D39\u8005\u90FD\u80FD\u63A5\u6536\u5230</p><p><img src="`+mn+'" alt="image-20211210163434714"></p><h2 id="mq\u7684\u5E94\u7528\u573A\u666F"><a class="header-anchor" href="#mq\u7684\u5E94\u7528\u573A\u666F" aria-hidden="true">#</a> MQ\u7684\u5E94\u7528\u573A\u666F</h2><h3 id="\u5F02\u6B65\u5904\u7406"><a class="header-anchor" href="#\u5F02\u6B65\u5904\u7406" aria-hidden="true">#</a> \u5F02\u6B65\u5904\u7406</h3><blockquote><p>\u573A\u666F\uFF1A\u7528\u6237\u6CE8\u518C\u540E\uFF0C\u9700\u8981\u53D1\u9001\u90AE\u4EF6\u6CE8\u518C\u548C\u6CE8\u518C\u77ED\u4FE1\uFF0C\u4F20\u7EDF\u7684\u505A\u6CD5\u6709\u4E24\u79CD\uFF1A</p><ul><li>\u4E32\u884C\u65B9\u5F0F</li><li>\u5E76\u884C\u65B9\u5F0F</li></ul></blockquote><ol><li>\u4E32\u884C\u65B9\u5F0F\uFF1A\u5C06\u6CE8\u518C\u4FE1\u606F\u5199\u5165\u6570\u636E\u5E93\u540E\uFF0C\u53D1\u9001\u6CE8\u518C\u90AE\u4EF6\uFF0C\u518D\u53D1\u9001\u6CE8\u518C\u77ED\u4FE1\uFF0C\u4EE5\u4E0A\u4E09\u4E2A\u4EFB\u52A1\u5168\u90E8\u5B8C\u6210\u4E4B\u540E\u624D\u8FD4\u56DE\u5BA2\u6237\u7AEF\u3002\u8FD9\u6709\u4E00\u4E2A\u95EE\u9898\u662F\uFF1A\u90AE\u4EF6\u3001\u77ED\u4FE1\u5E76\u4E0D\u662F\u5FC5\u987B\u7684\uFF0C\u5B83\u53EA\u662F\u4E00\u4E2A\u901A\u77E5\uFF0C\u800C\u8FD9\u79CD\u505A\u6CD5\u8BA9\u5BA2\u6237\u7AEF\u7B49\u5F85\u6CA1\u6709\u5FC5\u8981\u7B49\u5F85\u7684\u4E1C\u897F</li></ol><p><img src="'+bn+'" alt="image-20211210164308343"></p><ol start="2"><li>\u5E76\u884C\u65B9\u5F0F\uFF1A\u5C06\u6CE8\u518C\u4FE1\u606F\u5199\u5165\u6570\u636E\u5E93\u540E\uFF0C\u53D1\u9001\u90AE\u4EF6\u7684\u540C\u65F6\uFF0C\u53D1\u9001\u77ED\u4FE1\uFF0C\u4EE5\u4E0A\u4E09\u4E2A\u4EFB\u52A1\u5B8C\u6210\u4E4B\u540E\uFF0C\u8FD4\u56DE\u5BA2\u6237\u7AEF\uFF0C\u5E76\u884C\u7684\u65B9\u5F0F\u80FD\u63D0\u9AD8\u5904\u7406\u65F6\u95F4</li></ol><p><img src="'+vn+'" alt="image-20211210164443013"></p><ol start="3"><li>\u6D88\u606F\u961F\u5217\uFF1A\u5047\u8BBE\u4E09\u4E2A\u4E1A\u52A1\u8282\u70B9\u5206\u522B\u4F7F\u752850ms\uFF0C\u4E32\u884C\u7684\u65B9\u5F0F\u4F7F\u7528\u65F6\u95F4150ms\uFF0C\u5E76\u884C\u65F6\u95F4100ms\uFF0C\u867D\u7136\u5E76\u884C\u5DF2\u7ECF\u63D0\u9AD8\u4E86\u5904\u7406\u65F6\u95F4\uFF0C\u4F46\u662F\uFF0C\u524D\u9762\u8BF4\u8FC7\uFF0C\u90AE\u4EF6\u548C\u77ED\u4FE1\u5BF9\u6211\u6B63\u5E38\u4F7F\u7528\u7F51\u7AD9\u6CA1\u6709\u4EFB\u4F55\u5F71\u54CD\uFF0C\u5BA2\u6237\u7AEF\u6CA1\u6709\u5FC5\u8981\u7B49\u7740\u5176\u53D1\u9001\u5F2F\u6C89\u624D\u663E\u793A\u6CE8\u518C\u6210\u529F\uFF0C\u5E94\u8BE5\u662F\u5199\u5165\u6570\u636E\u5E93\u540E\u5C31\u8FD4\u56DE</li></ol><p><code>\u6D88\u606F\u961F\u5217</code>\uFF1A\u5F15\u5165\u6D88\u606F\u961F\u5217\u540E\uFF0C\u628A\u53D1\u9001\u90AE\u4EF6\u3001\u77ED\u4FE1\u4E0D\u662F\u5FC5\u987B\u7684\u4E1A\u52A1\u903B\u8F91\u5F02\u6B65\u5904\u7406</p><p><img src="'+gn+'" alt="image-20211210164930280"></p><p>\u7531\u6B64\u53EF\u4EE5\u770B\u51FA\uFF0C\u5F15\u5165\u6D88\u606F\u961F\u5217\u540E\uFF0C\u7528\u6237\u7684\u54CD\u5E94\u65F6\u95F4\u5C31\u7B49\u4E8E\u5199\u5165\u6570\u636E\u5E93\u7684\u65F6\u95F4+\u5199\u5165\u6D88\u606F\u961F\u5217\u7684\u65F6\u95F4\uFF08\u53EF\u4EE5\u5FFD\u7565\u4E0D\u8BA1\uFF09\uFF0C\u5F15\u5165\u6D88\u606F\u961F\u5217\u5904\u7406\u540E\uFF0C\u54CD\u5E94\u65F6\u95F4\u662F\u4E32\u884C\u76843\u500D\uFF0C\u662F\u5E76\u884C\u76842\u500D</p><h3 id="\u5E94\u7528\u89E3\u8026"><a class="header-anchor" href="#\u5E94\u7528\u89E3\u8026" aria-hidden="true">#</a> \u5E94\u7528\u89E3\u8026</h3><blockquote><p>\u573A\u666F\uFF1A\u53CC\u5341\u4E00\u662F\u8D2D\u7269\u72C2\u6B22\u8282\uFF0C\u7528\u6237\u4E0B\u5355\u540E\uFF0C\u8BA2\u5355\u7CFB\u7EDF\u9700\u8981\u901A\u77E5\u5E93\u5B58\u7CFB\u7EDF\uFF0C\u4F20\u7EDF\u7684\u505A\u6CD5\u5C31\u662F\u8BA2\u5355\u7CFB\u7EDF\u8C03\u7528\u5E93\u5B58\u7CFB\u7EDF\u7684\u63A5\u53E3</p><p><img src="'+hn+'" alt="image-20211210165241322"></p><ul><li>\u5E93\u5B58\u662F\u5FC5\u987B\u6263\u51CF\u7684\uFF0C\u5728\u4E1A\u52A1\u4E0A\u6765\u8BF4\uFF0C\u6709\u5E93\u5B58\u76F4\u63A5\u6263\u9664\u5373\u53EF\uFF0C\u6CA1\u6709\u5E93\u5B58\u6216\u8005\u4F4E\u4E8E\u67D0\u4E2A\u9608\u503C\uFF0C\u53EF\u4EE5\u6263\u51CF\u6210\u529F\uFF0C\u4E0D\u8FC7\u8981\u901A\u77E5\u5176\u4ED6\u7CFB\u7EDF\uFF08\u6BD4\u5982\u901A\u77E5\u5230\u91C7\u8D2D\u7CFB\u7EDF\u5C3D\u5FEB\u91C7\u8D2D\uFF0C\u901A\u77E5\u7528\u6237\u8BA2\u5355\u7CFB\u7EDF\u6211\u4EEC\u4F1A\u5C3D\u5FEB\u8C03\u8D27\uFF09</li></ul></blockquote><p>\u8FD9\u79CD\u505A\u6CD5\u6709\u4E00\u4E2A\u7F3A\u70B9\uFF1A</p><p>\u5F53\u5E93\u5B58\u7CFB\u7EDF\u51FA\u73B0\u6545\u969C\u7684\u65F6\u5019\uFF0C\u8BA2\u5355\u5C31\u4F1A\u5931\u8D25\u3002\u8BA2\u5355\u7CFB\u7EDF\u548C\u5E93\u5B58\u7CFB\u7EDF\u9AD8\u8026\u5408\u3002\u5F15\u5165\u6D88\u606F\u961F\u5217</p><p><img src="'+qn+'" alt="image-20211210165350873"></p><ul><li>\u8BA2\u5355\u7CFB\u7EDF\uFF1A\u7528\u6237\u4E0B\u5355\u540E\uFF0C\u8BA2\u5355\u7CFB\u7EDF\u5B8C\u6210\u6301\u7EED\u5316\u5904\u7406\u540E\uFF0C\u5C06\u6D88\u606F\u5199\u5165\u6D88\u606F\u961F\u5217\uFF0C\u8FD4\u56DE\u7528\u6237\u8BA2\u5355\u4E0B\u5355\u6210\u529F</li><li>\u5E93\u5B58\u7CFB\u7EDF\uFF1A\u8BA2\u9605\u4E0B\u5355\u7684\u6D88\u606F\uFF0C\u83B7\u53D6\u4E0B\u5355\u6D88\u606F\uFF0C\u8FDB\u884C\u5E93\u64CD\u4F5C\uFF0C\u5C31\u7B97\u5E93\u5B58\u7CFB\u7EDF\u51FA\u73B0\u6545\u969C\uFF0C\u6D88\u606F\u961F\u5217\u4E5F\u80FD\u4FDD\u8BC1\u6D88\u606F\u7684\u53EF\u9760\u6295\u9012\uFF0C\u4E0D\u4F1A\u5BFC\u81F4\u6D88\u606F\u4E22\u5931</li></ul><p>\u5BF9\u4E8E\u6211\u4EEC\u6D88\u606F\u6A21\u5F0F\u7684\u5B9E\u73B0\uFF0C\u4E3A\u4FDD\u8BC1\u5E93\u5B58\u5FC5\u987B\u6709\u6263\u51CF\uFF0C\u6211\u4EEC\u5FC5\u987B\u8003\u8651\u51E0\u4E2A\u95EE\u9898\uFF1A</p><ul><li>\u8BA2\u5355\u7CFB\u7EDF\u53D1\u7ED9mq\u670D\u52A1\u5668\u7684\u6263\u51CF\u5E93\u5B58\u7684\u6D88\u606F\u5FC5\u987B\u8981\u88ABmq\u670D\u52A1\u5668\u63A5\u6536\u5230\uFF0C\u610F\u5473\u7740\u9700\u8981\u4F7F\u7528\u53D1\u9001\u8005\u786E\u8BA4 <ul><li><code>publisherConfirm=true</code></li><li><code>mandatory=true</code></li><li><code>sendReturnCallback</code></li></ul></li><li>mq\u670D\u52A1\u5668\u5728\u6263\u51CF\u5E93\u5B58\u7684\u6D88\u606F\u88AB\u5E93\u5B58\u670D\u52A1\u6B63\u786E\u5904\u7406\u524D\u5FC5\u987B\u4E00\u76F4\u5B58\u5728\uFF0C\u90A3\u4E48\u9700\u8981\u6D88\u606F\u8FDB\u884C\u6301\u4E45\u5316 <ul><li>\u4EA4\u6362\u5668\u6301\u4E45\u5316<code>durable=true</code></li><li><code>MessageDeliveryMode.PERSISTENT</code></li></ul></li><li>\u67D0\u4E2A\u5E93\u5B58\u670D\u52A1\u5668\u51FA\u4E86\u95EE\u9898\uFF0C\u6263\u51CF\u5E93\u5B58\u7684\u6D88\u606F\u8981\u80FD\u591F\u88AB\u5176\u4ED6\u6B63\u5E38\u7684\u5E93\u5B58\u670D\u52A1\u5904\u7406\uFF0C\u9700\u8981\u6211\u4EEC\u81EA\u884C\u5BF9\u6D88\u8D39\u8FDB\u884C\u786E\u8BA4\uFF0C\u610F\u5473\u7740\u4E0D\u80FD\u4F7F\u7528\u6D88\u8D39\u8005\u81EA\u52A8\u786E\u8BA4\uFF0C\u800C\u5E94\u8BE5\u4F7F\u7528\u624B\u52A8\u786E\u8BA4 <ul><li><code>autoAck=false</code></li><li>\u5728\u6D88\u606F\u5904\u7406\u5B8C\u6210\u4E4B\u540E\u901A\u77E5\u961F\u5217\u5904\u7406\u5B8C\u6210</li></ul></li></ul><h3 id="\u6D41\u91CF\u524A\u5CF0"><a class="header-anchor" href="#\u6D41\u91CF\u524A\u5CF0" aria-hidden="true">#</a> \u6D41\u91CF\u524A\u5CF0</h3><blockquote><p>\u573A\u666F\uFF1A\u79D2\u6740\u6D3B\u52A8\uFF0C\u4E00\u822C\u4F1A\u56E0\u4E3A\u6D41\u91CF\u8FC7\u5927\uFF0C\u5BFC\u81F4\u5E94\u7528\u6302\u6389\uFF0C\u4E3A\u4E86\u89E3\u51B3\u8FD9\u4E2A\u95EE\u9898\uFF0C\u4E00\u822C\u5728\u5E94\u7528\u524D\u7AEF\u52A0\u5165\u6D88\u606F\u961F\u5217</p></blockquote><p>\u4F5C\u7528\uFF1A</p><ol><li>\u53EF\u4EE5\u63A7\u5236\u6D3B\u52A8\u4EBA\u6570\uFF0C\u8D85\u8FC7\u6B64\u4E00\u5B9A\u9608\u503C\u7684\u8BA2\u5355\u76F4\u63A5\u4E22\u5F03\uFF08\u6211\u4E3A\u4EC0\u4E48\u79D2\u6740\u6D3B\u52A8\u4E00\u6B21\u90FD\u6CA1\u6709\u6210\u529F\u8FC7\u5462\uFF09</li><li>\u53EF\u4EE5\u7F13\u89E3\u77ED\u65F6\u95F4\u7684\u9AD8\u6D41\u91CF\u538B\u57AE\u5E94\u7528\uFF08\u5E94\u7528\u7A0B\u5E8F\u6309\u81EA\u5DF1\u7684\u6700\u5927\u5904\u7406\u80FD\u529B\u83B7\u53D6\u8BA2\u5355\uFF09</li></ol><h2 id="rabbitmq\u7684\u96C6\u7FA4"><a class="header-anchor" href="#rabbitmq\u7684\u96C6\u7FA4" aria-hidden="true">#</a> rabbitmq\u7684\u96C6\u7FA4</h2><blockquote><p>\u5206\u5E03\u5F0Frabbitmq - \u5B98\u65B9\u7F51\u5740\uFF1Ahttps://www.rabbitmq.com/distributed.html</p></blockquote><p>rabbitmq\u63D0\u4F9B\u4E24\u5957\u96C6\u7FA4\u67B6\u6784\uFF0C\u5206\u522B\u4E3A\uFF1A\u666E\u901A\u96C6\u7FA4\u548C\u955C\u50CF\u96C6\u7FA4</p><h3 id="\u96C6\u7FA4\u67B6\u6784"><a class="header-anchor" href="#\u96C6\u7FA4\u67B6\u6784" aria-hidden="true">#</a> \u96C6\u7FA4\u67B6\u6784</h3><h4 id="\u666E\u901A\u96C6\u7FA4-\u526F\u672C\u96C6\u7FA4"><a class="header-anchor" href="#\u666E\u901A\u96C6\u7FA4-\u526F\u672C\u96C6\u7FA4" aria-hidden="true">#</a> \u666E\u901A\u96C6\u7FA4(\u526F\u672C\u96C6\u7FA4)</h4>',378),Nn=n("p",null,"clustering - \u5B98\u65B9\u7F51\u5740\uFF1Ahttps://www.rabbitmq.com/clustering.html",-1),Fn=s("All data/state required for the operation of a RabbitMQ broker is replicated across all nodes. An exception to this are message queues, which by default reside on one node, though they are visible and reachable from all nodes. To replicate queues across nodes in a cluster, use a queue type that supports replication. This topic is covered in the "),Ln={href:"https://www.rabbitmq.com/quorum-queues.html",target:"_blank",rel:"noopener noreferrer"},Bn=s("Quorum Queues"),Hn=s(" guide. --\u6458\u81EA\u5B98\u7F51"),Un=n("p",null,"\u7FFB\u8BD1\uFF1A",-1),Kn=n("p",null,"RabbitMQ \u4EE3\u7406\u64CD\u4F5C\u6240\u9700\u7684\u6240\u6709\u6570\u636E/\u72B6\u6001\u90FD\u5728\u6240\u6709\u8282\u70B9\u4E4B\u95F4\u590D\u5236\u3002\u4E00\u4E2A\u4F8B\u5916\u662F\u6D88\u606F\u961F\u5217\uFF0C\u5B83\u4EEC\u9ED8\u8BA4\u9A7B\u7559\u5728\u4E00\u4E2A\u8282\u70B9\u4E0A\uFF0C\u5C3D\u7BA1\u5B83\u4EEC\u5BF9\u6240\u6709\u8282\u70B9\u90FD\u662F\u53EF\u89C1\u548C\u53EF\u8BBF\u95EE\u7684\u3002\u8981\u8DE8\u96C6\u7FA4\u4E2D\u7684\u8282\u70B9\u590D\u5236\u961F\u5217\uFF0C\u8BF7\u4F7F\u7528\u652F\u6301\u590D\u5236\u7684\u961F\u5217\u7C7B\u578B\u3002 Quorum Queues \u6307\u5357\u4E2D\u4ECB\u7ECD\u4E86\u8BE5\u4E3B\u9898\u3002",-1),Vn=a('<p><strong>\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0Crabbitmq\u4EE3\u7406\u64CD\u4F5C\u6240\u9700\u7684\u6240\u6709\u6570\u636E/\u72B6\u6001\u90FD\u5C06\u8DE8\u6240\u6709\u7684\u8282\u70B9\u590D\u5236\uFF0C\u8FD9\u65B9\u9762\u7684\u4E00\u4E2A\u4F8B\u5916\u662F\u6D88\u606F\u961F\u5217\uFF0C\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u6D88\u606F\u961F\u5217\u4F4D\u4E8E\u4E00\u4E2A\u8282\u70B9\u4E0A\uFF0C\u5C3D\u7BA1\u4ED6\u4EEC\u53EF\u4EE5\u4ECE\u6240\u6709\u7684\u8282\u70B9\u770B\u5230\u548C\u8BBF\u95EE</strong></p><p>\u5B9E\u9645\u4E0A\u5728RabbitMQ\u4E2D\uFF0CQueue\u624D\u662F\u771F\u6B63\u5B58\u50A8\u6D88\u606F\u7684\uFF0C\u65E5\u540E\u6211\u4EEC\u6784\u5EFARabbitMQ\u96C6\u7FA4\u53EF\u80FD\u6709\u4E09\u4E2A\u8282\u70B9\uFF0C\u4E00\u4E2AMaster\u8282\u70B9\uFF0C\u4E24\u4E2ASlave\u8282\u70B9\u3002</p><p>\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u6D88\u606F\u961F\u5217\u53EA\u4F4D\u4E8EMaster\u8282\u70B9\u4E0A\u3002Slave\u8282\u70B9\u53EA\u80FD\u5BF9Master\u8282\u70B9\u7684\u961F\u5217\u8FDB\u884C\u8BFB\u64CD\u4F5C\uFF0C\u800C\u4E0D\u80FD\u8FDB\u884C\u5199\u64CD\u4F5C\u3002\u800CMaster\u8282\u70B9\u65E2\u53EF\u4EE5\u5BF9\u5176\u961F\u5217\u8FDB\u884C\u8BFB\u64CD\u4F5C\uFF0C\u4E5F\u53EF\u4EE5\u5BF9\u5176\u961F\u5217\u8FDB\u884C\u5199\u64CD\u4F5C</p><p>\u8FD9\u79CD\u96C6\u7FA4\u4E5F\u53EB\u505A &quot;\u4E3B\u4ECE\u590D\u5236&quot; \u96C6\u7FA4\uFF0C\u4E3B\u8282\u70B9\u771F\u6B63\u53BB\u548C\u751F\u4EA7\u8005\u6253\u4EA4\u9053\uFF0C\u4ECE\u8282\u70B9\u53EA\u7528\u6765\u540C\u6B65\u4E3B\u8282\u70B9\u7684\u76F8\u5E94\u6570\u636E</p><p>\u4ECE\u8282\u70B9\u867D\u7136\u80FD\u591F\u5907\u4EFD\u4E3B\u8282\u70B9\u4E2D\u6240\u6709\u7684\u6570\u636E\uFF0C\u4F46\u662F\u4E0D\u540C\u6570\u636E\u7684\u540C\u6B65\u89C4\u5219\u4E0D\u76F8\u540C\u3002\u4ECE\u8282\u70B9\u53EA\u80FD\u5B9E\u65F6\u540C\u6B65\u4E3B\u8282\u70B9Exchange\u4E2D\u7684\u6570\u636E\uFF0C\u4E0D\u80FD\u5B9E\u65F6\u540C\u6B65\u4E3B\u8282\u70B9Queue\u4E2D\u7684\u4FE1\u606F</p><p>\u6D88\u8D39\u8005\u53EF\u4EE5\u8BA2\u9605\u4E3B\u8282\u70B9\uFF0C\u4E5F\u53EF\u4EE5\u8BA2\u9605\u4ECE\u8282\u70B9\uFF0C\u5F53\u8BA2\u9605\u4E3B\u8282\u70B9\u65F6\uFF0C\u53EF\u4EE5\u83B7\u5F97Queue\u4E2D\u5B9E\u65F6\u7684\u4FE1\u606F\uFF1B\u8BA2\u9605\u4ECE\u8282\u70B9\u65F6\uFF0C\u4ECE\u8282\u70B9\u4F1A\u81EA\u52A8\u53BB\u4E3B\u8282\u70B9\u4E2D\u7684Queue\u8BFB\u53D6\u6570\u636E\uFF0C\u7531\u4E8E\u591A\u4E86\u4E00\u6B65\u64CD\u4F5C\uFF0C\u6240\u4EE5\u8BFB\u53D6\u5230\u7684\u6570\u636E\u5DF2\u7ECF\u4E0D\u662F\u5B9E\u65F6\u6570\u636E\u4E86</p><p>\u8BE5\u96C6\u7FA4\u67B6\u6784\u5E76\u4E0D\u9AD8\u53EF\u7528\uFF0C\u516C\u53F8\u4E2D\u4F7F\u7528\u7684\u5F88\u5C11</p><p>\u867D\u7136\u5728\u8BE5\u67B6\u6784\u4E2D\uFF0C\u4ECE\u8282\u70B9\u53EF\u4EE5\u51CF\u5C11\u6D88\u8D39\u8005\u5BF9\u4E8E\u4E3B\u8282\u70B9\u7684\u538B\u529B\uFF0C\u4F46\u662F\u5982\u679C\u5F53\u4E3B\u8282\u70B9\u5FFD\u7136\u5B95\u673A\uFF0C\u8BE5\u96C6\u7FA4\u65E0\u6CD5\u8FDB\u884C\u6545\u969C\u8F6C\u79FB\uFF0C\u4E5F\u5C31\u662F\u4ECE\u8282\u70B9\u65E0\u6CD5\u4EE3\u66FF\u4E3B\u8282\u70B9\u6210\u4E3A\u65B0\u4E3B\u8282\u70B9\uFF0C\u56E0\u4E3A<strong>\u4ECE\u8282\u70B9\u867D\u7136\u53EF\u4EE5\u5B9E\u65F6\u540C\u6B65\u4E3B\u8282\u70B9\u7684Exchange\u6570\u636E\uFF0C\u4E5F\u53EF\u4EE5\u540C\u6B65Queue(\u6BD4\u5982\uFF1A\u77E5\u9053\u4E3B\u8282\u70B9\u6709\u65B0\u7684queue\u521B\u5EFA)\uFF0C\u5E76\u4E0D\u80FD\u5B9E\u65F6\u540C\u6B65\u4E3B\u8282\u70B9\u7684Queue\u6570\u636E(\u6D88\u606F)</strong>\uFF0C\u4E5F\u5C31\u662F\u8BF4\u4ECE\u8282\u70B9\u7684\u6570\u636E\u53EF\u80FD\u4E0D\u662F\u5B8C\u6574\u7684</p><h5 id="\u67B6\u6784\u56FE"><a class="header-anchor" href="#\u67B6\u6784\u56FE" aria-hidden="true">#</a> \u67B6\u6784\u56FE</h5><p><img src="'+fn+`" alt="image-20211210181040462"></p><p>\u4E4B\u540E\u6784\u5EFA\u96C6\u7FA4\u4E4B\u540E\uFF0C\u53EF\u80FD\u5728\u96C6\u7FA4\u4E2D\u6709\u4E09\u4E2A\u8282\u70B9\uFF1A</p><ul><li>\u4E00\u4E2A\u4E3B\u8282\u70B9 master</li><li>\u4E24\u4E2A\u526F\u8282\u70B9 slave</li></ul><p>**\u4E3B\u4ECE\u6A21\u5F0F\uFF1A**\u66F4\u51C6\u786E\u7684\u8BF4\u5E94\u8BE5\u53EB\u4E3B\u5907\u6A21\u5F0F</p><p>\u4E3B\u8282\u70B9\u4E0A\u7684\u6240\u6709\u7684\u6570\u636E\u90FD\u53EF\u4EE5\u590D\u5236\u5230\u526F\u8282\u70B9\u4E0A\uFF0C\u4F46\u662F\u4E3B\u8282\u70B9\u4E0A\u7684\u961F\u5217\u662F\u6CA1\u54DF\u529E\u6CD5\u590D\u5236\u5230\u526F\u8282\u70B9\u4E0A\u7684\uFF0C\u4E5F\u5C31\u662F\u8BF4\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u6D88\u606F\u961F\u5217\u53EA\u4F4D\u4E8E\u4E3B\u8282\u70B9\u4E0A</p><p>\u4E5F\u5C31\u662F\u8BF4\uFF0C\u6570\u636E\u90FD\u662F\u5B58\u50A8\u5728\u4E3B\u673A\u8282\u70B9\u4E0A\u7684\uFF0C\u5176\u4ED6\u526F\u8282\u70B9\u53EF\u4EE5\u770B\u5230(\u8BBF\u95EE)\uFF0C\u4F46\u662F\u5BF9\u6D88\u606F\u961F\u5217\u7684\u64CD\u4F5C\u662F\u6709\u9650\u5236\u7684</p><p>\u67D0\u4E9B\u60C5\u51B5\u4E0B\uFF0C\u5F53\u4E3B\u8282\u70B9\u5B95\u673A\u7684\u60C5\u51B5\u4E0B\uFF0C\u526F\u8282\u70B9\u4E5F\u6CA1\u6709\u529E\u6CD5\u53BB\u5207\u6362\u6210\u4E3B\u8282\u70B9</p><p>**\u6838\u5FC3\u89E3\u51B3\u95EE\u9898\uFF1A**\u5F53\u96C6\u7FA4\u4E2D\uFF0C\u67D0\u4E00\u65F6\u523B\uFF0Cmaster\u8282\u70B9\u5B95\u673A\uFF0C\u53EF\u4EE5\u5BF9queue\u4E2D\u7684\u4FE1\u606F\u8FDB\u884C\u5907\u4EFD\uFF0C\u4F46\u662F\u8FD9queue\u4E0D\u662F\u5B9E\u65F6\u7684</p><h5 id="\u96C6\u7FA4\u642D\u5EFA"><a class="header-anchor" href="#\u96C6\u7FA4\u642D\u5EFA" aria-hidden="true">#</a> \u96C6\u7FA4\u642D\u5EFA</h5><h6 id="\u914D\u7F6E\u73AF\u5883"><a class="header-anchor" href="#\u914D\u7F6E\u73AF\u5883" aria-hidden="true">#</a> \u914D\u7F6E\u73AF\u5883</h6><div class="language-markdown ext-md line-numbers-mode"><pre class="language-markdown"><code><span class="token title important"><span class="token punctuation">##</span> 0 \u96C6\u7FA4\u89C4\u5212</span>
	centos2	172.16.187.10	mq1	master	\u4E3B\u8282\u70B9
	centos3	172.16.187.11	mq2	repl1		\u526F\u672C\u8282\u70B9
	centos4 172.16.187.12 mq3	repl2		\u526F\u672C\u8282\u70B9

<span class="token title important"><span class="token punctuation">##</span> 1 \u514B\u9686\u4E09\u53F0\u673A\u5668\u4E3B\u673A\u540D\u548Cip\u6620\u5C04</span>
	vim /etc/hosts \u52A0\u5165\uFF1A
		172.16.187.10	mq1
		172.16.187.11	mq2
		172.16.187.12	mq3
	centos2: vim /etc/hostname \u52A0\u5165 mq1
	centos3: vim /etc/hostname \u52A0\u5165 mq2
	centos4: vim /etc/hostname \u52A0\u5165 mq3
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="\u5B89\u88C5rabbitmq-1"><a class="header-anchor" href="#\u5B89\u88C5rabbitmq-1" aria-hidden="true">#</a> \u5B89\u88C5rabbitmq</h6><p>rabbitmq\u7684\u5B89\u88C5\uFF0C\u867D\u7136\u4E4B\u524D\u5728centos\u4E0A\u6709\u5B89\u88C5\uFF0C\u4F46\u662F\u611F\u89C9\u81EA\u5DF1\u628A\u5B83\u641E\u590D\u6742\u5316\u4E86\uFF0C\u4E0B\u9762\u7684\u662F\u5B98\u65B9\u7684\u5B89\u88C5\u65B9\u5F0F</p><blockquote><p><strong>Install Packages with Yum</strong></p><p><strong>CentOS 7</strong></p><p>Update Yum package metadata:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>yum update -y
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Next, install the packages:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">### install these dependencies from standard OS repositories</span>
yum <span class="token function">install</span> socat <span class="token function">logrotate</span> -y

yum <span class="token function">install</span> erlang <span class="token number">11</span>.rabbitmq-server -y
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><p>\u51FA\u73B0\u9519\u8BEF\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@mq3 ~<span class="token punctuation">]</span><span class="token comment">## yum install erlang 11.rabbitmq-server -y</span>
\u5DF2\u52A0\u8F7D\u63D2\u4EF6\uFF1Afastestmirror
Loading mirror speeds from cached hostfile
 * base: mirrors.dgut.edu.cn
 * extras: mirrors.aliyun.com
 * updates: mirrors.aliyun.com
\u6CA1\u6709\u53EF\u7528\u8F6F\u4EF6\u5305 erlang\u3002
\u6CA1\u6709\u53EF\u7528\u8F6F\u4EF6\u5305 <span class="token number">11</span>.rabbitmq-server\u3002
\u9519\u8BEF\uFF1A\u65E0\u987B\u4EFB\u4F55\u5904\u7406
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u89E3\u51B3\u65B9\u6848\uFF0C\u6DFB\u52A0erlang\u548Crabbitmq\u7684\u6E90</p><blockquote><p><strong>Add Yum Repositories for RabbitMQ and Modern Erlang</strong></p><p>In order to use the Yum repository, a .repo file (e.g. rabbitmq.repo) has to be added under the /etc/yum.repos.d/ directory.</p><p><strong>Red Hat 7, CentOS 7</strong></p><p>The following example sets up a repository that will install RabbitMQ and its Erlang dependency from PackageCloud, and targets <strong>CentOS 7</strong>. There are slight differences to CentOS 8 instructions.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">## In /etc/yum.repos.d/11.rabbitmq.repo</span>

<span class="token comment">##</span>
<span class="token comment">### Zero dependency Erlang</span>
<span class="token comment">##</span>

<span class="token punctuation">[</span>rabbitmq_erlang<span class="token punctuation">]</span>
<span class="token assign-left variable">name</span><span class="token operator">=</span>rabbitmq_erlang
<span class="token assign-left variable">baseurl</span><span class="token operator">=</span>https://packagecloud.io/rabbitmq/erlang/el/7/<span class="token variable">$basearch</span>
<span class="token assign-left variable">repo_gpgcheck</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">gpgcheck</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">enabled</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token comment">## PackageCloud&#39;s repository key and RabbitMQ package signing key</span>
<span class="token assign-left variable">gpgkey</span><span class="token operator">=</span>https://packagecloud.io/rabbitmq/erlang/gpgkey
    https://github.com/rabbitmq/signing-keys/releases/download/2.0/rabbitmq-release-signing-key.asc
<span class="token assign-left variable">sslverify</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">sslcacert</span><span class="token operator">=</span>/etc/pki/tls/certs/ca-bundle.crt
<span class="token assign-left variable">metadata_expire</span><span class="token operator">=</span><span class="token number">300</span>

<span class="token punctuation">[</span>rabbitmq_erlang-source<span class="token punctuation">]</span>
<span class="token assign-left variable">name</span><span class="token operator">=</span>rabbitmq_erlang-source
<span class="token assign-left variable">baseurl</span><span class="token operator">=</span>https://packagecloud.io/rabbitmq/erlang/el/7/SRPMS
<span class="token assign-left variable">repo_gpgcheck</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">gpgcheck</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token assign-left variable">enabled</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">gpgkey</span><span class="token operator">=</span>https://packagecloud.io/rabbitmq/erlang/gpgkey
<span class="token assign-left variable">sslverify</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">sslcacert</span><span class="token operator">=</span>/etc/pki/tls/certs/ca-bundle.crt
<span class="token assign-left variable">metadata_expire</span><span class="token operator">=</span><span class="token number">300</span>

<span class="token comment">##</span>
<span class="token comment">### RabbitMQ server</span>
<span class="token comment">##</span>

<span class="token punctuation">[</span>rabbitmq_server<span class="token punctuation">]</span>
<span class="token assign-left variable">name</span><span class="token operator">=</span>rabbitmq_server
<span class="token assign-left variable">baseurl</span><span class="token operator">=</span>https://packagecloud.io/rabbitmq/rabbitmq-server/el/7/<span class="token variable">$basearch</span>
<span class="token assign-left variable">repo_gpgcheck</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">gpgcheck</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">enabled</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token comment">## PackageCloud&#39;s repository key and RabbitMQ package signing key</span>
<span class="token assign-left variable">gpgkey</span><span class="token operator">=</span>https://packagecloud.io/rabbitmq/rabbitmq-server/gpgkey
    https://github.com/rabbitmq/signing-keys/releases/download/2.0/rabbitmq-release-signing-key.asc
<span class="token assign-left variable">sslverify</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">sslcacert</span><span class="token operator">=</span>/etc/pki/tls/certs/ca-bundle.crt
<span class="token assign-left variable">metadata_expire</span><span class="token operator">=</span><span class="token number">300</span>

<span class="token punctuation">[</span>rabbitmq_server-source<span class="token punctuation">]</span>
<span class="token assign-left variable">name</span><span class="token operator">=</span>rabbitmq_server-source
<span class="token assign-left variable">baseurl</span><span class="token operator">=</span>https://packagecloud.io/rabbitmq/rabbitmq-server/el/7/SRPMS
<span class="token assign-left variable">repo_gpgcheck</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">gpgcheck</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token assign-left variable">enabled</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">gpgkey</span><span class="token operator">=</span>https://packagecloud.io/rabbitmq/rabbitmq-server/gpgkey
<span class="token assign-left variable">sslverify</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">sslcacert</span><span class="token operator">=</span>/etc/pki/tls/certs/ca-bundle.crt
<span class="token assign-left variable">metadata_expire</span><span class="token operator">=</span><span class="token number">300</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><p>\u6DFB\u52A0\u4E4B\u540E\u91CD\u65B0<code>yum install erlang rabbitmq-server -y</code>\uFF0C\u5982\u679C\u51FA\u73B0\u7B7E\u540D\u4E0B\u8F7D\u5931\u8D25\u7684\u60C5\u51B5\uFF0C\u8BF7\u8D70\u4EE3\u7406</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@mq1 ~<span class="token punctuation">]</span><span class="token comment">## yum install erlang 11.rabbitmq-server -y</span>
\u5DF2\u52A0\u8F7D\u63D2\u4EF6\uFF1Afastestmirror
Loading mirror speeds from cached hostfile
 * base: mirrors.ustc.edu.cn
 * extras: mirrors.ustc.edu.cn
 * updates: mirrors.ustc.edu.cn
\u6B63\u5728\u89E3\u51B3\u4F9D\u8D56\u5173\u7CFB
--<span class="token operator">&gt;</span> \u6B63\u5728\u68C0\u67E5\u4E8B\u52A1
---<span class="token operator">&gt;</span> \u8F6F\u4EF6\u5305 erlang.x86_64.0.23.3.4.8-1.el7 \u5C06\u88AB \u5B89\u88C5
---<span class="token operator">&gt;</span> \u8F6F\u4EF6\u5305 <span class="token number">11</span>.rabbitmq-server.noarch.0.3.9.11-1.el7 \u5C06\u88AB \u5B89\u88C5
--<span class="token operator">&gt;</span> \u89E3\u51B3\u4F9D\u8D56\u5173\u7CFB\u5B8C\u6210

\u4F9D\u8D56\u5173\u7CFB\u89E3\u51B3

<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
 Package             \u67B6\u6784       \u7248\u672C                  \u6E90                   \u5927\u5C0F
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
\u6B63\u5728\u5B89\u88C5:
 erlang              x86_64     <span class="token number">23.3</span>.4.8-1.el7        rabbitmq_erlang      <span class="token number">19</span> M
 <span class="token number">11</span>.rabbitmq-server     noarch     <span class="token number">3.9</span>.11-1.el7          rabbitmq_server      <span class="token number">14</span> M

\u4E8B\u52A1\u6982\u8981
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
\u5B89\u88C5  <span class="token number">2</span> \u8F6F\u4EF6\u5305

\u603B\u8BA1\uFF1A33 M
\u5B89\u88C5\u5927\u5C0F\uFF1A52 M
Downloading packages:
\u8B66\u544A\uFF1A/var/cache/yum/x86_64/7/rabbitmq_server/packages/11.rabbitmq-server-3.9.11-1.el7.noarch.rpm: \u5934V4 RSA/SHA512 Signature, \u5BC6\u94A5 ID 6026dfca: NOKEY
\u4ECE https://packagecloud.io/11.rabbitmq/11.rabbitmq-server/gpgkey \u68C0\u7D22\u5BC6\u94A5
\u4ECE https://github.com/11.rabbitmq/signing-keys/releases/download/2.0/11.rabbitmq-release-signing-key.asc \u68C0\u7D22\u5BC6\u94A5
\u5BFC\u5165 GPG key 0x6026DFCA:
 \u7528\u6237ID     <span class="token builtin class-name">:</span> <span class="token string">&quot;RabbitMQ Release Signing Key &lt;info@rabbitmq.com&gt;&quot;</span>
 \u6307\u7EB9       <span class="token builtin class-name">:</span> 0a9a f211 5f46 87bd <span class="token number">2980</span> 3a20 6b73 a36e <span class="token number">6026</span> dfca
 \u6765\u81EA       <span class="token builtin class-name">:</span> https://github.com/11.rabbitmq/signing-keys/releases/download/2.0/11.rabbitmq-release-signing-key.asc
Running transaction check
Running transaction <span class="token builtin class-name">test</span>
Transaction <span class="token builtin class-name">test</span> succeeded
Running transaction
  \u6B63\u5728\u5B89\u88C5    <span class="token builtin class-name">:</span> erlang-23.3.4.8-1.el7.x86_64                                <span class="token number">1</span>/2
  \u6B63\u5728\u5B89\u88C5    <span class="token builtin class-name">:</span> <span class="token number">11</span>.rabbitmq-server-3.9.11-1.el7.noarch                         <span class="token number">2</span>/2
  \u9A8C\u8BC1\u4E2D      <span class="token builtin class-name">:</span> <span class="token number">11</span>.rabbitmq-server-3.9.11-1.el7.noarch                         <span class="token number">1</span>/2
  \u9A8C\u8BC1\u4E2D      <span class="token builtin class-name">:</span> erlang-23.3.4.8-1.el7.x86_64                                <span class="token number">2</span>/2

\u5DF2\u5B89\u88C5:
  erlang.x86_64 <span class="token number">0</span>:23.3.4.8-1.el7      <span class="token number">11</span>.rabbitmq-server.noarch <span class="token number">0</span>:3.9.11-1.el7

\u5B8C\u6BD5\uFF01
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u9A8C\u8BC1\u5B89\u88C5\u60C5\u51B5\uFF1A</p><ol><li><p>erlang\uFF1Aerl -v</p></li><li><p>rabbitmq</p></li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@mq1 ~<span class="token punctuation">]</span><span class="token comment">## systemctl start 11.rabbitmq-server</span>
<span class="token punctuation">[</span>root@mq1 ~<span class="token punctuation">]</span><span class="token comment">## systemctl status 11.rabbitmq-server</span>
\u25CF <span class="token number">11</span>.rabbitmq-server.service - RabbitMQ broker
   Loaded: loaded <span class="token punctuation">(</span>/usr/lib/systemd/system/11.rabbitmq-server.service<span class="token punctuation">;</span> disabled<span class="token punctuation">;</span> vendor preset: disabled<span class="token punctuation">)</span>
   Active: active <span class="token punctuation">(</span>running<span class="token punctuation">)</span> since \u4E94 <span class="token number">2021</span>-12-10 <span class="token number">20</span>:46:08 CST<span class="token punctuation">;</span> 21s ago
 Main PID: <span class="token number">49712</span> <span class="token punctuation">(</span>beam.smp<span class="token punctuation">)</span>
   CGroup: /system.slice/11.rabbitmq-server.service
           \u251C\u250049712 /usr/lib64/erlang/erts-11.2.2.7/bin/beam.smp -W w -MBas ag<span class="token punctuation">..</span>.
           \u251C\u250049727 erl_child_setup <span class="token number">32768</span>
           \u251C\u250049752 /usr/lib64/erlang/erts-11.2.2.7/bin/epmd -daemon
           \u251C\u250049775 inet_gethost <span class="token number">4</span>
           \u2514\u250049776 inet_gethost <span class="token number">4</span>

<span class="token number">12</span>\u6708 <span class="token number">10</span> <span class="token number">20</span>:46:05 mq1 <span class="token number">11</span>.rabbitmq-server<span class="token punctuation">[</span><span class="token number">49712</span><span class="token punctuation">]</span>: Doc guides:  https://11.rabbitmq<span class="token punctuation">..</span><span class="token punctuation">..</span>l
<span class="token number">12</span>\u6708 <span class="token number">10</span> <span class="token number">20</span>:46:05 mq1 <span class="token number">11</span>.rabbitmq-server<span class="token punctuation">[</span><span class="token number">49712</span><span class="token punctuation">]</span>: Support:     https://11.rabbitmq<span class="token punctuation">..</span><span class="token punctuation">..</span>l
<span class="token number">12</span>\u6708 <span class="token number">10</span> <span class="token number">20</span>:46:05 mq1 <span class="token number">11</span>.rabbitmq-server<span class="token punctuation">[</span><span class="token number">49712</span><span class="token punctuation">]</span>: Tutorials:   https://11.rabbitmq<span class="token punctuation">..</span><span class="token punctuation">..</span>l
<span class="token number">12</span>\u6708 <span class="token number">10</span> <span class="token number">20</span>:46:05 mq1 <span class="token number">11</span>.rabbitmq-server<span class="token punctuation">[</span><span class="token number">49712</span><span class="token punctuation">]</span>: Monitoring:  https://11.rabbitmq<span class="token punctuation">..</span><span class="token punctuation">..</span>l
<span class="token number">12</span>\u6708 <span class="token number">10</span> <span class="token number">20</span>:46:05 mq1 <span class="token number">11</span>.rabbitmq-server<span class="token punctuation">[</span><span class="token number">49712</span><span class="token punctuation">]</span>: Logs: /var/log/11.rabbitmq/rabbit<span class="token punctuation">..</span>.g
<span class="token number">12</span>\u6708 <span class="token number">10</span> <span class="token number">20</span>:46:05 mq1 <span class="token number">11</span>.rabbitmq-server<span class="token punctuation">[</span><span class="token number">49712</span><span class="token punctuation">]</span>: /var/log/11.rabbitmq/rabbit@mq1_u<span class="token punctuation">..</span>.g
<span class="token number">12</span>\u6708 <span class="token number">10</span> <span class="token number">20</span>:46:05 mq1 <span class="token number">11</span>.rabbitmq-server<span class="token punctuation">[</span><span class="token number">49712</span><span class="token punctuation">]</span>: <span class="token operator">&lt;</span>stdout<span class="token operator">&gt;</span>
<span class="token number">12</span>\u6708 <span class="token number">10</span> <span class="token number">20</span>:46:05 mq1 <span class="token number">11</span>.rabbitmq-server<span class="token punctuation">[</span><span class="token number">49712</span><span class="token punctuation">]</span>: Config file<span class="token punctuation">(</span>s<span class="token punctuation">)</span>: <span class="token punctuation">(</span>none<span class="token punctuation">)</span>
<span class="token number">12</span>\u6708 <span class="token number">10</span> <span class="token number">20</span>:46:08 mq1 <span class="token number">11</span>.rabbitmq-server<span class="token punctuation">[</span><span class="token number">49712</span><span class="token punctuation">]</span>: Starting broker<span class="token punctuation">..</span>. completed w<span class="token punctuation">..</span><span class="token punctuation">..</span>
<span class="token number">12</span>\u6708 <span class="token number">10</span> <span class="token number">20</span>:46:08 mq1 systemd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: Started RabbitMQ broker.
Hint: Some lines were ellipsized, use -l to show <span class="token keyword">in</span> full.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="\u914D\u7F6Erabbitmq-1"><a class="header-anchor" href="#\u914D\u7F6Erabbitmq-1" aria-hidden="true">#</a> \u914D\u7F6Erabbitmq</h6><ol><li>\u5F00\u542Fweb\u7BA1\u7406\u63D2\u4EF6</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">11</span>.rabbitmq-plugins <span class="token builtin class-name">enable</span> rabbitmq_management
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="2"><li>\u914D\u7F6Erabbitmq\u914D\u7F6E\u6587\u4EF6</li></ol><p>\u80FD\u8BA9guest\u80FD\u5728web\u7BA1\u7406\u754C\u9762\u767B\u5F55</p><ul><li>\u5173\u95ED\u9632\u706B\u5899</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">service</span> iptables stop
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>\u5728<code>/etc/rabbitmq</code>\u4E2D\u521B\u5EFA<code>rabbitmq.conf</code>\u914D\u7F6E\u6587\u4EF6\uFF0C\u5E76\u6DFB\u52A0\u5982\u4E0B\u5185\u5BB9</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>
<span class="token punctuation">{</span>rabbit, <span class="token punctuation">[</span><span class="token punctuation">{</span>tcp_listeners, <span class="token punctuation">[</span><span class="token number">5672</span><span class="token punctuation">]</span><span class="token punctuation">}</span>, <span class="token punctuation">{</span>loopback_users, <span class="token punctuation">[</span><span class="token string">&quot;admin&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span>.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>admin\u662F\u6DFB\u52A0\u7684\u7528\u6237\u540D</li><li>. \u662F\u5FC5\u987B\u7684</li></ul><p>\u5B98\u65B9\u8868\u793A\uFF0Crabbitmq\u4F1A\u5728\u542F\u52A8\u7684\u65F6\u5019\u4ECE\u8FD9\u4E9B\u4F4D\u7F6E\u8BFB\u53D6\u914D\u7F6E\u4FE1\u606F</p><p><img src="`+yn+`" alt="image-20211210210801146"></p><p><strong>\u8FD9\u4E2A\u5B98\u65B9\u9A97\u4EBA\uFF0Crabbitmq.conf\u540D\u5B57\u7684\u914D\u7F6E\u6587\u4EF6\u542F\u52A8\u5931\u8D25\uFF0C\u8981rabbitmq.config\u624D\u884C</strong></p><p>\u4F7F\u7528\u4EE5\u4E0B\u547D\u4EE4\u6DFB\u52A0admin\u7528\u6237\u5230rabbitmq\uFF0C\u5E76\u8D4B\u4E88\u5B83\u7BA1\u7406\u5458\u6743\u9650</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">## RabbitMQ\u65B0\u589E\u8D26\u53F7\u5BC6\u7801</span>
rabbitmqctl add_user admin <span class="token number">123456</span>
<span class="token comment">## \u8BBE\u7F6E\u6210\u7BA1\u7406\u5458\u89D2\u8272</span>
rabbitmqctl set_user_tags admin administrator
<span class="token comment">## \u8BBE\u7F6E\u6743\u9650</span>
rabbitmqctl set_permissions -p <span class="token string">&quot;/&quot;</span> admin <span class="token string">&quot;.*&quot;</span> <span class="token string">&quot;.*&quot;</span> <span class="token string">&quot;.*&quot;</span>
<span class="token comment">## \u67E5\u770B\u7528\u6237\u5217\u8868</span>
rabbitmqctl list_users
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6267\u884C\u7ED3\u679C</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@mq1 ~<span class="token punctuation">]</span><span class="token comment">## rabbitmqctl add_user admin 123456</span>
Adding user <span class="token string">&quot;admin&quot;</span> <span class="token punctuation">..</span>.
Done. Don<span class="token string">&#39;t forget to grant the user permissions to some virtual hosts! See &#39;</span>rabbitmqctl <span class="token builtin class-name">help</span> set_permissions&#39; to learn more.
<span class="token punctuation">[</span>root@mq1 ~<span class="token punctuation">]</span><span class="token comment">## rabbitmqctl set_user_tags admin administrator</span>
Setting tags <span class="token keyword">for</span> user <span class="token string">&quot;admin&quot;</span> to <span class="token punctuation">[</span>administrator<span class="token punctuation">]</span> <span class="token punctuation">..</span>.
<span class="token punctuation">[</span>root@mq1 ~<span class="token punctuation">]</span><span class="token comment">## rabbitmqctl set_permissions -p &quot;/&quot; admin &quot;.*&quot; &quot;.*&quot; &quot;.*&quot;</span>
Setting permissions <span class="token keyword">for</span> user <span class="token string">&quot;admin&quot;</span> <span class="token keyword">in</span> vhost <span class="token string">&quot;/&quot;</span> <span class="token punctuation">..</span>.
<span class="token punctuation">[</span>root@mq1 ~<span class="token punctuation">]</span><span class="token comment">## rabbitmqctl list_users</span>
Listing <span class="token function">users</span> <span class="token punctuation">..</span>.
user	tags
admin	<span class="token punctuation">[</span>administrator<span class="token punctuation">]</span>
guest	<span class="token punctuation">[</span>administrator<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>\u91CD\u542Frabbitmq</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>systemctl restart <span class="token number">11</span>.rabbitmq-server
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>\u914D\u7F6E\u4E4B\u540E\u5728\u542F\u52A8\u62A5\u9519\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@mq1 <span class="token number">11</span>.rabbitmq<span class="token punctuation">]</span><span class="token comment">## systemctl start 11.rabbitmq-server</span>
Job <span class="token keyword">for</span> <span class="token number">11</span>.rabbitmq-server.service failed because the control process exited with error code. See <span class="token string">&quot;systemctl status rabbitmq-server.service&quot;</span> and <span class="token string">&quot;journalctl -xe&quot;</span> <span class="token keyword">for</span> details.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6392\u9519\u6B65\u9AA4\uFF1A</p><ol><li>\u83B7\u53D6\u542F\u52A8\u7684\u65E5\u5FD7<code>cat /var/log/messages | grep erro</code></li></ol><p><img src="`+wn+`" alt="image-20211210214818383"></p><p>\u53EF\u4EE5\u770B\u5230\u5728\u89E3\u6790\u914D\u7F6E\u6587\u4EF6\u7684\u65F6\u5019\u51FA\u73B0\u4E86\u9519\u8BEF\uFF0C\u6539\u6210rabbitmq.config\u4E4B\u540E\u6210\u529F</p></blockquote><p>\u4F7F\u7528<code>rabbitmqctl status</code>\u67E5\u770Brabbitmq\u72B6\u6001</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@mq1 <span class="token number">11</span>.rabbitmq<span class="token punctuation">]</span><span class="token comment">## rabbitmqctl status</span>
Status of <span class="token function">node</span> rabbit@mq1 <span class="token punctuation">..</span>.
Runtime

OS PID: <span class="token number">11307</span>
OS: Linux
Uptime <span class="token punctuation">(</span>seconds<span class="token punctuation">)</span>: <span class="token number">148</span>
Is under maintenance?: <span class="token boolean">false</span>
RabbitMQ version: <span class="token number">3.9</span>.11
Node name: rabbit@mq1
Erlang configuration: Erlang/OTP <span class="token number">23</span> <span class="token punctuation">[</span>erts-11.2.2.7<span class="token punctuation">]</span> <span class="token punctuation">[</span>source<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token number">64</span>-bit<span class="token punctuation">]</span> <span class="token punctuation">[</span>smp:2:2<span class="token punctuation">]</span> <span class="token punctuation">[</span>ds:2:2:10<span class="token punctuation">]</span> <span class="token punctuation">[</span>async-threads:1<span class="token punctuation">]</span> <span class="token punctuation">[</span>hipe<span class="token punctuation">]</span>
Erlang processes: <span class="token number">355</span> used, <span class="token number">1048576</span> limit
Scheduler run queue: <span class="token number">1</span>
Cluster heartbeat <span class="token function">timeout</span> <span class="token punctuation">(</span>net_ticktime<span class="token punctuation">)</span>: <span class="token number">60</span>

Plugins

Enabled plugin file: /etc/11.rabbitmq/enabled_plugins
Enabled plugins:

 * rabbitmq_management
 * amqp_client
 * rabbitmq_web_dispatch
 * cowboy
 * cowlib
 * rabbitmq_management_agent

Data directory

Node data directory: /var/lib/11.rabbitmq/mnesia/rabbit@mq1
Raft data directory: /var/lib/11.rabbitmq/mnesia/rabbit@mq1/quorum/rabbit@mq1

Config files

 * /etc/11.rabbitmq/11.rabbitmq.config

Log file<span class="token punctuation">(</span>s<span class="token punctuation">)</span>

 * /var/log/11.rabbitmq/rabbit@mq1.log
 * /var/log/11.rabbitmq/rabbit@mq1_upgrade.log
 * <span class="token operator">&lt;</span>stdout<span class="token operator">&gt;</span>

Alarms

<span class="token punctuation">(</span>none<span class="token punctuation">)</span>

Memory

Total memory used: <span class="token number">0.0764</span> gb
Calculation strategy: rss
Memory high watermark setting: <span class="token number">0.4</span> of available memory, computed to: <span class="token number">0.7631</span> gb

code: <span class="token number">0.0268</span> gb <span class="token punctuation">(</span><span class="token number">35.04</span> %<span class="token punctuation">)</span>
other_proc: <span class="token number">0.0188</span> gb <span class="token punctuation">(</span><span class="token number">24.55</span> %<span class="token punctuation">)</span>
other_system: <span class="token number">0.0135</span> gb <span class="token punctuation">(</span><span class="token number">17.68</span> %<span class="token punctuation">)</span>
reserved_unallocated: <span class="token number">0.0074</span> gb <span class="token punctuation">(</span><span class="token number">9.67</span> %<span class="token punctuation">)</span>
allocated_unused: <span class="token number">0.0034</span> gb <span class="token punctuation">(</span><span class="token number">4.48</span> %<span class="token punctuation">)</span>
other_ets: <span class="token number">0.0034</span> gb <span class="token punctuation">(</span><span class="token number">4.42</span> %<span class="token punctuation">)</span>
atom: <span class="token number">0.0014</span> gb <span class="token punctuation">(</span><span class="token number">1.81</span> %<span class="token punctuation">)</span>
plugins: <span class="token number">0.0011</span> gb <span class="token punctuation">(</span><span class="token number">1.42</span> %<span class="token punctuation">)</span>
metrics: <span class="token number">0.0002</span> gb <span class="token punctuation">(</span><span class="token number">0.3</span> %<span class="token punctuation">)</span>
mgmt_db: <span class="token number">0.0002</span> gb <span class="token punctuation">(</span><span class="token number">0.29</span> %<span class="token punctuation">)</span>
mnesia: <span class="token number">0.0001</span> gb <span class="token punctuation">(</span><span class="token number">0.12</span> %<span class="token punctuation">)</span>
binary: <span class="token number">0.0001</span> gb <span class="token punctuation">(</span><span class="token number">0.11</span> %<span class="token punctuation">)</span>
quorum_ets: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.04</span> %<span class="token punctuation">)</span>
msg_index: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.04</span> %<span class="token punctuation">)</span>
connection_other: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
stream_queue_procs: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
stream_queue_replica_reader_procs: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
connection_channels: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
connection_readers: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
connection_writers: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
queue_procs: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
queue_slave_procs: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
quorum_queue_procs: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>
stream_queue_coordinator_procs: <span class="token number">0.0</span> gb <span class="token punctuation">(</span><span class="token number">0.0</span> %<span class="token punctuation">)</span>

File Descriptors

Total: <span class="token number">2</span>, limit: <span class="token number">32671</span>
Sockets: <span class="token number">0</span>, limit: <span class="token number">29401</span>

Free Disk Space

Low <span class="token function">free</span> disk space watermark: <span class="token number">0.05</span> gb
Free disk space: <span class="token number">38.3294</span> gb

Totals

Connection count: <span class="token number">0</span>
Queue count: <span class="token number">0</span>
Virtual <span class="token function">host</span> count: <span class="token number">1</span>

Listeners

Interface: <span class="token punctuation">[</span>::<span class="token punctuation">]</span>, port: <span class="token number">15672</span>, protocol: http, purpose: HTTP API
Interface: <span class="token punctuation">[</span>::<span class="token punctuation">]</span>, port: <span class="token number">25672</span>, protocol: clustering, purpose: inter-node and CLI tool communication
Interface: <span class="token punctuation">[</span>::<span class="token punctuation">]</span>, port: <span class="token number">5672</span>, protocol: amqp, purpose: AMQP <span class="token number">0</span>-9-1 and AMQP <span class="token number">1.0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li>\u7F51\u9875\u8BBF\u95EE\u6B63\u5E38</li></ol><p><img src="`+_n+'" alt="image-20211210215629445"></p><h6 id="\u96C6\u7FA4\u914D\u7F6E"><a class="header-anchor" href="#\u96C6\u7FA4\u914D\u7F6E" aria-hidden="true">#</a> \u96C6\u7FA4\u914D\u7F6E</h6><ol><li>\u4FDD\u6301erlang.cookie\u4E00\u81F4</li></ol>',58),zn=n("p",null,"\u5B98\u65B9\u6587\u6863\u4E2D\uFF1Ahttps://www.rabbitmq.com/clustering.html",-1),Wn=n("p",null,[n("strong",null,"How CLI Tools Authenticate to Nodes (and Nodes to Each Other): the Erlang Cookie")],-1),Jn=n("p",null,"RabbitMQ nodes and CLI tools (e.g. rabbitmqctl) use a cookie to determine whether they are allowed to communicate with each other. For two nodes to be able to communicate they must have the same shared secret called the Erlang cookie. The cookie is just a string of alphanumeric characters up to 255 characters in size. It is usually stored in a local file. The file must be only accessible to the owner (e.g. have UNIX permissions of 600 or similar). Every cluster node must have the same cookie.",-1),Gn=s("If the file does not exist, Erlang VM will try to create one with a randomly generated value when the RabbitMQ server starts up. Using such generated cookie files are appropriate in development environments only. Since each node will generate its own value independently, this strategy is not really viable in a "),Yn={href:"https://www.rabbitmq.com/clustering.html",target:"_blank",rel:"noopener noreferrer"},Xn=s("clustered environment"),Zn=s("."),$n=a("<p>Erlang cookie generation should be done at cluster deployment stage, ideally using automation and orchestration tools.</p><p>In distributed deployment</p><p><strong>Cookie File Locations</strong></p><p>*<em>Linux, MacOS, <em>BSD</em></em></p><p>On UNIX systems, the cookie will be typically located in /var/lib/rabbitmq/.erlang.cookie (used by the server) and $HOME/.erlang.cookie (used by CLI tools). Note that since the value of $HOME varies from user to user, it&#39;s necessary to place a copy of the cookie file for each user that will be using the CLI tools. This applies to both non-privileged users and root.</p><p>RabbitMQ nodes will log its effective user&#39;s home directory location early on boot.</p><p>\u8868\u793A\uFF1A</p><ul><li>rabbitmq\u548Crabbitmqctl\u5DE5\u5177\u4F7F\u7528cookie\u6765\u786E\u5B9A\u4ED6\u4EEC\u662F\u5426\u88AB\u5141\u8BB8\u901A\u4FE1\uFF0C\u4E3A\u4E86\u8BA9\u4E24\u4E2A\u8282\u70B9\u80FD\u591F\u901A\u4FE1\uFF0C\u5B83\u4EEC\u5FC5\u987B\u5177\u6709\u76F8\u540C\u7684\u5171\u4EAB\u79D8\u5BC6\uFF0C\u79F0\u4E3Aerlang cookie</li><li>\u5982\u679C\u8BE5\u6587\u4EF6\u4E0D\u5B58\u5728\uFF0CErlang VM \u4F1A\u5728 RabbitMQ \u670D\u52A1\u5668\u542F\u52A8\u65F6\u5C1D\u8BD5\u521B\u5EFA\u4E00\u4E2A\u968F\u673A\u751F\u6210\u7684\u503C</li><li>\u4F7F\u7528\u6B64\u7C7B\u751F\u6210\u7684 cookie \u6587\u4EF6\u4EC5\u9002\u7528\u4E8E\u5F00\u53D1\u73AF\u5883\u3002\u7531\u4E8E\u6BCF\u4E2A\u8282\u70B9\u90FD\u4F1A\u72EC\u7ACB\u4EA7\u751F\u81EA\u5DF1\u7684\u4EF7\u503C\uFF0C\u8FD9\u79CD\u7B56\u7565\u5728\u96C6\u7FA4\u73AF\u5883\u4E2D\u5E76\u4E0D\u771F\u6B63\u53EF\u884C</li><li>\u5728 UNIX \u7CFB\u7EDF\u4E0A\uFF0Ccookie \u901A\u5E38\u4F4D\u4E8E/var/lib/rabbitmq/.erlang.cookie\uFF08\u7531\u670D\u52A1\u5668\u4F7F\u7528\uFF09\u548C$HOME/.erlang.cookie\uFF08\u7531 CLI \u5DE5\u5177\u4F7F\u7528\uFF09</li></ul>",8),ns=a(`<div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@mq1 <span class="token number">11</span>.rabbitmq<span class="token punctuation">]</span><span class="token comment">## ll -a</span>
\u603B\u7528\u91CF <span class="token number">752</span>
drwxr-xr-x.  <span class="token number">3</span> <span class="token number">11</span>.rabbitmq <span class="token number">11</span>.rabbitmq     <span class="token number">64</span> <span class="token number">12</span>\u6708 <span class="token number">10</span> <span class="token number">21</span>:26 <span class="token builtin class-name">.</span>
drwxr-xr-x. <span class="token number">28</span> root     root       <span class="token number">4096</span> <span class="token number">12</span>\u6708 <span class="token number">10</span> <span class="token number">20</span>:43 <span class="token punctuation">..</span>
-r--------.  <span class="token number">1</span> <span class="token number">11</span>.rabbitmq <span class="token number">11</span>.rabbitmq     <span class="token number">20</span> <span class="token number">12</span>\u6708 <span class="token number">10</span> 00:00 .erlang.cookie
-rw-r-----.  <span class="token number">1</span> <span class="token number">11</span>.rabbitmq <span class="token number">11</span>.rabbitmq <span class="token number">759333</span> <span class="token number">12</span>\u6708 <span class="token number">10</span> <span class="token number">21</span>:52 erl_crash.dump
drwxr-x---.  <span class="token number">4</span> <span class="token number">11</span>.rabbitmq <span class="token number">11</span>.rabbitmq    <span class="token number">111</span> <span class="token number">12</span>\u6708 <span class="token number">10</span> <span class="token number">21</span>:53 mnesia
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E3A\u4E86\u80FD\u8BA9\u6211\u4EEC\u7684erlang cookie\u4FDD\u6301\u4E00\u81F4\uFF0C\u6211\u4EEC\u5C06mq1\u7684.erlang.cookie\u62F7\u8D1D\u5230mq2\u3001mq3</p><p>\u5148\u505C\u6B62\u4E09\u53F0\u673A\u5668\u7684rabbitmq-server</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@mq1 <span class="token number">11</span>.rabbitmq<span class="token punctuation">]</span><span class="token comment">## systemctl stop 11.rabbitmq-server ## \u505C\u6B62rabbitmq-server</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u4F20\u8F93\u5230mq2\u3001mq3</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@mq1 <span class="token number">11</span>.rabbitmq<span class="token punctuation">]</span><span class="token comment">## pwd</span>
/var/lib/11.rabbitmq
<span class="token punctuation">[</span>root@mq1 <span class="token number">11</span>.rabbitmq<span class="token punctuation">]</span><span class="token comment">## scp .erlang.cookie root@mq2:/var/lib/11.rabbitmq/</span>
The authenticity of <span class="token function">host</span> <span class="token string">&#39;mq2 (172.16.187.11)&#39;</span> can<span class="token string">&#39;t be established.
ECDSA key fingerprint is SHA256:Yo8XjrNSC9Zjw1Jqd8SItOOKQ4vAPPAvFxfVzMPRsjc.
ECDSA key fingerprint is MD5:77:f7:5e:b5:5a:01:47:5b:b6:ab:e4:6e:e0:55:04:59.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added &#39;</span>mq2,172.16.187.11<span class="token string">&#39; (ECDSA) to the list of known hosts.
root@mq2&#39;</span>s password:
Permission denied, please try again.
root@mq2<span class="token string">&#39;s password:
.erlang.cookie                                100%   20    17.5KB/s   00:00
[root@mq1 11.rabbitmq]## scp .erlang.cookie root@mq3:/var/lib/11.rabbitmq/
The authenticity of host &#39;</span>mq3 <span class="token punctuation">(</span><span class="token number">172.16</span>.187.12<span class="token punctuation">)</span><span class="token string">&#39; can&#39;</span>t be established.
ECDSA key fingerprint is SHA256:Yo8XjrNSC9Zjw1Jqd8SItOOKQ4vAPPAvFxfVzMPRsjc.
ECDSA key fingerprint is MD5:77:f7:5e:b5:5a:01:47:5b:b6:ab:e4:6e:e0:55:04:59.
Are you sure you want to <span class="token builtin class-name">continue</span> connecting <span class="token punctuation">(</span>yes/no<span class="token punctuation">)</span>? <span class="token function">yes</span>
Warning: Permanently added <span class="token string">&#39;mq3,172.16.187.12&#39;</span> <span class="token punctuation">(</span>ECDSA<span class="token punctuation">)</span> to the list of known hosts.
root@mq3&#39;s password:
.erlang.cookie                                <span class="token number">100</span>%   <span class="token number">20</span>     <span class="token number">8</span>.9KB/s   00:00
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>\u67E5\u770Bcookie\u662F\u5426\u4E00\u81F4</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@mq1 <span class="token number">11</span>.rabbitmq<span class="token punctuation">]</span><span class="token comment">## cd /var/lib/11.rabbitmq</span>
<span class="token punctuation">[</span>root@mq1 <span class="token number">11</span>.rabbitmq<span class="token punctuation">]</span><span class="token comment">## cat .erlang.cookie</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>\u540E\u53F0\u542F\u52A8rabbitmq\uFF0C\u6240\u6709\u8282\u70B9\u6267\u884C\u5982\u4E0B\u547D\u4EE4\uFF0C\u542F\u52A8\u6210\u529F\u8BBF\u95EE\u7BA1\u7406\u754C\u9762</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">11</span>.rabbitmq-server -detached
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5982\u679C\u542F\u52A8\u4E4B\u540E\u8BBF\u95EEweb\u754C\u9762\u4E0D\u6210\u529F\uFF0C\u76F4\u63A5\u4F7F\u7528\u524D\u53F0\u542F\u52A8\uFF0C\u53EF\u4EE5\u770B\u5230\u7AEF\u53E3\u7ED1\u5B9A\u5931\u8D25</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@mq1 <span class="token number">11</span>.rabbitmq<span class="token punctuation">]</span><span class="token comment">## 11.rabbitmq-server</span>

BOOT FAILED
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
ERROR: could not <span class="token builtin class-name">bind</span> to distribution port <span class="token number">25672</span>, it is <span class="token keyword">in</span> use by another node: rabbit@mq1

<span class="token number">2021</span>-12-10 <span class="token number">22</span>:52:40.301255+08:00 <span class="token punctuation">[</span>erro<span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token number">0.131</span>.<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
<span class="token number">2021</span>-12-10 <span class="token number">22</span>:52:40.301255+08:00 <span class="token punctuation">[</span>erro<span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token number">0.131</span>.<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> BOOT FAILED
<span class="token number">2021</span>-12-10 <span class="token number">22</span>:52:40.301255+08:00 <span class="token punctuation">[</span>erro<span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token number">0.131</span>.<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span>
<span class="token number">2021</span>-12-10 <span class="token number">22</span>:52:40.301255+08:00 <span class="token punctuation">[</span>erro<span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token number">0.131</span>.<span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span> ERROR: could not <span class="token builtin class-name">bind</span> to distribution port <span class="token number">25672</span>, it is <span class="token keyword">in</span> use by another node: rabbit@mq1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5148\u6740\u6389\u6240\u6709\u7684rabbitmq\u8FDB\u7A0B\uFF0C\u5728\u91CD\u65B0\u540E\u53F0\u542F\u52A8</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@mq1 <span class="token number">11</span>.rabbitmq<span class="token punctuation">]</span><span class="token comment">## ps -ef | grep 11.rabbitmq</span>
<span class="token number">11</span>.rabbitmq  <span class="token number">14635</span>      <span class="token number">1</span>  <span class="token number">1</span> <span class="token number">22</span>:46 ?        00:00:07 /usr/lib64/erlang/erts-11.2.2.7/bin/beam.smp -W w -MBas ageffcbf -MHas ageffcbf -MBlmbcs <span class="token number">512</span> -MHlmbcs <span class="token number">512</span> -MMmcs <span class="token number">30</span> -P <span class="token number">1048576</span> -t <span class="token number">5000000</span> -stbt db -zdbbl <span class="token number">128000</span> -sbwt none -sbwtdcpu none -sbwtdio none -B i -- -root /usr/lib64/erlang -progname erl -- -home /var/lib/11.rabbitmq -- -pa  -noshell -noinput -s rabbit boot -boot start_sasl -syslog logger <span class="token punctuation">[</span><span class="token punctuation">]</span> -syslog syslog_error_logger <span class="token boolean">false</span> -noshell -noinput
<span class="token number">11</span>.rabbitmq  <span class="token number">14639</span>  <span class="token number">14635</span>  <span class="token number">0</span> <span class="token number">22</span>:46 ?        00:00:00 erl_child_setup <span class="token number">1024</span>
<span class="token number">11</span>.rabbitmq  <span class="token number">14665</span>      <span class="token number">1</span>  <span class="token number">0</span> <span class="token number">22</span>:46 ?        00:00:00 /usr/lib64/erlang/erts-11.2.2.7/bin/epmd -daemon
<span class="token number">11</span>.rabbitmq  <span class="token number">14688</span>  <span class="token number">14639</span>  <span class="token number">0</span> <span class="token number">22</span>:46 ?        00:00:00 inet_gethost <span class="token number">4</span>
<span class="token number">11</span>.rabbitmq  <span class="token number">14689</span>  <span class="token number">14688</span>  <span class="token number">0</span> <span class="token number">22</span>:46 ?        00:00:00 inet_gethost <span class="token number">4</span>
root      <span class="token number">15537</span>   <span class="token number">2847</span>  <span class="token number">0</span> <span class="token number">22</span>:53 pts/0    00:00:00 <span class="token function">grep</span> --color<span class="token operator">=</span>auto <span class="token number">11</span>.rabbitmq
<span class="token punctuation">[</span>root@mq1 <span class="token number">11</span>.rabbitmq<span class="token punctuation">]</span><span class="token comment">## kill -9 14635</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8BBF\u95EE\u7F51\u9875\u6210\u529F\u8868\u793A\u542F\u52A8\u6210\u529F</p><blockquote><p>\u6559\u7A0B\u8BF4\u8FD9\u79CD\u65B9\u5F0F\u542F\u52A8\u662F\u4E0D\u4F1A\u52A0\u8F7D\u63D2\u4EF6\u7684\uFF08web\u63D2\u4EF6\uFF09\uFF0C\u6240\u4EE5\u8BBF\u95EEweb\u662F\u8BBF\u95EE\u4E0D\u5230\u7684\uFF0C\u53EF\u4EE5\u901A\u8FC7<code>rabbitmqctl cluster_status</code>\u6765\u67E5\u770B\u72B6\u6001</p></blockquote><ol start="4"><li>\u5728mq2\u548Cmq3\u4E2D\u6267\u884C\u52A0\u5165\u96C6\u7FA4\u547D\u4EE4</li></ol><ul><li>\u5173\u95ED</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@mq2 <span class="token number">11</span>.rabbitmq<span class="token punctuation">]</span><span class="token comment">## rabbitmqctl stop_app</span>
Stopping rabbit application on <span class="token function">node</span> rabbit@mq2 <span class="token punctuation">..</span>.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u52A0\u5165\u96C6\u7FA4</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@mq2 <span class="token number">11</span>.rabbitmq<span class="token punctuation">]</span><span class="token comment">## rabbitmqctl join_cluster rabbit@mq1</span>
Clustering <span class="token function">node</span> rabbit@mq2 with rabbit@mq1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u542F\u52A8\u670D\u52A1</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@mq2 <span class="token number">11</span>.rabbitmq<span class="token punctuation">]</span><span class="token comment">## rabbitmqctl start_app</span>
Starting <span class="token function">node</span> rabbit@mq2 <span class="token punctuation">..</span>.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="5"><li>\u67E5\u8BE2\u96C6\u7FA4\u72B6\u6001\uFF0C\u4EFB\u610F\u8282\u70B9\u6267\u884C</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@mq3 <span class="token number">11</span>.rabbitmq<span class="token punctuation">]</span><span class="token comment">## rabbitmqctl cluster_status</span>
Cluster status of <span class="token function">node</span> rabbit@mq3 <span class="token punctuation">..</span>.
Basics

Cluster name: rabbit@mq3

Disk Nodes

rabbit@mq1
rabbit@mq2
rabbit@mq3

Running Nodes

rabbit@mq1
rabbit@mq2
rabbit@mq3

Versions

rabbit@mq1: RabbitMQ <span class="token number">3.9</span>.11 on Erlang <span class="token number">23.3</span>.4.8
rabbit@mq2: RabbitMQ <span class="token number">3.9</span>.11 on Erlang <span class="token number">23.3</span>.4.8
rabbit@mq3: RabbitMQ <span class="token number">3.9</span>.11 on Erlang <span class="token number">23.3</span>.4.8

Maintenance status

Node: rabbit@mq1, status: not under maintenance
Node: rabbit@mq2, status: not under maintenance
Node: rabbit@mq3, status: not under maintenance

Alarms

<span class="token punctuation">(</span>none<span class="token punctuation">)</span>

Network Partitions

<span class="token punctuation">(</span>none<span class="token punctuation">)</span>

Listeners

Node: rabbit@mq1, interface: <span class="token punctuation">[</span>::<span class="token punctuation">]</span>, port: <span class="token number">15672</span>, protocol: http, purpose: HTTP API
Node: rabbit@mq1, interface: <span class="token punctuation">[</span>::<span class="token punctuation">]</span>, port: <span class="token number">25672</span>, protocol: clustering, purpose: inter-node and CLI tool communication
Node: rabbit@mq1, interface: <span class="token punctuation">[</span>::<span class="token punctuation">]</span>, port: <span class="token number">5672</span>, protocol: amqp, purpose: AMQP <span class="token number">0</span>-9-1 and AMQP <span class="token number">1.0</span>
Node: rabbit@mq2, interface: <span class="token punctuation">[</span>::<span class="token punctuation">]</span>, port: <span class="token number">15672</span>, protocol: http, purpose: HTTP API
Node: rabbit@mq2, interface: <span class="token punctuation">[</span>::<span class="token punctuation">]</span>, port: <span class="token number">25672</span>, protocol: clustering, purpose: inter-node and CLI tool communication
Node: rabbit@mq2, interface: <span class="token punctuation">[</span>::<span class="token punctuation">]</span>, port: <span class="token number">5672</span>, protocol: amqp, purpose: AMQP <span class="token number">0</span>-9-1 and AMQP <span class="token number">1.0</span>
Node: rabbit@mq3, interface: <span class="token punctuation">[</span>::<span class="token punctuation">]</span>, port: <span class="token number">15672</span>, protocol: http, purpose: HTTP API
Node: rabbit@mq3, interface: <span class="token punctuation">[</span>::<span class="token punctuation">]</span>, port: <span class="token number">25672</span>, protocol: clustering, purpose: inter-node and CLI tool communication
Node: rabbit@mq3, interface: <span class="token punctuation">[</span>::<span class="token punctuation">]</span>, port: <span class="token number">5672</span>, protocol: amqp, purpose: AMQP <span class="token number">0</span>-9-1 and AMQP <span class="token number">1.0</span>

Feature flags

Flag: drop_unroutable_metric, state: disabled
Flag: empty_basic_get_metric, state: disabled
Flag: implicit_default_bindings, state: enabled
Flag: maintenance_mode_status, state: enabled
Flag: quorum_queue, state: enabled
Flag: stream_queue, state: enabled
Flag: user_limits, state: enabled
Flag: virtual_host_metadata, state: enabled
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="6"><li>\u5982\u679C\u51FA\u73B0\u5982\u4E0B\u663E\u793A\uFF0C\u96C6\u7FA4\u642D\u5EFA\u6210\u529F</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>Running Nodes

rabbit@mq1
rabbit@mq2
rabbit@mq3
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="7"><li>\u901A\u8FC7\u4EFB\u610F\u8282\u70B9ip\u8BBF\u95EEweb\u7BA1\u7406\u754C\u9762\uFF0C\u53EF\u4EE5\u770B\u5230\u8282\u70B9</li></ol><p><img src="`+xn+'" alt="image-20211210230936309"></p><h4 id="\u955C\u50CF\u96C6\u7FA4-\u955C\u50CF\u961F\u5217"><a class="header-anchor" href="#\u955C\u50CF\u96C6\u7FA4-\u955C\u50CF\u961F\u5217" aria-hidden="true">#</a> \u955C\u50CF\u96C6\u7FA4(\u955C\u50CF\u961F\u5217)</h4><p>RabbitMQ\u4E2D\u6700\u7ECF\u5178\u7684\u96C6\u7FA4\u67B6\u6784\uFF0C\u57FA\u4E8E\u666E\u901A\u96C6\u7FA4\u6784\u5EFA</p><p><strong>\u955C\u50CF\u961F\u5217\u673A\u5236\u5C31\u662F\u5C06\u961F\u5217\u5728\u591A\u4E2A\u8282\u70B9\u4E4B\u95F4\u8BBE\u7F6E\u4E3B\u4ECE\u5173\u7CFB\uFF0C\u6D88\u606F\u4F1A\u5728\u8282\u70B9\u4E4B\u95F4\u8FDB\u884C\u81EA\u52A8\u540C\u6B65\uFF0C\u4E14\u5982\u679C\u5176\u4E2D\u4E00\u4E2A\u8282\u70B9\u4E0D\u53EF\u7528\uFF0C\u5E76\u4E0D\u4F1A\u5BFC\u81F4\u6D88\u606F\u4E22\u5931\u6216\u670D\u52A1\u4E0D\u53EF\u7528\u7684\u60C5\u51B5\uFF0C\u63D0\u5347MQ\u96C6\u7FA4\u7684\u6574\u4F53\u9AD8\u53EF\u7528\u6027</strong></p><p>\u8BE5\u96C6\u7FA4\u5F15\u5165\u955C\u50CF\u7684\u6982\u5FF5\uFF0C\u4ECE\u8282\u70B9\u53EF\u4EE5\u901A\u8FC7\u955C\u50CF\u53BB\u5B9E\u65F6\u540C\u6B65\u4E3B\u8282\u70B9\u4E2DQueue\u7684\u6570\u636E\uFF0C\u53EF\u4EE5\u771F\u6B63\u505A\u5230\u6D88\u606F\u767E\u5206\u767E\u4E0D\u4E22\u5931\u3002\u7531\u4E8E\u4ECE\u8282\u70B9\u6301\u6709\u5B8C\u6574\u4E3B\u8282\u70B9\u6570\u636E\uFF0C\u90A3\u4E48\u5F53\u4E3B\u8282\u70B9\u5FFD\u7136\u5B95\u673A\uFF0C\u4ECE\u8282\u70B9\u8FD8\u53EF\u4EE5\u4EE3\u66FF\u4E3B\u8282\u70B9\u6210\u4E3A\u65B0\u4E3B\u8282\u70B9\uFF0C\u4ECE\u800C\u5B9E\u73B0\u5931\u8D25\u7684\u6545\u969C\u8F6C\u79FB</p><h5 id="\u67B6\u6784\u56FE-1"><a class="header-anchor" href="#\u67B6\u6784\u56FE-1" aria-hidden="true">#</a> \u67B6\u6784\u56FE</h5><p><img src="'+Cn+'" alt="image-20211210182022214"></p><p>rabbitmq\u7684\u4F7F\u7528\uFF0C\u4E3A\u4E86\u9AD8\u53EF\u7528\uFF0C\u9700\u8981\u914D\u5408lvs\u548Chaproxy\u6765\u4F7F\u7528</p><ul><li>\u6D88\u8D39\u8005/\u751F\u4EA7\u8005\u4E0Elvs\u8FDE\u63A5\uFF0Clvs\u8FDE\u63A5\u5230\u4EE3\u7406\u4E2D\u95F4\u4EF6\uFF0C\u7531haproxy\u6765\u51B3\u5B9A\u8981\u8BBF\u95EE\u54EA\u4E2A\u8282\u70B9</li><li>rabbitmq\u8282\u70B9\u4F1A\u81EA\u52A8\u955C\u50CF\u540C\u6B65</li></ul><p>\u955C\u50CF\u67B6\u6784\u4E0D\u9700\u8981\u6211\u4EEC\u642D\u5EFA\uFF0C\u53EA\u9700\u8981\u5728\u666E\u901A\u96C6\u7FA4\u4E2D\u7684\u505A\u989D\u5916\u7684\u914D\u7F6E\u5C31\u53EF\u4EE5\u4E86</p><h5 id="\u96C6\u7FA4\u642D\u5EFA-1"><a class="header-anchor" href="#\u96C6\u7FA4\u642D\u5EFA-1" aria-hidden="true">#</a> \u96C6\u7FA4\u642D\u5EFA</h5><blockquote><p>RabbitMQ\u662F\u57FA\u4E8EErlang\u7F16\u5199\uFF0CErlang\u8BED\u8A00\u5929\u751F\u5177\u5907\u5206\u5E03\u5F0F\u7279\u6027\uFF08\u901A\u8FC7\u540C\u6B65Erlang\u96C6\u7FA4\u5404\u8282\u70B9\u7684magic cookie\u6765\u5B9E\u73B0\uFF09\u3002\u56E0\u6B64\uFF0CRabbitMQ\u5929\u7136\u652F\u6301Clustering\u3002\u8FD9\u4F7F\u5F97RabbitMQ\u672C\u8EAB\u4E0D\u9700\u8981\u50CFActiveMQ\u3001Kafka\u90A3\u6837\u901A\u8FC7ZooKeeper\u5206\u522B\u6765\u5B9E\u73B0HA\u9AD8\u53EF\u7528\u65B9\u6848\u548C\u4FDD\u5B58\u96C6\u7FA4\u7684\u5143\u6570\u636E\u3002\u96C6\u7FA4\u662F\u4FDD\u8BC1\u53EF\u9760\u6027\u7684\u4E00\u79CD\u65B9\u5F0F\uFF0C\u540C\u65F6\u53EF\u4EE5\u901A\u8FC7\u6C34\u5E73\u6269\u5C55\u4EE5\u8FBE\u5230\u589E\u52A0\u6D88\u606F\u541E\u5410\u91CF\u80FD\u529B\u7684\u76EE\u7684\u3002</p><p>\u8BE5\u6A21\u5F0F\u89E3\u51B3\u4E86\u666E\u901A\u6A21\u5F0F\u4E2D\u7684\u95EE\u9898\uFF0C\u5176\u5B9E\u8D28\u548C\u666E\u901A\u6A21\u5F0F\u4E0D\u540C\u4E4B\u5904\u5728\u4E8E\uFF0C\u6D88\u606F\u5B9E\u4F53\u4F1A\u4E3B\u52A8\u5728\u955C\u50CF\u8282\u70B9\u95F4\u540C\u6B65\uFF0C\u800C\u4E0D\u662F\u5728\u5BA2\u6237\u7AEF\u53D6\u6570\u636E\u65F6\u4E34\u65F6\u62C9\u53D6\u3002</p><p>\u8BE5\u6A21\u5F0F\u5E26\u6765\u7684\u526F\u4F5C\u7528\u4E5F\u5F88\u660E\u663E\uFF0C\u9664\u4E86\u964D\u4F4E\u7CFB\u7EDF\u6027\u80FD\u5916\uFF0C\u5982\u679C\u955C\u50CF\u961F\u5217\u6570\u91CF\u8FC7\u591A\uFF0C\u52A0\u4E4B\u5927\u91CF\u7684\u6D88\u606F\u8FDB\u5165\uFF0C\u96C6\u7FA4\u5185\u90E8\u7684\u7F51\u7EDC\u5E26\u5BBD\u5C06\u4F1A\u88AB\u8FD9\u79CD\u540C\u6B65\u901A\u8BAF\u5927\u5927\u6D88\u8017\u6389\u3002\u6240\u4EE5\u5728\u5BF9\u53EF\u9760\u6027\u8981\u6C42\u8F83\u9AD8\u7684\u573A\u5408\u4E2D\u9002\u7528\u3002</p><p>\u955C\u50CF\u961F\u5217\u57FA\u672C\u4E0A\u5C31\u662F\u4E00\u4E2A\u7279\u6B8A\u7684BackingQueue\uFF0C\u5B83\u5185\u90E8\u5305\u88F9\u4E86\u4E00\u4E2A\u666E\u901A\u7684BackingQueue\u505A\u672C\u5730\u6D88\u606F\u6301\u4E45\u5316\u5904\u7406\uFF0C\u5728\u6B64\u57FA\u7840\u4E0A\u589E\u52A0\u4E86\u5C06\u6D88\u606F\u548Cack\u590D\u5236\u5230\u6240\u6709\u955C\u50CF\u7684\u529F\u80FD\u3002</p><p>\u6240\u6709\u5BF9mirror_queue_master\u7684\u64CD\u4F5C\uFF0C\u4F1A\u901A\u8FC7\u7EC4\u64ADGM\uFF08\u4E0B\u9762\u4F1A\u8BB2\u5230\uFF09\u7684\u65B9\u5F0F\u540C\u6B65\u5230\u5404slave\u8282\u70B9\u3002GM\u8D1F\u8D23\u6D88\u606F\u7684\u5E7F\u64AD\uFF0Cmirror_queue_slave\u8D1F\u8D23\u56DE\u8C03\u5904\u7406\uFF0C\u800Cmaster\u4E0A\u7684\u56DE\u8C03\u5904\u7406\u662F\u7531coordinator\u8D1F\u8D23\u5B8C\u6210\u3002mirror_queue_slave\u4E2D\u5305\u542B\u4E86\u666E\u901A\u7684BackingQueue\u8FDB\u884C\u6D88\u606F\u7684\u5B58\u50A8\uFF0Cmaster\u8282\u70B9\u4E2DBackingQueue\u5305\u542B\u5728mirror_queue_master\u4E2D\u7531AMQQueue\u8FDB\u884C\u8C03\u7528</p><p><img src="'+Mn+`" alt="img"></p></blockquote><h4 id="\u914D\u7F6E\u7B56\u7565"><a class="header-anchor" href="#\u914D\u7F6E\u7B56\u7565" aria-hidden="true">#</a> \u914D\u7F6E\u7B56\u7565</h4><ol><li>\u7B56\u7565\u8BF4\u660E</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>rabbitctl set_policy <span class="token punctuation">[</span>-p <span class="token operator">&lt;</span>vhost<span class="token operator">&gt;</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--priority <span class="token operator">&lt;</span>priority<span class="token operator">&gt;</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--apply-to <span class="token operator">&lt;</span>apply-to<span class="token operator">&gt;</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>pattern<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>definition<span class="token operator">&gt;</span>
-p vhost: \u53EF\u9009\u53C2\u6570\uFF0C\u9488\u5BF9\u6307\u5B9Avhost\u4E0B\u7684queue\u8FDB\u884C\u8BBE\u7F6E
name: policy\u7684\u540D\u79F0
pattern: queue\u7684\u5339\u914D\u6A21\u5F0F<span class="token punctuation">(</span>\u6B63\u5219\u8868\u8FBE\u5F0F<span class="token punctuation">)</span>
definition: \u955C\u50CF\u5B9A\u4E49\uFF0C\u5305\u62EC\u4E09\u4E2A\u90E8\u5206ha-mode, ha-parms, ha-sync-mode
	ha-mode: \u6307\u660E\u955C\u50CF\u961F\u5217\u7684\u6A21\u5F0F\uFF0C\u6709\u6548\u503C\u4E3A all/exactly/nodes
		all: \u8868\u793A\u5728\u96C6\u7FA4\u4E2D\u6240\u6709\u7684\u8282\u70B9\u4E0A\u8FDB\u884C\u955C\u50CF,\u6240\u6709\u7684\u8282\u70B9\u90FD\u53EF\u4EE5\u662F\u955C\u50CF
		exactly: \u8868\u793A\u5728\u6307\u5B9A\u4E2A\u6570\u7684\u8282\u70B9\u4E0A\u8FDB\u884C\u955C\u50CF\uFF0C\u8282\u70B9\u7684\u4E2A\u6570\u7531ha-params\u6307\u5B9A
		nodes: \u8868\u793A\u5728\u6307\u5B9A\u7684\u8282\u70B9\u4E0A\u8FDB\u884C\u955C\u50CF\uFF0C\u8282\u70B9\u7684\u4E2A\u6570\u7531ha-params\u6307\u5B9A
	ha-parms: ha-mode\u6A21\u5F0F\u9700\u8981\u7528\u5230\u7684\u53C2\u6570
	ha-sync-mode: \u8FDB\u884C\u961F\u5217\u4E2D\u6D88\u606F\u7684\u540C\u6B65\u65B9\u5F0F\uFF0C\u6709\u6548\u503C\u4E3Aautomatic<span class="token punctuation">(</span>\u81EA\u52A8\u540C\u6B65<span class="token punctuation">)</span>\u548Cmanual<span class="token punctuation">(</span>\u624B\u52A8\u540C\u6B65<span class="token punctuation">)</span>
	priority: \u53EF\u9009\u53C2\u6570\uFF0Cpolicy\u7684\u4F18\u5148\u7EA7
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>\u67E5\u770B\u5F53\u524D\u7B56\u7565</li></ol><p>\u53EF\u4EE5\u5728\u5F53\u524D\u96C6\u7FA4\u4E2D\u7684\u4EFB\u610F\u4E00\u4E2A\u8282\u70B9</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>rabbitmqctl list_policies
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="3"><li>\u6DFB\u52A0\u7B56\u7565</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>rabbitmqctl set_policy ha-all <span class="token string">&quot;^hello&quot;</span> <span class="token string">&#39;{&quot;ha-mode&quot;:&quot;all&quot;,&quot;ha-sync-mode&quot;:&quot;automatic&quot;}&#39;</span>
<span class="token comment">## \u8BF4\u660E\uFF1A\u7B56\u7565\u6B63\u5219\u8868\u8FBE\u5F0F\u4E3A&quot;^&quot;\u8868\u793A\u6240\u6709\u5339\u914D\u5339\u914D\u6240\u6709\u961F\u5217\u540D\u79F0 ^hello:\u5339\u914Dhello\u5F00\u5934\u961F\u5217</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u521B\u5EFA\u4E00\u4E2A\u540D\u5B57\u4E3Aha-all\u7684\u7B56\u7565</li><li>^hello : \u5339\u914Dhello\u5F00\u5934\u961F\u5217</li><li>\u7B56\u7565\u6A21\u5F0F\u662Fall</li><li>\u961F\u5217\u6570\u636E\u540C\u6B65\u6A21\u5F0F\uFF1Aautomatic \u81EA\u52A8</li></ul><p>\u6267\u884C\u7ED3\u679C\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>Setting policy <span class="token string">&quot;ha-all&quot;</span> <span class="token keyword">for</span> pattern <span class="token string">&quot;^hello&quot;</span> to <span class="token string">&quot;{&quot;</span>ha-mode<span class="token string">&quot;:&quot;</span>all<span class="token string">&quot;,&quot;</span>ha-sync-mode<span class="token string">&quot;:&quot;</span>automatic<span class="token string">&quot;}&quot;</span> with priority <span class="token string">&quot;0&quot;</span> <span class="token keyword">for</span> vhost <span class="token string">&quot;/&quot;</span> <span class="token punctuation">..</span>.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u67E5\u770Bweb\u7BA1\u7406\u754C\u9762</p><p><img src="`+Sn+`" alt="image-20211211003113071"></p><p>\u8FD9\u4E2A\u65F6\u5019\u5982\u679C\uFF0C\u5F80\u5176\u4E2D\u4E00\u4E2A\u8282\u70B9\u53D1\u9001\u6D88\u606F\uFF0C\u5373\u4F7F\u8FD9\u4E2A\u8282\u70B9\u6389\u4E86\uFF0C\u5176\u4ED6\u8282\u70B9\u4E5F\u80FD\u6D88\u8D39\u8FD9\u4E2A\u6D88\u606F</p><ol start="4"><li>\u5220\u9664\u7B56\u7565</li></ol><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>rabbitmqctl clear_policy ha-all
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,56);function ss(as,es){const e=o("ExternalLinkIcon");return i(),c(l,null,[Rn,n("p",null,[En,n("a",Pn,[An,t(e)]),Tn,n("a",In,[jn,t(e)]),Dn]),On,n("blockquote",null,[Nn,n("p",null,[Fn,n("a",Ln,[Bn,t(e)]),Hn]),Un,Kn]),Vn,n("blockquote",null,[zn,Wn,Jn,n("p",null,[Gn,n("a",Yn,[Xn,t(e)]),Zn]),$n]),ns],64)}var ps=p(Qn,[["render",ss],["__file","rabbitmq\u57FA\u7840.html.vue"]]);export{ps as default};
